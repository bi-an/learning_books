{"config":{"lang":["en","ja"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Readme","text":"<p>\u5728\u7ebf\u9605\u8bfb |  PDF\u4e0b\u8f7d | \u6587\u6863\u6e90\u7801</p>"},{"location":"#_1","title":"\u7b80\u4ecb","text":"<p>\u672c\u7ad9\u70b9\u8bb0\u5f55\u4e2a\u4eba\u8bfb\u4e66\u7b14\u8bb0\u3001\u535a\u5ba2\uff0c\u4e3b\u8981\u662f\u8ba1\u7b97\u673a\u6280\u672f\u3001\u7535\u5b50\u7535\u8def\u65b9\u9762\u3002</p> <p>\u4f7f\u7528mkdocs\u3001mkdocs-material\u642d\u5efa\uff0cmarkdown\u8bed\u6cd5\u3002</p> <p>\u7ad9\u70b9\u914d\u7f6e\u793a\u4f8b\uff1amkdocs-material\u793a\u4f8b</p>"},{"location":"#_2","title":"\u7248\u6743\u58f0\u660e","text":"<p>\u4ec5\u4f9b\u672c\u4eba\u5b66\u4e60\u4f7f\u7528\u3002\u5176\u4e2d\u7ffb\u8bd1\u90e8\u5206\u672a\u66fe\u83b7\u53d6\u539f\u4f5c\u8005\u7684\u6388\u6743\uff0c\u6545\u4efb\u4f55\u4eba\u4f20\u64ad\u672c\u4eba\u7ffb\u8bd1\u5185\u5bb9\uff0c\u53ef\u80fd\u5bf9\u539f\u4f5c\u8005\u6784\u6210\u4fb5\u6743\uff0c\u671b\u6089\u77e5\u3002</p>"},{"location":"#_3","title":"\u8bb8\u53ef\u534f\u8bae","text":"<p>TODO</p>"},{"location":"blog/markdown/","title":"Markdown","text":"<p>\u8f6c\u4e49\u53cd\u5f15\u53f7\uff1a</p> <p>\u53c2\u8003\u94fe\u63a5\u3002</p> <pre><code>\u65b9\u6cd5\u4e00\uff1a\u7528\u5c06\u53cd\u5f15\u53f7\u653e\u5165\u53cc\u53cd\u5f15\u53f7\u4e2d\uff0c\u5373\n`` ` ``\n\u65b9\u6cd5\u4e8c\uff1a\u4f7f\u7528\u4ee3\u7801\u5757\uff0c\u7f29\u8fdb4\u4e2a\u7a7a\u683c\u3002\n\u65b9\u6cd5\u4e09\uff1a\u4f7f\u7528\u4ee3\u7801\u5757\uff1a\n```\n`\n```\n</code></pre> <p>Markdown\u5b98\u65b9\u6587\u6863</p> <p>https://www.markdownguide.org/extended-syntax/</p>"},{"location":"blog/English/abbr/","title":"\u5e38\u89c1\u7f29\u5199","text":"Abbreviation Meaning CC Carbon Copy \u6284\u9001 FYI For Your Information w/ with, \u4e5f\u5199\u4f5c\"w.\" 1 w win or winning or winner BTW by the way i.e. Latin \"id est\" = that is \u4e5f\u5c31\u662f\u8bf4 sms Short Message Service \u77ed\u4fe1 aka also known as \u53c8\u540d\u2026\u2026 2 ETA Estimated Time of Arrial 3 by-ins \u9644\u6ce8"},{"location":"blog/English/glossary/","title":"Glossary","text":""},{"location":"blog/English/glossary/#glossy","title":"glossy","text":"<p>\u8bcd\u6c47\u8868</p>"},{"location":"blog/English/glossary/#vocabulary","title":"vocabulary","text":"<p>\u8bcd\u6c47\uff1b\u8bcd\u6c47\u8868</p>"},{"location":"blog/English/glossary/#ratably","title":"ratably","text":"<p>\u6309\u6bd4\u4f8b\u8ba1\u7b97</p> <p>\u6cd5\u5f8b\u5b9a\u4e49\uff1aratably means, with respect to any Lender, the percentage obtained by dividing (a) the Revolving Credit Commitment of such Lender by (b) the aggregate Revolving Credit Commitments of all Lenders (or, at any time after the Revolving Credit Termination Date, the percentage obtained by dividing the aggregate outstanding principal balance of the Revolving Credit Outstandings owing to such Lender by the aggregate outstanding principal balance of the Revolving Credit Outstandings owing to all Lenders).</p> <pre><code>ratably = \u5f53\u524d\u8d37\u65b9\u7684\u5faa\u73af\u4fe1\u8d37\u989d\u5ea6 / \u6240\u6709\u8d37\u65b9\u7684\u5faa\u73af\u4fe1\u8d37\u989d\u5ea6\u603b\u548c * 100%\n</code></pre> <p>\u6216</p> <pre><code>ratably = \u6b20\u5f53\u524d\u8d37\u65b9\u7684\u672a\u507f\u5faa\u73af\u4fe1\u8d37\u672c\u91d1\u603b\u4f59\u989d / \u6b20\u6240\u6709\u8d37\u65b9\u7684\u672a\u507f\u5faa\u73af\u4fe1\u8d37\u672c\u91d1\u603b\u4f59\u989d * 100%\n</code></pre> <p>\u5373 ratably \u6307\u5404\u8d37\u65b9\u53d1\u653e\u7684\u5faa\u73af\u4fe1\u8d37\u989d\u5ea6\u5728\u6240\u6709\u8d37\u65b9\u4e2d\u6240\u5360\u7684\u767e\u5206\u6bd4\uff1b\u6216\u6307\u672a\u507f\u4ed8\u5404\u8d37\u65b9\u7684\u672c\u91d1\u603b\u989d\u5360\u6240\u6709\u8d37\u65b9\u4e2d\u7684\u767e\u5206\u6bd4\u3002</p> <ul> <li>with respect to: \u5173\u4e8e\uff1b\u5bf9\u4e8e\u3002</li> <li>lender: \u8d37\u65b9\uff08\u51fa\u501f\u65b9\uff09\uff0c\u76f8\u5bf9\u201c\u501f\u65b9\u201d\u800c\u8a00\u3002</li> <li> <p>revolve: \u5728\u5fc3\u91cc\u7ffb\u6765\u8986\u53bb\uff0c\u601d\u8003\uff08ponder\uff09\uff1b\u7ed5\u8f74\u6216\u7ed5\u4e2d\u5fc3\u65cb\u8f6c\uff1b\u56f4\u7ed5\uff08\u67d0\u4e2d\u5fc3\u6216\u4e3b\u9898\uff09\uff0c\u5e38\u5e38\u4e0earound\u4e00\u8d77\u4f7f\u7528\uff0c\u5373revolve aroud\uff1a</p> <pre><code>the dispute revolved around wages \u4e89\u8bae\u56f4\u7ed5\u5de5\u8d44\u3002\n</code></pre> <p>\u89c1\u8bcd\u5178\u91ca\u4e49\u3002</p> </li> <li> <p>Revolving Credit: \u5468\u8f6c\u4fe1\u8d37\uff0c\u5468\u8f6c\u4fe1\u8d37\u3002\u53ef\u4ee5\u53c2\u8003\u7ef4\u57fa\u767e\u79d1\u6216\u767e\u5ea6\u767e\u79d1\u3002</p> </li> <li>commitment: \u627f\u8bfa\uff0c\u5728\u8fd9\u91cc\u800c\u8a00\uff0c\u5c31\u662f\uff08\u627f\u8bfa\u7684\uff09\u989d\u5ea6\u3002</li> <li>aggregate: \u603b\u8ba1\u7684\u3002</li> <li>divide a by b: a\u9664\u4ee5b\u3002</li> <li>outstanding: \u672a\u652f\u4ed8\u7684\uff08unpaid\uff09\uff0c\u89c1\u8bcd\u5178\u91ca\u4e49\u3002</li> <li>principal: \u672c\u91d1\uff08capital\uff09\u3002</li> <li>balance: \u4f59\u989d\u3002</li> <li>owe money to sb: \u6b20\u67d0\u4eba\u94b1\u3002owing to \u8fd8\u6709\u201c\u7531\u4e8e\u201d\u7684\u610f\u601d\u3002</li> </ul> <p>\u76f8\u5f53\u5730</p> <pre><code>The company recognizes revenue ratably insulating itself more than many other companies from direct demand shocks, but it is not immune to the effects of economic down.\n</code></pre>"},{"location":"blog/English/idiom/","title":"Idiom","text":"<p>beyond your ken - \u8d85\u8fc7\u4f60\u7684\u8ba4\u77e5\u8303\u7574</p> <p>ken - the range of perception, understanding or knowledge</p> <pre><code>Sheldon: Woman, you're playing with forces beyond your ken.\nPenny: Yeah, your ken can kiss my Barbie.\n</code></pre> <p>Penny\u60f3\u8981\u6c14\u6c14Sheldon\uff0c\u5979\u6545\u610f\u628aken\u66f2\u89e3\u6210\u73a9\u5076\uff0c\u8bf4\uff1a\u4f60\u7684ken\u53ef\u4ee5\u548c\u6211\u82ad\u6bd4\u5a03\u5a03\u8c08\u604b\u7231\u3002</p> <p>a rule of thumb - \u7ecf\u9a8c\u6cd5\u5219\u3002\u89c1\u67ef\u6797\u65af\u8bcd\u5178\u3002</p>"},{"location":"blog/English/phrase/","title":"Phrase","text":"<p>Image courtesy of ASUStek Computer Inc. \u56fe\u7247\u7531\u534e\u7855\u516c\u53f8\u63d0\u4f9b\u3002</p> <p>inside out \u7a7f\u53cd\u4e86\uff1bknow sb/sth inside out \u4e86\u5982\u6307\u638c\uff08\u4ece\u91cc\u5230\u5916\u90fd\u4e86\u89e3\uff09\u3002 More Info: inside out</p> <p>give someone a heads up: to warn sb, to give someone advance notice. See more info.</p>"},{"location":"blog/English/resources/","title":"Resources","text":"<pre><code>www.italki.com (skype)\nHelloTalk APP\n</code></pre>"},{"location":"blog/IC/advanced_tech/","title":"IC\u524d\u8a00\u6280\u672f","text":"<ul> <li>CoWoS - \u5148\u8fdbGPU\u5c01\u88c5\u6280\u672f\u3002</li> <li>HBM - \u9ad8\u6027\u80fd\u5185\u5b58\u89e3\u51b3\u65b9\u6848\u3002</li> <li>Chiplet - \u63d0\u9ad8\u7b97\u529b\u5bc6\u5ea6\u3002</li> </ul> <p>\u4f4e\u529f\u8017</p> <ul> <li>PSO - \u7535\u6e90\u5173\u65ad\u6280\u672f\u3002</li> <li>MSV - \u591a\u4f9b\u7535\u3002</li> <li>DVFS - \u52a8\u6001\u7535\u538b\u9891\u7387\u7f29\u653e\u3002</li> </ul> <p>\u4eff\u771f</p> <p>Xceilum Logic Simulator</p> <pre><code>Xceilum Logic Simulator\u4eff\u771f\u5668\u53ef\u671b\u79f0\u4e3a\u590d\u6742\u82af\u7247\u9a8c\u8bc1\u7684\u4e00\u5927\u5f97\u529b\u52a9\u624b\u3002\n\u652f\u6301\u591a\u79cd\u8bed\u8a00\u3002\n\u901a\u8fc7\u5145\u5206\u5229\u7528\u7ea6\u675f\u4fe1\u606f\u3001\u7ea6\u675f\u6027\u80fd\u5206\u6790\u548c\u8c03\u8bd5\u529f\u80fd\uff0cXcelium\u5728IP\u5c42\u9762\u7684\u9a8c\u8bc1\u5b9e\u73b0\u4e86\u663e\u8457\u7684\u901f\u5ea6\u63d0\u5347\u3002\n</code></pre> <p>HPC - High Performance Computing\u9ad8\u6027\u80fd\u8ba1\u7b97\u3002</p> <pre><code>\u4e3b\u8981\u662f\u901a\u8fc7\u591a\u53f0\u670d\u52a1\u5668\u5e76\u884c\u8ba1\u7b97\u7684\u65b9\u5f0f\uff0c\u6765\u63d0\u5347\n</code></pre> <p>\u53c2\u8003\u8d44\u6599\uff1a</p>"},{"location":"blog/IC/concept/","title":"\u96c6\u6210\u7535\u8def\u4e2d\u7684\u6982\u5ff5","text":"<p><code>logic cone</code>: In formal verification, a \"logic cone\" refers to the set of all the logic gates and their inputs that are connected to a specific output. It is used to model the behavior of a digital circuit and ensure that it is functioning correctly.</p>"},{"location":"blog/InfiniBand/infiniBand/","title":"Infiniband","text":""},{"location":"blog/InfiniBand/infiniBand/#ib","title":"IB\u7b80\u4ecb","text":"<p>RDMA - Remote Direct Memory Access \u8fdc\u7a0b\u76f4\u63a5\u5185\u5b58\u5b58\u53d6\u3002</p> <p>InfiniBand\u662f\u4e00\u79cd\u9ad8\u6027\u80fd\u8ba1\u7b97\u673a\u7f51\u7edc\u901a\u4fe1\u6807\u51c6\uff0c\u5b83\u5177\u6709\u6781\u9ad8\u7684\u541e\u5410\u91cf\u548c\u6781\u4f4e\u7684\u5ef6\u8fdf\u3002\u5982\u679c\u60a8\u9700\u8981\u4f7f\u7528InfiniBand\u8fdb\u884c\u7f16\u7a0b\uff0c\u60a8\u9700\u8981\u4f7f\u7528\u652f\u6301InfiniBand\u7684\u7f16\u7a0b\u8bed\u8a00\uff08\u5982C++\uff09\u6765\u7f16\u5199\u4ee3\u7801\u3002</p> <p>\u673a\u6784\u548c\u7ec4\u7ec7\uff1a</p> <p>OFA: Open Fabrics Alliance.</p> <p>IBTA: InfiniBand Trade Association.</p>"},{"location":"blog/InfiniBand/infiniBand/#_1","title":"\u6982\u5ff5","text":"<ul> <li><code>CQ</code> - Complete Queue \u5b8c\u6210\u961f\u5217</li> <li><code>WQ</code> - Work Queue \u5de5\u4f5c\u961f\u5217</li> <li><code>WR</code> - Work Request \u5de5\u4f5c\u8bf7\u6c42</li> <li><code>QP</code> - Queue Pairs \u961f\u5217\u5bf9\uff08Send-Receive\uff09</li> <li><code>SQ</code> - Send Queue \u53d1\u9001\u961f\u5217</li> <li><code>RQ</code> - Receive Queue \u63a5\u6536\u961f\u5217</li> <li><code>PD</code> - Protection Domain \u4fdd\u62a4\u57df\uff0c\u5c06QP\u548cMR\u7ed3\u5408\u5728\u4e00\u8d77</li> <li><code>MR</code> - Memory Region \u5185\u5b58\u533a\u57df\u3002\u4e00\u5757\u7ecf\u6ce8\u518c\u8fc7\u7684\u4e14\u672c\u5730\u7f51\u5361\u53ef\u4ee5\u8bfb\u5199\u7684\u5185\u5b58\u533a\u57df\u3002\u5305\u542bR_Key\u548cL_Key\u3002</li> <li><code>SGE</code> - Scatter/Gather Elements \u5206\u6563/\u805a\u96c6\u5143\u7d20\u3002</li> <li><code>R_Key</code> - Remote Key</li> <li><code>L_Key</code> - Local Key</li> <li><code>CA</code> - (Host) Channel Adapter, an inifiniband network interface card.</li> <li><code>NIC</code> - Network Interface Card \u7f51\u5361\u3002</li> <li><code>LID</code> - Local Identifier.</li> <li><code>CM</code> - Connection Manager.</li> </ul> <p>\u5176\u4ed6\u5e38\u89c1\u7f29\u5199\uff1a</p> <ul> <li><code>RC</code> - reliable connected.</li> <li><code>SCSI</code> - Small Computer System Interface \u5c0f\u578b\u8ba1\u7b97\u673a\u7cfb\u7edf\u63a5\u53e3\u3002</li> <li><code>SRP</code> - SCSI RDMA Protocol. / Secure Remote Password.</li> </ul> <p>\u535a\u5ba2\uff1ahttps://blog.51cto.com/liangchaoxi/4044818</p>"},{"location":"blog/InfiniBand/infiniBand/#_2","title":"\u5b89\u88c5","text":"<p>InfiniBand \u548c RDMA \u76f8\u5173\u8f6f\u4ef6\u5305</p> <pre><code>sudo apt-get install infiniband-diags\nsudo apt install ibverbs-utils\n</code></pre>"},{"location":"blog/InfiniBand/infiniBand/#api","title":"API","text":"<ul> <li>introduction to programming infiniband</li> <li>RDMA Aware Programming user manual (PDF)</li> </ul> <p>\u4ee5\u4e0b\u662f\u4e00\u4e9b\u652f\u6301InfiniBand\u7684C++\u5e93\uff1a</p> <p>Infinity\uff1a\u8fd9\u662f\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684C++ RDMA\u5e93\uff0c\u7528\u4e8eInfiniBand\u7f51\u7edc\u3002\u5b83\u63d0\u4f9b\u4e86\u5bf9\u4e24\u4fa7\uff08\u53d1\u9001/\u63a5\u6536\uff09\u548c\u5355\u4fa7\uff08\u8bfb/\u5199/\u539f\u5b50\uff09\u64cd\u4f5c\u7684\u652f\u6301\uff0c\u5e76\u4e14\u662f\u4e00\u4e2a\u7b80\u5355\u800c\u5f3a\u5927\u7684\u9762\u5411\u5bf9\u8c61\u7684ibVerbs\u62bd\u8c61\u3002\u8be5\u5e93\u4f7f\u7528\u6237\u80fd\u591f\u6784\u5efa\u4f7f\u7528RDMA\u7684\u590d\u6742\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c\u4e0d\u4f1a\u5f71\u54cd\u6027\u80fd1\u3002</p> <p>OFED\uff1a\u8fd9\u662f\u4e00\u4e2a\u5f00\u653e\u5f0fFabrics Enterprise Distribution\uff0c\u5b83\u63d0\u4f9b\u4e86\u5bf9InfiniBand\u548cRoCE\uff08RDMA over Converged Ethernet\uff09\u6280\u672f\u7684\u652f\u6301\u3002OFED\u63d0\u4f9b\u4e86\u4e00\u7ec4\u7528\u6237\u7a7a\u95f4\u5e93\u548c\u9a71\u52a8\u7a0b\u5e8f\uff0c\u53ef\u7528\u4e8e\u6784\u5efa\u652f\u6301RDMA\u7684\u5e94\u7528\u7a0b\u5e8f2\u3002</p> <p>\u4ee5\u4e0b\u662f\u4f7f\u7528Infinity\u5e93\u7f16\u5199\u652f\u6301InfiniBand\u7684C++\u4ee3\u7801\u793a\u4f8b\uff1a</p> <pre><code>// \u521b\u5efa\u65b0\u4e0a\u4e0b\u6587\ninfinity::core::Context *context = new infinity::core::Context();\n\n// \u521b\u5efa\u961f\u5217\u5bf9\ninfinity::queues::QueuePairFactory *qpFactory = new infinity::queues::QueuePairFactory(context);\ninfinity::queues::QueuePair *qp = qpFactory-&gt;connectToRemoteHost(SERVER_IP, PORT_NUMBER);\n\n// \u521b\u5efa\u5e76\u5411\u7f51\u7edc\u6ce8\u518c\u7f13\u51b2\u533a\ninfinity::memory::Buffer *localBuffer = new infinity::memory::Buffer(context, BUFFER_SIZE);\n\n// \u4ece\u8fdc\u7a0b\u7f13\u51b2\u533a\u8bfb\u53d6\uff08\u5355\u5411\uff09\u5e76\u7b49\u5f85\u5b8c\u6210\ninfinity::memory::RegionToken *remoteBufferToken = new infinity::memory::RegionToken(REMOTE_BUFFER_INFO);\ninfinity::requests::RequestToken requestToken(context);\nqp-&gt;read(localBuffer, remoteBufferToken, &amp;requestToken);\nrequestToken.waitUntilCompleted();\n\n// \u5c06\u672c\u5730\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u5199\u5165\u8fdc\u7a0b\u7f13\u51b2\u533a\uff08\u5355\u5411\uff09\u5e76\u7b49\u5f85\u5b8c\u6210\nqp-&gt;write(localBuffer, remoteBufferToken, &amp;requestToken);\nrequestToken.waitUntilCompleted();\n\n// \u5c06\u672c\u5730\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u901a\u8fc7\u961f\u5217\u5bf9\u53d1\u9001\uff08\u53cc\u5411\uff09\u5e76\u7b49\u5f85\u5b8c\u6210\nqp-&gt;send(localBuffer, &amp;requestToken);\nrequestToken.waitUntilCompleted();\n\n// \u5173\u95ed\u8fde\u63a5\ndelete remoteBufferToken;\ndelete localBuffer;\ndelete qp;\ndelete qpFactory;\ndelete context;\n</code></pre> <p>\u4ee5\u4e0b\u662f\u4f7f\u7528OFED\u5e93\u7f16\u5199\u652f\u6301InfiniBand\u7684C++\u4ee3\u7801\u793a\u4f8b\uff1a</p> <pre><code>// \u521b\u5efa\u65b0\u4e0a\u4e0b\u6587\nstruct ibv_context *context = ibv_open_device(*device);\n\n// \u521b\u5efa\u5b8c\u6210\u7aef\u53e3\nstruct ibv_pd *pd = ibv_alloc_pd(context);\n\n// \u521b\u5efa\u961f\u5217\u5bf9\nstruct ibv_qp_init_attr qp_init_attr;\nmemset(&amp;qp_init_attr, 0, sizeof(qp_init_attr));\nqp_init_attr.send_cq = cq;\nqp_init_attr.recv_cq = cq;\nqp_init_attr.qp_type = IBV_QPT_RC;\nqp_init_attr.cap.max_send_wr = 1;\nqp_init_attr.cap.max_recv_wr = 1;\nqp_init_attr.cap.max_send_sge = 1;\nqp_init_attr.cap.max_recv_sge = 1;\nstruct ibv_qp *qp = ibv_create_qp(pd, &amp;qp_init_attr);\n\n// \u521b\u5efa\u5e76\u5411\u7f51\u7edc\u6ce8\u518c\u7f13\u51b2\u533a\nchar *localBuffer = (char *)malloc(BUFFER_SIZE);\nstruct ibv_mr *mr = ibv_reg_mr(pd, localBuffer, BUFFER_SIZE, IBV_ACCESS_LOCAL_WRITE | IBV_ACCESS_REMOTE_READ | IBV_ACCESS_REMOTE_WRITE);\n\n// \u8fde\u63a5\u5230\u8fdc\u7a0b\u4e3b\u673a\nstruct sockaddr_in remoteAddress;\nmemset(&amp;remoteAddress, 0, sizeof(remoteAddress));\nremoteAddress.sin_family = AF_INET;\nremoteAddress.sin_port = htons(PORT_NUMBER);\ninet_pton(AF_INET, SERVER_IP, &amp;remoteAddress.sin_addr);\nstruct rdma_cm_id *cmId;\nrdma_create_id(*eventChannel, &amp;cmId, NULL, RDMA_PS_TCP);\nrdma_resolve_addr(cmId, NULL, (struct sockaddr *)&amp;remoteAddress, RESOLVE_TIMEOUT_MS);\n\n// \u7b49\u5f85\u8fde\u63a5\u5b8c\u6210\nrdma_wait_event(*eventChannel, RDMA_CM_EVENT_ESTABLISHED);\nrdma_ack_cm_event(cmEvent);\n\n// \u83b7\u53d6\u8fdc\u7a0b\u7f13\u51b2\u533a\u4fe1\u606f\nstruct ibv_wc wc;\nibv_post_recv(qp, &amp;recvWr, &amp;badRecvWr);\ndo {\n    ibv_poll_cq(cq, 1, &amp;wc);\n} while (wc.status != IBV_WC_SUCCESS || wc.opcode != IBV_WC_RECV_RDMA_WITH_IMM || wc.imm_data != htonl(IMM_DATA));\nremoteBufferInfo.rkey = ntohl(wc.imm_data &gt;&gt; 8);\nremoteBufferInfo.vaddr = wc.wr_id;\n\n// \u5c06\u672c\u5730\u7f13\u51b2\u533a\u7684\u5185\u5bb9\u5199\u5165\u8fdc\u7a0b\u7f13\u51b2\u533a\uff08\u5355\u5411\uff09\nstruct ibv_send_wr sendWr;\nmemset(&amp;sendWr, 0, sizeof(sendWr));\nsendWr.wr_id = 0;\nsendWr.opcode = IBV_WR_RDMA_WRITE_WITH_IMM;\nsendWr.sg_list = &amp;localSge;\nsendWr.num_sge = 1;\nsendWr.send_flags = IBV_SEND_SIGNALED;\nsendWr.wr.rdma.remote_addr = remoteBufferInfo.vaddr;\nsendWr.wr.rdma.rkey = remoteBufferInfo.rkey;\nlocalSge.addr = (uintptr_t)localBuffer;\nlocalSge.length = BUFFER_SIZE;\nlocalSge.lkey = mr-&gt;lkey;\nibv_post_send(qp, &amp;sendWr, &amp;badSendWr);\n\n// \u5173\u95ed\u8fde\u63a5\nibv_dereg_mr(mr);\nfree(localBuffer);\nibv_destroy_qp(qp);\nibv_dealloc_pd(pd);\nibv_close_device(context);\n</code></pre> <ul> <li>\u5165\u95e8\u7ea7\u6587\u6863\uff1ahttps://zhuanlan.zhihu.com/p/337461037</li> <li>\u6587\u6863\uff1ahttps://docs.kernel.org/infiniband/index.html</li> <li>\u6587\u6863\uff1ahttp://blog.foool.net/wp-content/uploads/linuxdocs/infiniband.pdf</li> <li>\u6587\u6863\uff1ahttps://support.bull.com/documentation/byproduct/infra/sw-extremcomp/sw-extremcomp-com/g</li> <li>\u6587\u6863\uff1ahttps://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html-single/configuring_infiniband_and_rdma_networks/index</li> <li>\u535a\u5ba2\uff1ahttps://zhuanlan.zhihu.com/p/337461037</li> <li>\u6587\u6863\uff1ahttps://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/networking_guide/ch-configure_infiniband_and_rdma_networks</li> <li>\u77e5\u4e4e\u4e13\u680f\uff1ahttps://www.zhihu.com/column/c_1231181516811390976</li> <li>\u77e5\u4e4e\u4e13\u680f\uff1ahttps://www.zhihu.com/column/rdmatechnology</li> </ul> <p>Linux manual page</p>"},{"location":"blog/InfiniBand/infiniBand/#command-line","title":"Command-Line","text":"<p>\u6587\u6863\uff1ahttps://docs.nvidia.com/networking/pages/viewpage.action?pageId=43719572</p> <ul> <li><code>ibstat</code></li> <li><code>ibhosts</code> - \u67e5\u770b\u6240\u6709\u7684IB hosts\u3002</li> <li><code>ibnetdiscover</code> - discover InfiniBand topology.</li> <li><code>ibv_devices</code> - list RDMA devices.</li> <li><code>ibv_devinof</code> - Print information about RDMA devices available for use from userspace.</li> <li><code>ibv_rc_pingpong</code> - Run a simple ping-pong test over InfiniBand via the reliable connected (RC) transport.</li> <li> <p><code>targetcli</code> - administration shell for storage targets</p> <p><code>targetcli</code> is  a  shell for viewing, editing, and saving the configuration of the kernel's target subsystem, also known as LIO. It enables the administrator to assign local storage resources backed by either files, volumes, local SCSI devices, or ramdisk, and export them to remote systems via network fabrics, such as iSCSI or FCoE.</p> </li> <li> <p><code>srp_daemon</code> - Discovers and connects to InfiniBand SCSI RDMA Protocol (SRP) targets in an IB fabric.</p> </li> <li><code>ibsrpdm</code> - List InfiniBand SCSI RDMA Protocol (SRP) targets on an IB fabric.</li> </ul>"},{"location":"blog/InfiniBand/libs/","title":"libs","text":"<p>devid: device ID library. Refer to here.</p> <p>ibverbs: \u4f7f\u5f97\u7528\u6237\u7a7a\u95f4\u8fdb\u7a0b\u80fd\u591f\u4f7f\u7528RDMA verbs\uff08\u5373\u8fdb\u884cRDMA\u64cd\u4f5c\uff09\u3002Refer to here.</p> <p>dl: Dynamic Loader.</p>"},{"location":"blog/InfiniBand/RDMA/0-Preface/","title":"\u7b80\u4ecb","text":"<p>RDMA Aware Networks Programming User Manual (PDF)</p> <p>RDMA\u7cfb\u5217\u535a\u5ba2</p>"},{"location":"blog/InfiniBand/RDMA/2-introduction-to-the-programming-user-guide/","title":"2 \u7f16\u7a0b\u7528\u6237\u624b\u518c\u7684\u7b80\u4ecb","text":""},{"location":"blog/InfiniBand/RDMA/2-introduction-to-the-programming-user-guide/#21","title":"2.1 \u8303\u56f4","text":"<p>Mellanox VPI\u00ae\uff08Virtual Procotol Interconnect\uff09\u67b6\u6784\u4e3a\u540c\u65f6\u652f\u6301InfiniBand\u548c\u4ee5\u592a\u7f51\u8bed\u4e49\u7684\u7f51\u7edc\u9002\u914d\u5668\u548c\u4ea4\u6362\u673a\u63d0\u4f9b\u9ad8\u6027\u80fd\u3001\u4f4e\u5ef6\u8fdf\u548c\u53ef\u9760\u7684\u65b9\u6cd5\u3002 VPI\u9002\u914d\u5668\u6216\u4ea4\u6362\u673a\u53ef\u4ee5\u88ab\u8bbe\u7f6e\u4e3a\u63d0\u4f9b</p>"},{"location":"blog/Linux/LDAP/","title":"\u7b80\u4ecb","text":"<p>LDAP, Lightweight Directory Access Protocol.</p>"},{"location":"blog/Linux/LDAP/#_2","title":"\u53c2\u8003","text":"<p>Bull Support</p>"},{"location":"blog/Linux/PCIe/","title":"\u8bcd\u6c47\u8868\uff08Glossary\uff09","text":"<ul> <li>BAR: base address register.</li> <li>PCI configuration space.</li> <li>sba: system bus address.</li> </ul> <p>PCI</p> <p>PCI configurtation space</p> <pre><code>PCI\u8bbe\u5907\u6709\u4e00\u7ec4\u88ab\u79f0\u4e3aconfiguratin space\u7684\u5bc4\u5b58\u5668\uff0c\u5e76\u4e14PCI Express\u5f15\u5165\u4e86Extended configuration space\u3002configuration space\u5bc4\u5b58\u5668\u88ab\u6620\u5c04\u5230memory locations\u3002\n\u9a71\u52a8\u8bbe\u5907\u548c\u8bca\u65ad\u8f6f\u4ef6\u5fc5\u987b\u8981\u6709\u6743\u9650\u8bbf\u95eeconfiguration space\uff0c\u64cd\u4f5c\u7cfb\u7edf\u901a\u5e38\u4f7f\u7528APIs\u6765\u6388\u6743\u8bbf\u95ee\u8bbe\u5907configuration space\u3002\n</code></pre> <p>PCI configuration space\u6709\u4e24\u79cd\u7c7b\u578b\u7684Header\uff0864 bytes\uff09\uff1a</p>"},{"location":"blog/Linux/PCIe/#header-type-0x0","title":"Header Type 0x0","text":"Register Offset Bits 31-24 Bits 23-16 Bits 15-8 Bits 7-0 0x0 0x0 Device ID Vendor ID 0x1 0x4 Status Command 0x2 0x8 Class code Subclass Prog IF Revision ID 0x3 0xC BIST Header type Latency Timer Cache Line Size 0x4 0x10 Base address #0 (BAR0) 0x5 0x14 Base address #1 (BAR1) 0x6 0x18 Secondary Latency Timer Subordinate Bus Number Secondary Bus Number Primary Bus Number 0x7 0x1C Secondary Status I/O Limit I/O Base 0x8 0x20 Memory Limit Memory Base 0x9 0x24 Prefetchable Memory Limit Prefetchable Memory Base 0xA 0x28 Prefetchable Base Upper 32 Bits 0xB 0x2C Prefetchable Limit Upper 32 Bits 0xC 0x30 I/O Limit Upper 16 Bits I/O Base Upper 16 Bits 0xD 0x34 Reserved Capability Pointer 0xE 0x38 Expansion ROM base address 0xF 0x3C Bridge Control Interrupt PIN Interrupt Line"},{"location":"blog/Linux/PCIe/#header-type-0x1","title":"Header Type 0x1","text":"Register Offset Bits 31-24 Bits 23-16 Bits 15-8 Bits 7-0 0x0 0x0 Device ID Vendor ID 0x1 0x4 Status Command 0x2 0x8 Class code Subclass Prog IF Revision ID 0x3 0xC BIST Header type Latency Timer Cache Line Size 0x4 0x10 Base address #0 (BAR0) 0x5 0x14 Base address #1 (BAR1) 0x6 0x18 Secondary Latency Timer Subordinate Bus Number Secondary Bus Number Primary Bus Number 0x7 0x1C Secondary Status I/O Limit I/O Base 0x8 0x20 Memory Limit Memory Base 0x9 0x24 Prefetchable Memory Limit Prefetchable Memory Base 0xA 0x28 Prefetchable Base Upper 32 Bits 0xB 0x2C Prefetchable Limit Upper 32 Bits 0xC 0x30 I/O Limit Upper 16 Bits I/O Base Upper 16 Bits 0xD 0x34 Reserved Capability Pointer 0xE 0x38 Expansion ROM base address 0xF 0x3C Bridge Control Interrupt PIN Interrupt Line <pre><code>BAR0\nMemory-mapped I/O (MMIO) registers\nBAR1\nDevice memory windows.\nBAR2/3\nComplementary space of BAR1.\nBAR5\nI/O port.\nBAR6\nPCI ROM.\n</code></pre>"},{"location":"blog/Linux/PCIe/#commands","title":"Commands","text":"<p>lspci</p> <p>Interpreting the output of lspci</p>"},{"location":"blog/Linux/PCIe/#_1","title":"\u53c2\u8003","text":"<ul> <li>PCI Express I/O System</li> <li>PCI Express</li> <li>What is PCIe</li> <li>What is the Base Address Register (BAR) in PCIe?</li> <li>PCIe bus addresses, lspci, and working out your PCIe bus topology</li> </ul>"},{"location":"blog/Linux/drive/","title":"\u9a71\u52a8\u76f8\u5173\u77e5\u8bc6","text":""},{"location":"blog/Linux/drive/#_2","title":"\u547d\u4ee4","text":"<ul> <li><code>lsmod</code> - Show status of modules in the Linux kernel.</li> </ul> <p><code>lsmod</code> is a trivial program which nicely formats the contents of the <code>/proc/odules</code>,   showing what kernel modules are currently loaded.</p> <ul> <li> <p><code>dmesg</code> - examine or control the kernel ring buffer.</p> <p>The kernel buffer is a data structure used for keeping the log messages of the kernel and the kernel modules. It's a ring buffer with a fixed size. Once it's full, new messages overwrite the oldest messages. During boot, the kernel saves the messages into the kernel buffer.</p> </li> <li> <p><code>lsscsi</code> - Uses information in sysfs (Linux kernel series 2.6 and later) to list SCSI devices (or hosts) currently attached to the system.</p> </li> </ul>"},{"location":"blog/Linux/filesystem/","title":"\u6587\u4ef6\u7cfb\u7edf","text":"<ul> <li><code>/proc</code>: \u67e5\u770b\u624b\u518c <code>man proc</code>\u3002</li> <li><code>/proc/self/exe</code>: \u662f\u6307\u5411\u5f53\u524d\u8fdb\u7a0b\u7684\u7a0b\u5e8f\u6587\u4ef6\u7684\u8f6f\u94fe\u63a5\u3002</li> <li> <p><code>/proc/&lt;pid&gt;/exe</code>: \u662f\u6307\u5411\u8fdb\u7a0b<code>&lt;pid&gt;</code>\u7684\u7a0b\u5e8f\u6587\u4ef6\u7684\u8f6f\u94fe\u63a5\u3002</p> <p>How to Find File System Names</p> </li> </ul>"},{"location":"blog/Linux/filesystem/#partitionfilesystem","title":"\u5206\u533a(Partition)\u548c\u6587\u4ef6\u7cfb\u7edf(Filesystem)","text":"<p>\u672c\u5c0f\u8282\u5185\u5bb9\u6765\u81ea \u53c2\u8003\u94fe\u63a5 \u3002</p>"},{"location":"blog/Linux/filesystem/#_2","title":"\u5206\u533a\uff1a","text":"<p>Linux\u4e0a\u7684\u5206\u533a\u6307\uff1a\u5b58\u50a8\u8bbe\u5907\u4e2d\u5212\u5206\u51fa\u6765\u7684\u4e00\u4e2a\u7247\u6bb5\uff0c\u8be5\u7247\u6bb5\u4e0e\u5176\u4ed6\u7247\u6bb5\u903b\u8f91\u4e0a\u5206\u79bb\uff0c\u597d\u6bd4\u4e00\u4e2a\u4e2a\u72ec\u7acb\u7684\u623f\u95f4\u3002</p>"},{"location":"blog/Linux/filesystem/#partition-table","title":"\u5206\u533a\u8868(partition table)\uff1a","text":"<p>\u5206\u533a\u8868\u5b58\u50a8\u5404\u4e2a\u5206\u533a\u7684\u5143\u6570\u636e\uff0c\u6bd4\u5982\u8d77\u59cb\u4f4d\u7f6e\u3001\u7ec8\u6b62\u4f4d\u7f6e\u3001\u5927\u5c0f\u7b49\u3002 \u6709\u4e24\u79cd\u4e3b\u8981\u7684\u5206\u533a\u8868\u7c7b\u578b\uff0cMBR(older)\u548cGPT(newer)\uff1a</p> Partition tables Maximum primary partitions Maximum size for each partition Security Operating system Support Master Boot Record (MBR) 4 2TB No such security features Supports most modern OS Guid Partition Table (GPT) No such limit 18 Exabytes CRC32 checksum mechanism to verify the integrity of files Supports most modern OS <p>\u4ece\u4e0a\u8868\u53ef\u4ee5\u5f88\u660e\u663e\u5730\u770b\u51fa\uff0c\u4e3a\u4ec0\u4e48GPT\u66f4\u63a8\u8350\u3002</p>"},{"location":"blog/Linux/filesystem/#_3","title":"\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u6587\u4ef6\u7cfb\u7edf\u662f\u6211\u4eec\u5728\u6bcf\u4e2a\u5206\u533a\u4e2d\u7ba1\u7406\u6570\u636e\u7684\u65b9\u5f0f\u3002\u5b83\u8d1f\u8d23\u7d22\u5f15\u3001\u5b58\u50a8\u3001\u68c0\u7d22\u3001\u547d\u540d\u6587\u4ef6\u548c\u7ef4\u62a4\u6587\u4ef6\u7684\u5143\u6570\u636e\uff08\u6587\u4ef6\u6240\u6709\u8005\u3001\u5927\u5c0f\u3001\u6743\u9650\u7b49\uff09\u3002\u5b58\u50a8\u5728\u5206\u533a\u4e2d\u3002</p> <p>\u4e00\u4e2a\u6587\u4ef6\u4fdd\u5b58\u5728\u591a\u4e2a\u8fde\u7eed\u7684 \u6247\u533a\uff08sector\uff09 \u4e2d\uff0c\u73b0\u4ee3\u6bcf\u4e2a\u6247\u533a\u5927\u7ea6\u4e3a4096\u5b57\u8282\u3002 \u6587\u4ef6\u7cfb\u7edf\u8d1f\u8d23\u7ec4\u7ec7\u54ea\u4e9b\u6247\u533a\u51c6\u5907\u597d\u4f7f\u7528\u4e86\u3001\u4e00\u4e2a\u6587\u4ef6\u5fc5\u987b\u5b58\u50a8\u5728\u54ea\u4e2a\u6247\u533a\u3001\u54ea\u4e2a\u6247\u533a\u5b58\u50a8\u4e86\u4ec0\u4e48\u6587\u4ef6\u3002 \u5982\u679c\u6ca1\u6709\u8fd9\u79cd\u7ec4\u7ec7\uff0c\u5c31\u65e0\u6cd5\u65e0\u6cd5\u68c0\u7d22\u4efb\u4f55\u6587\u4ef6\uff0c\u56e0\u4e3a\u7cfb\u7edf\u65e0\u6cd5\u5f97\u77e5\u6587\u4ef6\u7684\u4f4d\u7f6e\uff08block\uff0c\u5757\uff09\u3002</p> <p>\u4e3b\u8981\u7684\u6587\u4ef6\u7cfb\u7edf\u5206\u7c7b\uff1a</p> <ul> <li>FAT</li> </ul> <p>\u6587\u4ef6\u5206\u914d\u8868\uff08FAT\uff0cFile Allocation Table\uff09\u662fMicrosoft\u5f00\u53d1\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\u7cfb\u7edf\u3002 \u4ece1997\u53d1\u5e03\u4e4b\u540e\uff0c\u6709\u591a\u4e2a\u7248\u672c\uff0c\u79f0\u4e3aFAT12\u3001FAT16\u3001FAT32\uff0c\u8fde\u7eed\u5730\u589e\u52a0\u4e86\u6700\u5927\u652f\u6301\u6587\u4ef6\u5927\u5c0f\uff08file size\uff09\u548c\u9a71\u52a8\u5668\u5927\u5c0f\uff08drive size\uff09\u3002</p> <p>FAT32\u5141\u8bb8\u7684\u6700\u5927\u6587\u4ef6\u5927\u5c0f\u4e3a4Gb\u3002\u76f4\u81f3WindowsXP\uff0cFAT32\u662f\u9ed8\u8ba4\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u4e4b\u540e\u88abNTFS\u53d6\u4ee3\u3002 \u867d\u7136FAT\u975e\u5e38\u57fa\u7840\uff0c\u4f46\u662f\u5b83\u652f\u6301\u51e0\u4e4e\u6240\u6709\u7684\u8bbe\u5907\u548c\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p>\u6ce8\uff1a \u9a71\u52a8\u5668\uff08drive\uff09\uff0c\u662f\u4e00\u4e2a\u80fd\u5b58\u50a8\u548c\u8bfb\u53d6\u975e\u6613\u5931\u4fe1\u606f\u7684\u4f4d\u7f6e\uff0c\u6bd4\u5982\u78c1\u76d8\uff08disk\uff09\u6216\u5149\u76d8\uff08disc\uff09\u3002</p> <p>\u5982\u4e0b\u56fe\uff0c\u9a71\u52a8\u5668A:\u662f\u4e00\u4e2a\u8f6f\u76d8\uff08floppy drive\uff09\uff0c \u9a71\u52a8\u5668C:\u662f\u4e3b\u786c\u76d8\uff08primary hard drivce\uff09\uff0c \u9a71\u52a8\u5668D:\u548cE:\u662f\u5206\u533a\uff0cF:\u662fCD-ROM\u3002 CD-ROM\u5e38\u5e38\u662f\u6700\u540e\u4e00\u4e2a\u76d8\u7b26\uff08drive letter\uff09\u3002 \u5728\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u786c\u76d8\u662fC:\u9a71\u52a8\u5668\uff0cCD-ROM\u6216\u5176\u4ed6\u5149\u76d8\u662fD:\u9a71\u52a8\u5668\u3002</p> <p></p> <ul> <li>NTFS</li> </ul> <p>\u65b0\u6280\u672f\u6587\u4ef6\u7cfb\u7edf\uff08New Technology File System\uff0cNTFS\uff09\u662fFAT\u7684\u73b0\u4ee3\u66ff\u4ee3\u8005\u3002 \u9664\u4e86\u652f\u6301\u9ad8\u8fbe16EB\uff08\u5927\u4e8e170\u4ebfGB\uff09\u7684\u9a71\u52a8\u5668\u5927\u5c0f\u548c256TB\u7684\u5355\u6587\u4ef6\u5927\u5c0f\u5916\uff0c\u8fd8\u652f\u6301\u65e5\u5fd7\u7cfb\u7edf\uff08journaling system\uff09\u3002</p> <ul> <li>ext/ext2/ext3/ext4</li> </ul> <p>Linux\u7684\u6269\u5c55\u6587\u4ef6\u7cfb\u7edf\uff08extended file system\uff09\u6216ext\u4e8e1992\u5e74\u53d1\u5e03\u3002\u4e4b\u540e\u6709\u4e863\u6b21\u66f4\u65b0\uff1a</p> <p>ext2\u5f15\u5165\u4e86\u6587\u4ef6\u5c5e\u6027\uff08\u6587\u4ef6\u6743\u9650\uff09\uff0cext3\u5f15\u5165\u4e86\u65e5\u5fd7\u529f\u80fd\uff08journaling\uff09\u3002</p> <p>ext4\u5bf9ext2\u548cext3\u5411\u540e\u517c\u5bb9\uff0c\u589e\u52a0\u4e86\u5b58\u50a8\u9650\u5236\u548c\u4e00\u4e9b\u6027\u80fd\u8c03\u6574\u3002 \u53ef\u4ee5\u652f\u6301\u9ad8\u8fbe1EB\u7684\u5377\uff08volumn\uff09\uff0c\u5355\u4e2a\u6587\u4ef6\u53ef\u4ee5\u8fbe16TB\u3002</p> <p>ext4\u4e5f\u5f15\u5165\u4e86\u5ef6\u8fdf\u5185\u5b58\u5206\u914d\u7684\u6982\u5ff5\uff0c\u5373\u5728\u6587\u4ef6\u88ab\u5f3a\u5236\u5237\u65b0\u5230\u5b58\u50a8\u8bbe\u5907\u65f6\u624d\u4e3a\u5176\u5206\u914d\u6247\u533a\u3002 \u8fd9\u63d0\u9ad8\u4e86CPU\u7684\u6027\u80fd\u5e76\u51cf\u5c11\u4e86\u574f\u7684\u6247\u533a\u3002 \u4eca\u5929\u51e0\u4e4e\u6240\u6709\u7684\u73b0\u4ee3Linux\u53d1\u884c\u7248\u90fd\u4f7f\u7528ext4\u4f5c\u4e3a\u9ed8\u8ba4\u7684\u6587\u4ef6\u7cfb\u7edf\u3002</p> <ul> <li> <p>ZFS</p> </li> <li> <p>Btrfs</p> </li> </ul>"},{"location":"blog/Linux/filesystem/#_4","title":"\u603b\u7ed3","text":"<p>\u4e0b\u56fe\u662f\u4e00\u4e2a\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u7684\u5c42\u6b21\u7ed3\u6784\u793a\u4f8b\uff1a</p> <p></p> <p>\u6211\u6709\u4e00\u4e2a500GB\u7684SSD\uff0c\u5206\u62103\u4e2a\u5206\u533a\uff08boot\u3001home\u3001root\uff09\uff0c\u4f7f\u7528GPT\u4f5c\u4e3a\u5206\u533a\u8868\u3002</p> <p>\u6211\u6ca1\u6709\u5206\u51faswap\u5206\u533a\u3002\u6240\u6709\u7684\u5206\u533a\u90fd\u8dd1\u5728ext4\u6587\u4ef6\u7cfb\u7edf\u4e0a\u3002</p> <p>\u5728\u4e00\u4e2a\u53cc\u542f\u52a8\uff08dual-booted\uff09\u5b58\u50a8\u8bbe\u5907\uff08Windows\u548cLinux\uff09\u4e0a\uff0c\u8fd8\u6709\u51e0\u4e2a\u9002\u7528\u4e8eWindwows\u7684NTFS\u5206\u533a\u3002</p> <p>\u4f60\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728\u4efb\u610f\u5b58\u50a8\u8bbe\u5907\u4e0a\u67e5\u770b\u5206\u533a\uff1a</p> <pre><code>lsblk\n</code></pre> <p>\u66f4\u591a\u8d44\u6e90\u8bf7\u8bbf\u95ee\uff1a</p> <ul> <li>How to install ZFS on Ubuntu \u2013 A Setup and Usage Guide</li> <li>Ext4 vs Btrfs Filesystems \u2013 Which one should you choose?</li> <li>How to install and format a partition with the Btrfs on Ubuntu?</li> <li>Frequently Asked Questions regarding ext4</li> </ul>"},{"location":"blog/Linux/filesystem/#_5","title":"\u6302\u8f7d","text":"<p>\u6302\u8f7d\uff1a\u4f7f\u8bbe\u5907\u4e0a\u7684\u6587\u4ef6\u548c\u76ee\u5f55\u53ef\u4ee5\u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u8bbf\u95ee\u7684\u4e00\u4e2a\u8fc7\u7a0b\u3002\u89c1\u7ef4\u57fa\u767e\u79d1\u3002</p> <p>\u6302\u8f7d\u70b9\uff1aA mount point is a location in the partition used as a root filesystem.</p>"},{"location":"blog/Linux/filesystem/#_6","title":"\u9a71\u52a8","text":""},{"location":"blog/Linux/filesystem/#_7","title":"\u76f8\u5173\u547d\u4ee4\u4e00\u89c8\u8868","text":"<p>lsblk</p> <pre><code>lsblk [options] [device...]\n\nlist all avaivable or specified block devices.\nReads the sysfs filesystem to gather information.\n</code></pre> <p>df</p> <pre><code>df [OPTION]... [FILE]...\n\nreport file system disk space usage on which each FILE resides.\n\ndf -T \u6253\u5370\u6587\u4ef6\u7cfb\u7edf\u7684\u7c7b\u578b\u3002\n</code></pre> <p>du</p> <pre><code>du [OPTION]... [FILE]...\n\nestimate file space usage.\n</code></pre> <p>quota</p> <pre><code>quota -s -u user...\n\ndisplay users' disk usage and limits.\nquota reports the quotas of all the filesystems listed in /etc/mtab.\nFor filesystems that are NFS-mounted a call to the rpc.rquotad on the server machine is performed to get the information.\n\n-s, --human-readable\n</code></pre> <p>repquota</p> <pre><code>prints a summary of disc usage and quotas for the specified file system.\n</code></pre> <p>mount</p>"},{"location":"blog/Linux/functions/","title":"Functions","text":""},{"location":"blog/Linux/functions/#user-id","title":"User ID","text":"<ul> <li>getpwuid</li> </ul>"},{"location":"blog/Linux/functions/#file-directory","title":"File &amp; Directory","text":"<ul> <li>opendir</li> <li>readdir</li> <li>closedir</li> </ul>"},{"location":"blog/Linux/hardware/","title":"Hardware","text":""},{"location":"blog/Linux/hardware/#_1","title":"\u5185\u5b58","text":"<p>How to Check Memory Usage in Linux, 5 Simple Commands</p>"},{"location":"blog/Linux/hardware/#numa","title":"NUMA","text":"<p>Non Uniform Memory Access \u975e\u5747\u5300\u5185\u5b58\u8bbf\u95ee\u6a21\u578b\u3002</p> <p>\u53c2\u8003\uff1a</p> <ul> <li>Linux \u5185\u6838 101\uff1aNUMA\u67b6\u6784</li> <li>CPU \u62d3\u6251\uff1a\u4ece SMP \u8c08\u5230 NUMA \uff08\u7406\u8bba\u7bc7\uff09</li> <li>\u7406\u89e3 NUMA \u67b6\u6784</li> </ul>"},{"location":"blog/Linux/network/","title":"\u7f51\u7edc","text":""},{"location":"blog/Linux/network/#_2","title":"\u5b89\u88c5","text":"<pre><code>sudo apt install net-tools\n</code></pre>"},{"location":"blog/Linux/network/#_3","title":"\u547d\u4ee4","text":"<ul> <li><code>ip</code> - show / manipulate routing, devices, policy routing and tunnels.</li> </ul>"},{"location":"blog/Linux/process/","title":"\u8fdb\u7a0b\u548c\u7ebf\u7a0b","text":"<p>\u53c2\u8003\u8d44\u6599\uff1a</p> <p>Linux manunal page: <code>man pthreads</code></p>"},{"location":"blog/Linux/process/#_2","title":"\u76f8\u5173\u51fd\u6570","text":""},{"location":"blog/Linux/process/#idid","title":"\u83b7\u53d6\u8fdb\u7a0bID\u548c\u7ebf\u7a0bID","text":"<ul> <li><code>getpid</code></li> <li><code>syscall(__NR_gettid)</code> \u6216 <code>syscall(SYS_gettid)</code> - \u53c2\u8003</li> <li><code>pthread_self</code></li> </ul> <pre><code>auto pid = getpid();\nauto tid = syscall(__NR_gettid);\nchar program[64];\nauto n = readlink(\"/proc/self/exe\", program, sizeof(program) - 1);\n</code></pre>"},{"location":"blog/Linux/resources/","title":"Resources","text":"<p>\u9ed1\u9a6c\u7a0b\u5e8f\u5458</p>"},{"location":"blog/Linux/system/","title":"System","text":"<p>lshosts</p> <pre><code>Displays hosts and their static resource information.\n</code></pre>"},{"location":"blog/Linux/tools/","title":"Tools","text":""},{"location":"blog/Linux/tools/#_1","title":"\u865a\u62df\u7ec8\u7aef\u5de5\u5177","text":""},{"location":"blog/Linux/tools/#ssh","title":"ssh","text":""},{"location":"blog/Linux/tools/#rsh","title":"rsh","text":""},{"location":"blog/Linux/tools/#screen","title":"screen","text":"<p>\u865a\u62df\u7ec8\u7aef\u7ba1\u7406\u5668\u3002</p> <p>\u4f1a\u8bdd\u4fdd\u5b58\u548c\u6062\u590d\uff1a\u4f7f\u7528<code>screen</code>\u65b0\u5efa\u4e00\u4e2a\u7ec8\u7aef\uff0c\u4f1a\u6e05\u5c4f\uff1b\u5f53\u79bb\u5f00<code>screen</code> \u7ec8\u7aef\uff08detach\u6216exit\uff09\u65f6\uff0c\u4e0a\u4e00\u6b21\u7684\u7ec8\u7aef\u754c\u9762\u53ef\u4ee5\u88ab\u6062\u590d\u3002</p> <p>\u5206\u79bb\u4f1a\u8bdd\uff1a<code>screen</code>\u521b\u5efa\u7684\u4f1a\u8bdd\u53ef\u4ee5\u5728\u540e\u53f0\u8fd0\u884c\uff0cdetach\u65b9\u6cd5\u53c2\u89c1\u535a\u5ba2\u3002\u5373\u4f7f\u7236\u7ea7\u7ec8\u7aef\u9000\u51fa\uff0cdetached\u4f1a\u8bdd\u4e5f\u4e0d\u4f1a\u505c\u6b62\uff0c\u4e4b\u540e\u65b0\u5f00\u4e00\u4e2a\u865a\u62df\u7ec8\u7aef\uff0c\u4f7f\u7528<code>screen -r</code>\u53ef\u4ee5\u6062\u590d\u4f1a\u8bdd\u3002</p> <pre><code>screen # \u521b\u5efascreen\u7ec8\u7aef\n# \u6309\u4e0b ctrl-A-Z \u4e09\u4e2a\u952e\uff0cscreen\u7ec8\u7aef\u4e0e\u7236\u7ec8\u7aef\u5206\u79bb\nexit # \u9000\u51fa\u7236\u7ec8\u7aef\n</code></pre> <p>\u65b0\u5f00\u4e00\u4e2a\u7ec8\u7aef\uff1a <pre><code>screen -r # screen\u7ec8\u7aef\u88ab\u6062\u590d\n</code></pre></p> <p>\u6ce8\u610f\uff1a \u8fd9\u548c\u4f7f\u7528<code>&amp;</code>\u6216<code>ctrl-Z</code>\u521b\u5efa\u7684\u540e\u53f0\u8fdb\u7a0b\u4e0d\u540c\uff0c\u5982\u679c\u7236terminal\u9000\u51fa\uff0c\u5219\u540e\u53f0\u8fdb\u7a0b\u4f1a\u6536\u5230<code>HUP</code>\u4fe1\u53f7\u800c\u9000\u51fa\u3002</p>"},{"location":"blog/Linux/tools/#_2","title":"\u6587\u4ef6\u4e0b\u8f7d","text":""},{"location":"blog/Linux/tools/#rcp","title":"rcp","text":""},{"location":"blog/Linux/tools/#scp","title":"scp","text":""},{"location":"blog/Linux/tools/#curl","title":"curl","text":"<pre><code>curl -o \\&lt;dest\\&gt; \\&lt;url\\&gt;\n</code></pre>"},{"location":"blog/Linux/tools/#wget","title":"wget","text":""},{"location":"blog/Linux/tools/#ftp","title":"ftp","text":"<pre><code>SYNOPSIS\n    tnftp [-46AadefginpRtVv?] [-N netrc] [-o output] [-P port] [-q quittime] [-r retry] [-s srcaddr] [-T dir,max[,inc]] [-x xfersize] [[user@]host [port]] [[user@]host:[path][/]] [file:///path] [ftp://[user[:password]@]host[:port]/path[/][;type=type]] [http://[user[:password]@]host[:port]/path] [https://[user[:password]@]host[:port]/path] ...\n\n    tnftp -u url file ...\n</code></pre> <ul> <li>\u53c2\u8003\uff1aFTP\u83b7\u53d6\u6587\u4ef6</li> <li>\u547d\u4ee4\u884c\u8f93\u5165<code>ftp</code>\uff0c\u8fdb\u5165ftp\u5ba2\u6237\u7aef\u3002</li> <li>FTP\u547d\u4ee4\uff1a<ul> <li><code>open host [port]</code></li> <li><code>get remote-file [local-file]</code></li> <li><code>cd</code></li> <li><code>ls</code></li> <li><code>binary</code> - Set the file transfer type to support binary image transfer.</li> <li><code>bye</code> - Terminate the FTP session with the remote server and exit ftp. An end of file will also terminate the session and exit.</li> </ul> </li> </ul> <p>\u4f8b\u5982\u4ee5\u4e0bURL\uff1a</p> <pre><code>ftp://aaa:bbb@ftp.adbc.com/out/a.txt\n</code></pre> <p>\u5728\u8fd9\u4e2aURL\u4e2d\uff0caaa\u662f\u7528\u6237\u540d\uff0cbbb\u662f\u5bc6\u7801\uff0cftp.adbc.com\u662fFTP\u670d\u52a1\u5668\u57df\u540d\uff0cout/a.txt\u662f\u6587\u4ef6\u8def\u5f84\u548c\u6587\u4ef6\u540d\u3002\u8fd9\u4e2aURL\u53ef\u4ee5\u7528\u4e8e\u8fde\u63a5\u5230FTP\u670d\u52a1\u5668\u5e76\u4e0b\u8f7da.txt\u6587\u4ef6\u3002</p>"},{"location":"blog/Linux/tools/#_3","title":"\u67e5\u627e\u548c\u66ff\u6362","text":""},{"location":"blog/Linux/tools/#find","title":"find","text":"<ol> <li> <p>\u5c06\u4e0a\u7ea7\u76ee\u5f55\u7684\u6240\u6709\u7684\u5185\u5bb9\u521b\u5efa\u6210\u8f6f\u94fe\u63a5\u3002</p> <pre><code>#File: do_all.sh\nmkdir -p subdir\ncd subdir\nfind .. -maxdepth 1 ! -name do_all.sh -type f -exec sh -c 'ln -sf {} `basename {}`' \\;\n</code></pre> <p>\u89e3\u6790\uff1a</p> <ul> <li><code>-maxdepth 1</code> - \u6700\u5927\u9012\u5f52\u67e5\u627e\u6df1\u5ea6\u4e3a<code>1</code>\u3002\u8fd9\u4e00\u70b9\u5f88\u91cd\u8981\uff0c\u5426\u5219\u9012\u5f52\u67e5\u627e\u8fdb\u5165subdir\u4e4b\u540e\uff0c\u4f1a\u9677\u5165\u6b7b\u5faa\u73af\u3002</li> <li><code>! -name do_all.sh</code> - \u9664\u4e86do_all.sh\u6587\u4ef6\u672c\u8eab\u3002</li> <li><code>-type f</code> - \u53ea\u67e5\u627e\u666e\u901a\u6587\u4ef6\uff08\u4e0d\u5305\u542b\u8f6f\u94fe\u63a5\uff09\u3002</li> <li><code>-exec</code> - \u540e\u9762\u8ddf\u9700\u8981\u6267\u884c\u7684\u5b50\u547d\u4ee4\uff0c\u8fd9\u91cc\u7684\u5b50\u547d\u4ee4\u4e3a<code>sh -c</code>\uff0c\u8fd9\u91cc<code>sh -c</code>\u662f\u5fc5\u987b\u7684\uff0c\u5426\u5219\u65e0\u6cd5\u89e3\u6790<code>`basename {}`</code>\uff08\u5373\u5148\u6267\u884c<code>basename</code>\u547d\u4ee4\uff0c\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9<code>ln</code>\uff09\u3002\u53ef\u80fd\u539f\u56e0\u662f<code>-exec</code>\u7684\u547d\u4ee4\u4f53\u65e0\u6cd5\u8bc6\u522b<code>`&lt;subcommand&gt;`</code>\u7684\u8bed\u6cd5\uff0c\u4e5f\u8bb8\u8fd9\u79cd\u8bed\u6cd5\u662f<code>bash</code>\u5185\u7f6e\u7684\u3002</li> <li> <p><code>\\;</code> - <code>find</code>\u7684<code>-exec</code>\u9009\u9879\u5fc5\u987b\u4ee5<code>;</code>\u7ed3\u5c3e\uff0c\u4f46\u662f<code>;</code>\u4f1a\u88ab<code>bash</code>\u8ba4\u4e3a\u662f\u6574\u6761<code>find</code>\u547d\u4ee4\u7684\u7ed3\u675f\u6807\u8bb0\uff0c\u800c\u4e0d\u662f<code>-exec</code>\u7684\u5b50\u547d\u4ee4\u4f53\u7684\u7ed3\u675f\u6807\u8bb0\uff0c\u6240\u4ee5\u9700\u8981\u8f6c\u4e49\uff08escape\uff09\u3002</p> </li> <li> <p><code>-exec</code> \u4e2d <code>{} \\;</code> \u548c <code>{} +</code> \u7684\u533a\u522b\uff1a</p> <p><code>{} \\;</code>: \u5bf9\u6bcf\u4e2a find \u7684\u7ed3\u679c\u90fd\u6267\u884c\u4e00\u6b21 <code>-exec</code> \u540e\u7684\u547d\u4ee4\uff1b <code>{} +</code>: \u5c06\u6240\u6709 find \u7684\u7ed3\u679c\u4f5c\u4e3a\u53c2\u6570\u4e00\u6b21\u6027\u4f20\u9012\u7ed9 <code>-exec</code> \u540e\u7684\u547d\u4ee4\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c<code>-exec</code> \u540e\u7684\u547d\u4ee4\u53ea\u6267\u884c\u4e86 1 \u6b21\uff08\u5b58\u7591\uff1a<code>man page</code> \u7684\u8bf4\u6cd5\u4e3a\u201c\u547d\u4ee4\u88ab\u8c03\u7528\u7684\u6b21\u6570\u8fdc\u8fdc\u5c11\u4e8e\u641c\u7d22\u51fa\u7684\u6587\u4ef6\u540d\u201d\uff09\u3002</p> </li> </ul> </li> <li> <p>\u5220\u9664\u6240\u6709\u7684\u53ef\u6267\u884c\u6587\u4ef6</p> <p><code>find -type f -executable | xargs rm</code></p> <p>\u89e3\u6790\uff1a</p> <ul> <li><code>-type f</code>\uff1a\u8868\u793a\u627e\u51fa\u666e\u901a\u6587\u4ef6\u3002</li> <li><code>-executable</code>\uff1a\u627e\u51fa\u5177\u6709\u53ef\u6267\u884c\u6743\u9650\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u3002</li> </ul> </li> </ol>"},{"location":"blog/Linux/tools/#tr","title":"tr","text":"<p>translate or delete characters.</p>"},{"location":"blog/Linux/tools/#dd","title":"dd","text":"<p>Copy a file, converting and formatting according to the operands.</p>"},{"location":"blog/Linux/tools/#_4","title":"\u6587\u6863\u9605\u8bfb\u5668","text":""},{"location":"blog/Linux/tools/#tail","title":"tail","text":"<pre><code>-f, --follow[={name|descriptor}]\noutput appended data as the file grows;\n\nan absent option argument means 'descriptor'\n</code></pre>"},{"location":"blog/Linux/tools/#less","title":"less","text":"<p>\u6bd4<code>more</code>\u529f\u80fd\u66f4\u591a\uff0c\u4e0d\u652f\u6301\u8bed\u6cd5\u9ad8\u4eae\u3002\u8bed\u6cd5\u9ad8\u4eae\u63d2\u4ef6\u89c1\u94fe\u63a5\u3002</p> <p>ESC-u \u53d6\u6d88\u641c\u7d22\u9ad8\u4eae\uff08\u8be5\u5feb\u6377\u952e\u5bf9manual page\u540c\u6837\u9002\u7528\uff09\u3002</p>"},{"location":"blog/Linux/tools/#_5","title":"\u6253\u5305\u548c\u89e3\u538b\u7f29","text":""},{"location":"blog/Linux/tools/#tar","title":"tar","text":"<pre><code>\u9009\u9879\uff1a\n-c, --create\n    create a new archive.\n\n-x, --extract, --get\n    Extract files from an archive.\n\n-z, --gzip, --gnuzip, --ungzip\n    Filter the archive through `gzip`(1).\n\n-Z, --compress, --uncompress\n    Filter the archive through `compress`(1).\n\n-A, --catenate, --concatenate\n    Append archive to the end of another archive.\n\n    Compressed archives cannot be concatenated.\n\n-v, --verbose\n\n-f ARCHIVE\n\n-t, --list\n    List the contents of an archive.\n\n-k, --keep-old-files\n\n\u6253\u5305\uff1a\n    tar czvf dest src1 src2...\n    \u5176\u4e2d\uff0cdest\u662f\u751f\u6210\u7684\u6587\u4ef6\u540d\uff08\u4e0d\u662f\u76ee\u5f55\uff09\uff0csrc\u53ef\u4ee5\u662f\u76ee\u5f55\u6216\u6587\u4ef6\u3002\n    tar czvf file.tar.gz /etc *.txt\n\n\u89e3\u5305\uff1a\n    tar zxvf file\n</code></pre>"},{"location":"blog/Linux/tools/#compress","title":"compress","text":"<pre><code>compress/uncompress\n    -c\n    makes compress/uncompress write to the standard output; no files are changed.\n\nzcat\n    is identical to `uncompress -c`.\n</code></pre>"},{"location":"blog/Linux/tools/#_6","title":"\u8fdb\u7a0b\u7ba1\u7406","text":""},{"location":"blog/Linux/tools/#ptack","title":"ptack","text":"<pre><code>while true; do\n    sleep 1 &amp;\n    pstack &lt;pid&gt;\n    wait # for sleep\ndone\n</code></pre> <pre><code>while sleep 1\ndo\n    pstack &lt;pid&gt;\ndone\n</code></pre>"},{"location":"blog/Linux/tools/#ps","title":"ps","text":""},{"location":"blog/Linux/tools/#pstree","title":"pstree","text":""},{"location":"blog/Linux/tools/#pidof","title":"pidof","text":""},{"location":"blog/Linux/tools/#pgrep","title":"pgrep","text":"<p>\u6253\u5370\u4e0e\u6a21\u5f0f\u5b57\u7b26\u4e32\u5339\u914d\u7684\u8fdb\u7a0b\u7684ID\u3002</p> <p>For example,</p> <pre><code>$ pgrep -u root sshd\n</code></pre> <p>will only list the processes called sshd AND owned by root.  On the other hand,</p> <pre><code>$ pgrep -u root,daemon\n</code></pre> <p>will list the processes owned by root OR daemon.</p>"},{"location":"blog/Linux/tools/#fg","title":"fg","text":"<p>bash\u5185\u7f6e\u547d\u4ee4\uff0c\u540e\u53f0\u8fdb\u7a0b\u79fb\u52a8\u5230\u524d\u53f0\u3002<code>fg --help</code>\u67e5\u770b\u5e2e\u52a9\u3002<code>/path/to/command &amp;</code>\u4f1a\u65b0\u5efa\u4e00\u4e2a\u540e\u53f0\u8fdb\u7a0b\u3002</p>"},{"location":"blog/Linux/tools/#bg","title":"<code>bg</code>","text":"<p>bash\u5185\u7f6e\u547d\u4ee4\uff0c\u524d\u53f0\u8fdb\u7a0b\u79fb\u52a8\u5230\u540e\u53f0\u3002\u53ef\u4ee5\u4f7f\u7528<code>ctrl-Z</code>\u5148\u5c06\u8fdb\u7a0bsuspend\uff0c\u7136\u540e\u4f7f\u7528<code>bg %job_num</code>\u5c06\u5176\u5207\u6362\u5230\u540e\u53f0\u8fd0\u884c\u3002</p>"},{"location":"blog/Linux/tools/#jobs","title":"jobs","text":"<p><code>jobs -l</code> - bash\u5185\u7f6e\u547d\u4ee4\uff0c\u67e5\u770b\u6240\u6709jobs\u3002</p>"},{"location":"blog/Linux/tools/#bjobs","title":"bjobs","text":"<p>LSF\u547d\u4ee4</p> <p>LSF, Load Sharing Facility</p> <ul> <li><code>bjobs</code></li> </ul>"},{"location":"blog/Linux/tools/#_7","title":"\u8fdb\u7a0b\u95f4\u901a\u4fe1","text":""},{"location":"blog/Linux/tools/#chattr","title":"chattr","text":"<p>\u53c2\u8003\uff1a\u9501\u5b9a\u6587\u4ef6\u547d\u4ee4chattr</p>"},{"location":"blog/Linux/tools/#lsattr","title":"lsattr","text":"<p>\u53ea\u5bf9<code>ext</code>\u6587\u4ef6\u7cfb\u7edf\u6709\u6548\uff0c\u5bf9<code>nfs</code>\u4e4b\u7c7b\u6587\u4ef6\u7cfb\u7edf\u65e0\u6548\uff0c\u53ef\u4ee5\u901a\u8fc7<code>df -T</code>\u6253\u5370\u6587\u4ef6\u7cfb\u7edf\u7684\u7c7b\u578b\u3002</p>"},{"location":"blog/Linux/tools/#flock","title":"flock","text":"<p>\u8bfb\u5199\u9501\u3002\u4f8b\u5982\u6d4b\u8bd5\u65f6\u53ef\u4ee5\u901a\u8fc7<code>flock &lt;filename&gt; cat</code>\u6301\u6709\u9501\uff0c\u7136\u540e\u7b49\u5f85<code>cat</code>\u7684\u8f93\u5165\uff0c\u4e5f\u5c31\u662f\u5b9e\u73b0\u6301\u9501\u7b49\u5f85\u3002</p> <p>\u53c2\u8003\uff1a</p> <ul> <li>\u4e09\u4e2a\u9501\u5b9a\u6587\u4ef6\u547d\u4ee4</li> <li>linux \u6587\u4ef6\u9501 \u547d\u4ee4</li> </ul>"},{"location":"blog/Linux/tools/#_8","title":"\u8f6f\u4ef6\u5305\u7ba1\u7406\u5668","text":""},{"location":"blog/Linux/tools/#apt-cache","title":"apt-cache","text":"<p><code>apt-cache search</code> - RedHat\u4e0a\u7b49\u4ef7\u547d\u4ee4\u4e3a<code>yum --cacheonly list</code>\u3002</p>"},{"location":"blog/Linux/kernel/kernel/","title":"\u5185\u6838\u7f16\u8bd1","text":"<p>obj-m: \u94fe\u63a5</p> <p>make modules: \u94fe\u63a5</p>"},{"location":"blog/Linux/kernel/kernel/#_2","title":"\u7f16\u8bd1\u5185\u6838\u6a21\u5757","text":"<p>\u6587\u6863</p> <p>Makefile:</p> <pre><code>obj-m += hello-1.o\n\nall:\n    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) modules\n\nclean:\n    make -C /lib/modules/$(shell uname -r)/build M=$(PWD) clean\n</code></pre> <p><code>make -C</code> changes to a new directory where the new makefiles will be run.</p> <p><code>M=$(PWD)</code> defines a variable <code>M</code> which the child makefiles can use.</p>"},{"location":"blog/Linux/kernel/kernel/#_3","title":"\u547d\u4ee4","text":"<ul> <li><code>insmod</code>: \u63d2\u5165\u4e00\u4e2a\u6a21\u5757\uff08.ko\uff09\u5230kernel\u4e2d\u3002</li> <li><code>rmmod</code>: \u4ece\u5185\u6838\u4e2d\u5220\u9664\u4e00\u4e2a\u6a21\u5757\u3002</li> <li><code>modprobe</code>: \u4ece\u5185\u6838\u4e2d\u589e\u5220\u6a21\u5757\u3002<code>modprobe</code>\u4ece<code>/lib/modules/`uname -r`</code>\u4e2d\u641c\u7d22\u6240\u6709\u7684\u6a21\u5757\u548c\u5176\u4ed6\u6587\u4ef6\uff0c\u9664\u4e86<code>/etc/modprobe.d</code>\u76ee\u5f55\u4e2d\u7684\u53ef\u9009\u914d\u7f6e\u6587\u4ef6\uff08\u53c2\u89c1<code>modprobe.d(5)</code>\uff09\u3002</li> <li><code>lsmod</code>: \u663e\u793a\u5f53\u524d\u52a0\u8f7d\u7684\u5185\u6838\u6a21\u5757\u7684\u72b6\u6001\uff08\u5373\u5bf9<code>/proc/modules</code>\u5185\u5bb9\u7684\u683c\u5f0f\u5316\uff09\u3002</li> <li><code>modinfo</code>: \u4ece\u547d\u4ee4\u884c\u6307\u5b9a\u7684\u5185\u6838\u6a21\u5757\u4e2d\u63d0\u53d6\u4fe1\u606f\uff0c\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u6a21\u5757\u540d\u79f0\uff0c\u90a3\u4e48\u4f1a\u641c\u7d22<code>/lib/modules/version</code>\u76ee\u5f55\uff0c\u5c31\u50cf<code>modprobe</code>\u52a0\u8f7d\u6a21\u5757\u65f6\u4e00\u6837\u3002</li> <li><code>depmod</code>: \u751f\u6210<code>modules.dep</code>\u548c\u6620\u5c04\u6587\u4ef6\u3002</li> <li><code>dmesg</code>: \u6253\u5370\u6216\u63a7\u5236\u5185\u6838ring buffer\uff08\u5b58\u50a8kernel message\uff09\u3002</li> </ul>"},{"location":"blog/Linux/shell/","title":"Shell\u7b14\u8bb0","text":""},{"location":"blog/Linux/shell/#_1","title":"\u53c2\u8003","text":"<ul> <li>GNU bash manual</li> </ul>"},{"location":"blog/Linux/shell/bash_builtin/","title":"Bash Builtin","text":"<p><code>command</code> - bash\u5185\u7f6e\u547d\u4ee4\uff0c\u7528\u4e8e\u67e5\u8be2\u547d\u4ee4\u3002</p> <ul> <li><code>command -p &lt;command&gt;</code> \u4f1a\u4ecePATH\u4e2d\u67e5\u627e\u5e76\u4e14\u6267\uff0c\u4f7f\u7528command -p\u662f\u4e3a\u4e86\u4fdd\u8bc1\u627e\u5230\u7684\u662f\u6765\u81eaPATH\u7684\u6807\u51c6\u7a0b\u5e8f\u3002 <p><code>type</code> - \u67e5\u770b\u4e00\u4e2a\u547d\u4ee4\u662f\u5426\u662fbash\u5185\u7f6e\u3002</p>"},{"location":"blog/Linux/shell/condition_statements/","title":"\u6761\u4ef6\u8bed\u53e5","text":""},{"location":"blog/Linux/shell/condition_statements/#if","title":"<code>if</code>","text":"<p>\u53c2\u8003\u6587\u6863\u3002</p> <p><code>=</code>\u3001<code>==</code>\u3001<code>-eq</code>\u533a\u522b\uff08\u53c2\u8003\u94fe\u63a5\uff09\uff1a</p> <ul> <li><code>=</code>\u548c<code>==</code>\uff1a\u7528\u4e8e\u5b57\u7b26\u4e32\u6bd4\u8f83\u3002<code>==</code>\u9650\u5b9a\u4e8ebash\u4e2d\uff0cPOSIX\u4f7f\u7528<code>=</code>\u3002\u5728bash\u4e2d\uff0c<code>=</code>\u548c<code>==</code>\u76f8\u540c\uff0c<code>=</code>\u6700\u597d\u4e0ebash\u5185\u7f6e\u7684<code>test</code>\u547d\u4ee4\u4e00\u8d77\u4f7f\u7528\u4ee5\u786e\u4fddPOSIX\u4e00\u81f4\u6027\u3002</li> <li><code>-eq</code>\uff1a\u7528\u4e8e\u6570\u5b57\u6bd4\u8f83\u3002\u4e0e<code>-lt</code>\u3001<code>-le</code>\u3001<code>-gt</code>\u3001<code>-ge</code>\u3001<code>-ne</code>\u5c5e\u4e8e\u540c\u4e00\u4e2a\u5bb6\u65cf\u3002</li> </ul>"},{"location":"blog/Linux/shell/debug_bash/","title":"Debug Bash","text":"<p>\u53c2\u8003\uff1a\u6587\u6863\u3002</p>"},{"location":"blog/Linux/shell/file/","title":"\u786c\u94fe\u63a5\u548c\u8f6f\u94fe\u63a5\u7684\u533a\u522b","text":"<p>\u53c2\u8003\uff1a\u535a\u5ba2\u548cstackoverflow\u3002</p> <p></p>"},{"location":"blog/Linux/shell/install_so/","title":"Install So","text":"<p>\u6536\u5f55\u7a0b\u5e8f\u7f16\u8bd1\u3001\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u7684\u5e38\u89c1\u547d\u4ee4\u3002</p>"},{"location":"blog/Linux/shell/install_so/#objdump","title":"objdump","text":"<ol> <li> <p>\u5224\u65adso\u6216binary\u6587\u4ef6\u662f64bit\u8fd8\u662f32bit</p> <p><code>objdump -f filename</code></p> <p>\u5176\u4e2d\uff0c\"elf64-x86-64\"\u8868\u793a64bit.</p> </li> </ol>"},{"location":"blog/Linux/shell/process/","title":"Process","text":""},{"location":"blog/Linux/shell/process/#_1","title":"\u547d\u4ee4","text":"<p>pstack - print a stack trace of running processes</p> <pre><code>while true; do\nsleep 1 &amp;\n...your stuff here...\nwait # for sleep\ndone\n</code></pre> <p>pmap - report memory map of a process</p> <p>nm - list symbols from object files</p> <p>top</p> <p>Refer to here</p> <p>Virtual memory</p> <p>sort ascending scroll down:</p> <pre><code>key      equivalent-key-combinations\nUp       alt + \\      or  alt + k\nDown     alt + /      or  alt + j\nLeft     alt + &lt;      or  alt + h\nRight    alt + &gt;      or  alt + l (lower case L)\nPgUp     alt + Up     or  alt + ctrl + k\nPgDn     alt + Down   or  alt + ctrl + j\nHome     alt + Left   or  alt + ctrl + h\nEnd      alt + Right  or  alt + ctrl + l\n</code></pre> <p>top + grep:     top -p <code>pgrep \"java\"</code>     top | grep</p> <p>free</p> <p>smem</p>"},{"location":"blog/Linux/shell/process/#_2","title":"\u6587\u4ef6\u7cfb\u7edf","text":"<p>/proc/iomem</p> <p>/proc/self/exe</p> <p>/proc/\\&lt;pid&gt;/exe</p>"},{"location":"blog/Linux/shell/process/#_3","title":"\u51fd\u6570","text":"<p>glic Functions</p> <pre><code>backtrace\nbacktrace_symbols\nbacktrace_symbols_fd\n</code></pre> <pre><code>#include &lt;execinfo.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid print_trace() {\n    static const int SIZE = 10;\n\n    void* buffer[SIZE];\n    char** strings;\n    int size, i;\n\n    size = backtrace(buffer, SIZE);\n    strings = backtrace_symbols(buffer, size);\n    if (strings != NULL) {\n        printf(\"Obtained %d stack frames.\\n\", size);\n        for (i = 0; i &lt; size; ++i)\n            printf(\"%s\\n\", strings[i]);\n        free(strings);\n    }\n}\n</code></pre> <p>ptrace - process trace</p>"},{"location":"blog/Linux/shell/pts/","title":"\u865a\u62df\u7ec8\u7aef","text":"<p>\u53c2\u8003\u94fe\u63a5</p>"},{"location":"blog/Linux/shell/recipes/","title":"Recipes","text":""},{"location":"blog/Linux/shell/recipes/#_1","title":"\u76f8\u5173\u7b26\u53f7","text":"<ul> <li><code>$()</code> - \u4e0e <code>`command`</code>\u76f8\u540c</li> </ul>"},{"location":"blog/Linux/shell/recipes/#shell","title":"\u5e38\u89c1shell\u547d\u4ee4","text":"<p><code>echo</code></p> <pre><code>echo -e \"Hello\\nWorld\"#-e\u652f\u6301\u6362\u884c\uff0c\u4f7f\u7528printf\u547d\u4ee4\u66f4\u597d\necho *\necho o*\necho ~\n</code></pre> <p>\u94fe\u63a5</p>"},{"location":"blog/Linux/shell/recipes/#bash","title":"bash\u6570\u636e\u7c7b\u578b","text":"<p>array</p> <pre><code>a=(a1 a2 a3)\n</code></pre>"},{"location":"blog/Linux/shell/recipes/#punctuation-marks","title":"\u7279\u6b8a\u7b26\u53f7\uff08Punctuation Marks\uff09","text":"<p>See: <code>man bash</code> --&gt; <code>EXPANSION</code> section</p> <pre><code>!\n${!parameter} \u53d6\u53d8\u91cf$parameter\u7684\u503c\u4f5c\u4e3a\u53d8\u91cf\u540d\u3002\n${}\n$()\n``\n#\n$var\n{1..5}\n</code></pre>"},{"location":"blog/Linux/shell/regexp/","title":"\u5f15\u8a00","text":"<p>\u672c\u7ae0\u8bb0\u5f55\u6b63\u5219\u8868\u8fbe\u5f0f\u76f8\u5173\u8bed\u6cd5\u3002</p>"},{"location":"blog/Linux/shell/regexp/#patterns","title":"\u6a21\u5f0f\uff08patterns\uff09","text":"<ul> <li><code>glob</code> : \u4e3b\u8981\u7528\u4e8e\u5339\u914d\u5e26\u6709\u901a\u914d\u7b26\u7684\u6587\u4ef6\u8def\u5f84\u3002\u5176\u5339\u914d\u5b57\u7b26\u4e32\u7684\u80fd\u529b\u6bd4\u6b63\u5219\u8868\u8fbe\u5f0f\u5f31\u3002</li> </ul> <p>\u5b83\u6700\u521d\u662f\u8d1d\u5c14\u5b9e\u9a8c\u5ba4 Unix \u7cfb\u7edf\u4e0a\u7684\u4e00\u4e2a\u540d\u53eb glob \u7684\u547d\u4ee4\uff08glob \u662f global \u7684\u7f29\u5199\uff09\uff0c\u7528\u4e8e\u5c55\u5f00\u547d\u4ee4\u884c\u4e2d\u7684\u901a\u914d\u7b26\u3002\u540e\u6765\u7cfb\u7edf\u63d0\u4f9b\u4e86\u8be5\u529f\u80fd\u7684 C \u8bed\u8a00\u5e93\u51fd\u6570glob()\uff0c\u77e5\u540d\u7684 shell \u89e3\u91ca\u5668\u5c31\u4f7f\u7528\u4e86\u8be5\u63a5\u53e3\uff0cshell \u811a\u672c\u548c\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528\u7684 glob \u6a21\u5f0f\u5339\u914d\u529f\u80fd\u4fbf\u6e90\u81ea\u4e8e\u6b64\u3002\u2014\u2014\u89c1\u535a\u5ba2\u3002</p> <ul> <li><code>regexp</code> : \u6b63\u5219\u8868\u8fbe\u5f0f\u3002</li> </ul>"},{"location":"blog/Linux/shell/regexp/#grep","title":"\u547d\u4ee4<code>grep</code>","text":""},{"location":"blog/Linux/shell/regexp/#grep_1","title":"<code>grep</code>\u9009\u9879","text":"<ul> <li><code>--exclude=GLOB</code> : \u6392\u9664\u7b26\u5408GLOB\u901a\u914d\u7b26\u6761\u4ef6\u7684\u7279\u5b9a\u6587\u4ef6\u3002A file-name glob can use <code>*</code>, <code>?</code>, and <code>[...]</code> as wildcards, and <code>\\</code> to quote a wildcard or backslash character literally.</li> <li><code>--include=GLOB</code> : \u641c\u7d22\u7b26\u5408GLOB\u901a\u914d\u7b26\u6761\u4ef6\u7684\u7279\u5b9a\u6587\u4ef6\u3002</li> </ul> <p>e.g. <code>grep -rn --include='*.\u540e\u7f00\u540d' \"\u68c0\u7d22\u8bcd\"</code> --- \u53c2\u8003\u94fe\u63a5</p> <ul> <li><code>--exclude-from=FILE</code></li> <li><code>--exclude-dir=DIR</code></li> <li><code>-r</code> : \u9012\u5f52\u641c\u7d22\u6bcf\u4e2a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u3002\u53ea\u6709\u5f53\u7b26\u53f7\u94fe\u63a5\u5728\u547d\u4ee4\u884c\u4e0a\u65f6\uff0c\u624d\u8ddf\u8e2a\u94fe\u63a5\u3002\u8be5\u9009\u9879\u548c<code>-d recurse</code>\u7b49\u4ef7\u3002</li> <li><code>-R</code> : \u548c<code>-r</code>\u76f8\u540c\uff0c\u533a\u522b\u5728\u4e8e\u672c\u9009\u9879\u8ddf\u8e2a\u6240\u6709\u7684\u7b26\u53f7\u94fe\u63a5\u3002</li> <li><code>--include=GLOB</code> : \u53ea\u641c\u7d22\u4e0eGLOB\u5339\u914d\u7684\u6587\u4ef6\u3002</li> </ul>"},{"location":"blog/Linux/shell/system_info/","title":"System Info","text":"<ul> <li><code>lsb_release</code> - FSG lsb_release v2.0 prints certain LSB (Linux Standard Base) and Distribution information.</li> </ul>"},{"location":"blog/Linux/shell/variables/","title":"\u53d8\u91cf\uff08variables\uff09","text":""},{"location":"blog/Linux/shell/variables/#_1","title":"\u5f15\u7528\u53d8\u91cf","text":"<ul> <li><code>$var</code> - \u8868\u793a\u5f15\u7528\u53d8\u91cf<code>var</code>\u3002</li> <li><code>${}</code> - \u4e00\u79cd\u6d88\u9664\u6b67\u4e49\u7684\u673a\u5236\uff0c\u4e5f\u7528\u6765\u5f15\u7528\u53d8\u91cf\u3002\u6bd4\u5982<code>${var}test</code>\u8868\u793a\u53d8\u91cf<code>var</code>\u7684\u5185\u5bb9\u8ddf\u4e0a<code>test</code>\uff0c\u800c<code>$vartest</code>\u5219\u8868\u793a<code>vartest</code>\u53d8\u91cf\u3002</li> </ul>"},{"location":"blog/Linux/shell/variables/#scope","title":"\u53d8\u91cf\u4f5c\u7528\u57df\uff08scope\uff09","text":"<ul> <li>\u5c40\u90e8\uff08local\uff09- \u5728shell\u51fd\u6570\u4e2d\u52a0\u4e0a<code>local</code>\u5173\u952e\u5b57\u7684\u53d8\u91cf\u4e3a\u5c40\u90e8\u53d8\u91cf\u3002</li> <li>\u5168\u5c40\uff08global\uff09- shell\u4e2d\u53d8\u91cf\u9ed8\u8ba4\u4e3a\u5168\u5c40\u53ef\u89c1\uff08\u5f53\u524dshell\u53ef\u89c1\uff09\u3002</li> <li>\u73af\u5883\uff08environment\uff09</li> </ul> <p>Example\uff1a</p> <pre><code>#!/bin/bash\n# Global and local variables inside a function.\n\nfunc ()\n{\nlocal loc_var=23       # Declared as local variable.\necho                   # Uses the 'local' builtin.\necho \"\\\"loc_var\\\" in function = $loc_var\"\nglobal_var=999         # Not declared as local.\n                        # Defaults to global. \necho \"\\\"global_var\\\" in function = $global_var\"\n}  \n\nfunc\n\n# Now, to see if local variable \"loc_var\" exists outside function.\n\necho\necho \"\\\"loc_var\\\" outside function = $loc_var\"\n                                    # $loc_var outside function = \n                                    # No, $loc_var not visible globally.\necho \"\\\"global_var\\\" outside function = $global_var\"\n                                    # $global_var outside function = 999\n                                    # $global_var is visible globally.\necho                      \n\nexit 0\n#  In contrast to C, a Bash variable declared inside a function\n#+ is local *only* if declared as such.\n</code></pre>"},{"location":"blog/Linux/shell/variables/#_2","title":"\u7279\u6b8a\u53d8\u91cf","text":"<p>\u53c2\u8003\u94fe\u63a5\u3002</p> Special Variable Description <code>$0</code> Gets the name of the current script. <code>$#</code> Gets the number of arguments passed while executing the bash script. <code>$*</code> Gives you a string containing every command-line argument. <code>$@</code> It stores the list of every command-line argument as an array. <code>$1-$9</code> Stores the first 9 arguments. <code>$?</code> Gets the status of the last command or the most recently executed process. <code>$!</code> Shows the process ID of the last background command. <code>$$</code> Gets the process ID of the current shell. <code>$-</code> It will print the current set of options in your current shell. <code>!$</code> the \"end\" of the previous command.1 <code>[@]</code> \u4e0e<code>$*</code>\u7c7b\u4f3c\uff0c\u6bd4\u5982<code>${LIST[*]}</code>\u5c06\u53d8\u91cf<code>LIST</code>\u7684\u5185\u5bb9\u4f5c\u4e3a\u5355\u4e2a\u53c2\u6570\u30022 <code>[*]</code> \u4e0e<code>$@</code>\u7c7b\u4f3c\uff0c\u6bd4\u5982<code>${LIST}[@]</code>\u5c06\u53d8\u91cf<code>LIST</code>\u7684\u5185\u5bb9\u4f5c\u4e3a\u4e00\u4e2a\u53c2\u6570\u5217\u8868\u30022 <p>Example:</p> <pre><code>LIST=(1 2 3)\nfor i in \"${LIST[@]}\"; do\n    echo \"example.$i\" # print three times\ndone\n</code></pre> <pre><code>LIST=(1 2 3)\nfor i in \"${LIST[*]}\"; do\n    echo \"example.$i\" # print only once\ndone\n</code></pre> <p>\u6d4b\u8bd5\u73af\u5883\u53d8\u91cf\u662f\u5426\u5b58\u5728\uff1a \u53c2\u8003\u94fe\u63a5</p>"},{"location":"blog/Linux/ssh/config/","title":"\u4e24\u53f0\u673a\u5668\u901a\u8fc7RSA\u5bc6\u94a5\u8bbf\u95ee","text":"<ol> <li> <p>\u751f\u6210\u5bc6\u94a5</p> <p>ssh-keygen</p> </li> <li> <p>\u673a\u5668A\u9700\u8981\u767b\u5f55\u5230\u673a\u5668B\u4e0a</p> <p>\u5c06A\u7684\u516c\u94a5\uff08\u4f4d\u4e8e<sub>/.ssh/id_rsa.pub\u6587\u4ef6\u4e2d\uff09\u8ffd\u52a0\u5230B\u673a\u5668\u7684</sub>/.ssh/authorized_keys\u6587\u4ef6\uff08\u5982\u679cB\u673a\u5668\u4e0a\u6ca1\u6709\u8fd9\u4e2a\u6587\u4ef6\u5219\u65b0\u5efa\u4e00\u4e2a\uff09\u4e2d\u3002</p> </li> <li> <p>\u673a\u5668A\u767b\u5f55\u5230\u673a\u5668B\u7684\u547d\u4ee4\uff1a</p> <p>ssh username@hostname</p> </li> </ol>"},{"location":"blog/cmake/find_package/","title":"Find Package","text":"<p>\u53c2\u8003\uff1a\u77e5\u4e4e</p>"},{"location":"blog/cplusplus/coredump/","title":"<code>ulimit</code>","text":"<pre><code>#\u67e5\u770b\u914d\u7f6e\nulimit -a\n#\u8bbe\u7f6ecore file size\nulimit -c unlimited\n</code></pre> <p><code>ulimit</code>\u53ea\u5bf9\u5f53\u524d\u7ec8\u7aef\u6709\u6548\u3002</p> <p>\u4ee5\u4e0b\u4e24\u79cd\u65b9\u6cd5\u5bf9\u6240\u6709\u7528\u6237\u548c\u7ec8\u7aef\u6709\u6548\uff1a</p> <ol> <li>\u5728<code>/etc/security/limits.conf</code>\u4e2d\u8bbe\u7f6e\uff08redhat\u884d\u751f\u7cfblinux\uff09\u3002</li> <li>\u6216\u6ce8\u91ca\u6389<code>/etc/profile</code>\u4e2d\u7684\u8fd9\u4e00\u884c\uff1a     <pre><code># No core files by default\nulimit -S -c 0 &gt; /dev/null 2&gt;&amp;1\n</code></pre></li> </ol>"},{"location":"blog/cplusplus/coredump/#core_pattern","title":"core_pattern","text":""},{"location":"blog/cplusplus/coredump/#core_pattern_1","title":"core_pattern\u89e3\u91ca","text":"<p>\u89c1\u94fe\u63a5\u3002</p> <p>Read /usr/src/linux/Documentation/sysctl/kernel.txt.</p> <pre><code>core_pattern is used to specify a core dumpfile pattern name.\n</code></pre> <p>\u5728\u7cfb\u7edf\u542f\u52a8\u65f6\uff0cApport\uff08crash reporting service\uff09\u4f1a\u751f\u6210\u914d\u7f6e\u6587\u4ef6<code>/proc/sys/kernel/core_pattern</code>\u3002\u53c2\u8003\u8fd9\u91cc\u3002</p> <p>Apport uses <code>/proc/sys/kernel/core_pattern</code> to directly pipe the core dump into <code>apport</code>:</p> <pre><code>$ cat /proc/sys/kernel/core_pattern\n|/usr/share/apport/apport %p %s %c\n$ \n</code></pre> <p>Note that even if <code>ulimit</code> is set to disabled core files (by specyfing a core file size of zero using <code>ulimit -c 0</code>), <code>apport</code> will still capture the crash.</p> <p>For intercepting Python crashes it installs a <code>/etc/python*/sitecustomize.py</code> to call apport on unhandled exceptions.</p> <p>\u5176\u4e2d\uff0c<code>/usr/share/apport/apport</code>\u662f\u4e00\u4e2apython\u811a\u672c\u3002</p> <p>\u4ee5\u4e0b\u662fcore_pattern\u6587\u4ef6\u7684\u53c2\u6570\u8bf4\u660e\uff08\u53c2\u8003Linux Manual Page\uff1a<code>man core</code>\uff09\uff1a <pre><code>%c - Core file size soft resource limit of crashing process (since Linux 2.6.24).\n%p - insert pid into filename \u6dfb\u52a0pid\n%u - insert current uid into filename \u6dfb\u52a0\u5f53\u524duid\n%g - insert current gid into filename \u6dfb\u52a0\u5f53\u524dgid\n%s - insert signal that caused the coredump into the filename \u6dfb\u52a0\u5bfc\u81f4\u4ea7\u751fcore\u7684\u4fe1\u53f7\n%t - insert UNIX time that the coredump occurred into filename \u6dfb\u52a0core\u6587\u4ef6\u751f\u6210\u65f6\u7684unix\u65f6\u95f4\n%h - insert hostname where the coredump happened into filename \u6dfb\u52a0\u4e3b\u673a\u540d\n%e - insert coredumping executable name into filename \u6dfb\u52a0\u547d\u4ee4\u540d\n\nIf the first character of the pattern is a '|', the kernel will treat the rest of the pattern as a command to run. The core dump will be written to the standard input of that program instead of to a file.\n</code></pre></p> <p>Apport\u7684\u62e6\u622a\u7ec4\u4ef6\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\uff1a</p> <p>Apport itself is running at all times because it collects crash data for whoopsie (see ErrorTracker). However, the crash interception component is still disabled. To enable it permanently, do:</p> <pre><code>sudo nano /etc/apport/crashdb.conf\n</code></pre> <p>... and add a hash symbol # in the beginning of the following line:</p> <pre><code>'problem_types': ['Bug', 'Package'],\n</code></pre> <p>To disable crash reporting just remove the hash symbol.</p>"},{"location":"blog/cplusplus/coredump/#core_pattern_2","title":"\u8bbe\u7f6ecore_pattern","text":"<p>\u89c1\u94fe\u63a5\u3002</p> <ol> <li> <p>/proc/sys/kernel/core_uses_pid\u53ef\u4ee5\u63a7\u5236\u4ea7\u751f\u7684core\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u4e2d\u662f\u5426\u6dfb\u52a0pid\u4f5c\u4e3a\u6269\u5c55\uff0c\u5982\u679c\u6dfb\u52a0\u5219\u6587\u4ef6\u5185\u5bb9\u4e3a1\uff0c\u5426\u5219\u4e3a0\uff1b</p> </li> <li> <p>/proc/sys/kernel/core_pattern\u53ef\u4ee5\u8bbe\u7f6e\u683c\u5f0f\u5316\u7684core\u6587\u4ef6\u4fdd\u5b58\u4f4d\u7f6e\u6216\u6587\u4ef6\u540d\uff1a</p> <pre><code>$ cat /proc/sys/kernel/core_pattern\n|/usr/share/apport/apport %p %s %c\n$ echo \"/corefile/core-%e-%p-%t\" &gt; /proc/sys/kernel/core_pattern\n</code></pre> <p>\u4f60\u53ef\u4ee5\u7528\u4e0b\u5217\u65b9\u5f0f\u6765\u5b8c\u6210\uff1a <pre><code>#\u67e5\u770b\u6240\u6709sysctl\u6240\u6709\u53d8\u91cf\u7684\u503c\u3002\nsysctl -a\n#\u8bbe\u7f6e\u53d8\u91cfkernel.core_pattern\u4e3a\u5982\u4e0b\u503c\u3002\nsudo sysctl -w kernel.core_pattern=/tmp/core-%e.%p.%h.%t\n</code></pre></p> <p>\u8fd9\u4e9b\u64cd\u4f5c\u4e00\u65e6\u8ba1\u7b97\u673a\u91cd\u542f\uff0c\u5219\u4f1a\u4e22\u5931\uff0c\u5982\u679c\u4f60\u60f3\u6301\u4e45\u5316\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5728 /etc/sysctl.conf\u6587\u4ef6\u4e2d\u589e\u52a0\uff1a <pre><code>kernel.core_pattern=/tmp/core%p\n</code></pre></p> <p>\u52a0\u597d\u540e\uff0c\u5982\u679c\u4f60\u60f3\u4e0d\u91cd\u542f\u770b\u770b\u6548\u679c\u7684\u8bdd\uff0c\u5219\u7528\u4e0b\u9762\u7684\u547d\u4ee4\uff1a <pre><code>sysctl -p /etc/sysctl.conf\n</code></pre></p> </li> </ol>"},{"location":"blog/cplusplus/coredump/#_1","title":"\u76f8\u5173\u547d\u4ee4\u884c\u5de5\u5177","text":"<p>\u53c2\u8003\u8d44\u6599\uff1a</p> <p>Linux Manual Page: <code>man core</code></p> <pre><code>SEE ALSO\n    bash(1),  coredumpctl(1),  gdb(1),  getrlimit(2), mmap(2), prctl(2), sigaction(2), elf(5), proc(5), pthreads(7), signal(7), systemd-coredump(8)\n</code></pre>"},{"location":"blog/cplusplus/coredump/#segment-fault","title":"Segment Fault\u6392\u67e5","text":"<p>\u53c2\u8003\u94fe\u63a5\u3002</p> <ol> <li>dmesg+nm+addr2line</li> </ol> <p>addr2line\u53ea\u80fd\u627e\u51faexecutable\u7684\u884c\u53f7\uff1b\u5982\u679c\u662fshared libraries\uff0c\u8bf7\u4f7f\u7528gdb\u3002\u53c2\u8003\u8fd9\u91cc\u3002</p> <p>dmesg\u8f93\u51fa\u7684\u542b\u4e49\uff1a</p> <p>ip: \u8868\u793ainstruction pointer.</p> <ol> <li>fprintf</li> <li>gdb</li> <li>signal(SIGSEGV,handler)</li> <li> <p>valgrind</p> <p>\u53c2\u8003\u8fd9\u91cc\u3002</p> </li> </ol>"},{"location":"blog/cplusplus/elf/","title":"Elf","text":"<p><code>man elf</code></p>"},{"location":"blog/cplusplus/errors/","title":"Errors","text":""},{"location":"blog/cplusplus/errors/#basic_string_m_construct-null-not-valid","title":"basic_string::_M_construct null not valid","text":"<p>C++\u6709\u4e00\u4e2a\u7f3a\u9677\uff0c\u8bf7\u770b\u4ee5\u4e0b\u4ee3\u7801\uff1a</p> <pre><code>//cpp defeat: basic_string::_M_construct null not valid\nvoid fun(string s) {\n    cout &lt;&lt; \"fun\" &lt;&lt; endl;\n}\n\nint main() {\n    fun(0); // Run-time error: basic_string::_M_construct null not valid\n}\n</code></pre> <p>\u5176\u4e2d\uff0c<code>fun(0)</code>\u7684<code>0</code>\u4f1a\u88ab\u89c6\u4e3a<code>const char*</code>\u7c7b\u578b\uff0c\u4e5f\u5c31\u662f<code>nullptr</code>\uff0c\u6240\u4ee5\u5728\u7f16\u8bd1\u671f\u53ef\u4ee5\u901a\u8fc7\u3002 \u4f46\u662f\u8fd0\u884c\u671f\u4f1a\u89e6\u53d1<code>string</code>\u5bf9\u8c61\u7684\u6784\u9020\u9519\u8bef\u201cbasic_string::_M_construct null not valid\u201d\u3002</p> <p>\u9690\u853d\u4e00\u70b9\u7684\u4ee3\u7801\uff1a</p> <pre><code>char * get_a_string() {\n    return nullptr;\n}\n\nint main() {\n    // Attention: Alaways take care that a parameter to a string should not be NULL!\n    fun(get_a_string()); // Run-time error: basic_string::_M_construct null not valid\n    // Better code\n    char * str = get_a_string();\n    fun(str != NULL? str : \"\");\n}\n</code></pre>"},{"location":"blog/cplusplus/gcc/","title":"gcc","text":""},{"location":"blog/cplusplus/gcc/#_1","title":"\u7f16\u8bd1\u8fc7\u7a0b","text":"<p>\u53c2\u8003\u535a\u5ba2</p>"},{"location":"blog/cplusplus/gcc/#_2","title":"\u9884\u5904\u7406","text":"<pre><code>gcc -E test.c -o test.i\n</code></pre>"},{"location":"blog/cplusplus/gcc/#_3","title":"\u7f16\u8bd1","text":"<pre><code>\u7ffb\u8bd1\u6210\u6c47\u7f16\u4ee3\u7801\u3002\n</code></pre> <pre><code>gcc -S test.i -o test.s\n</code></pre>"},{"location":"blog/cplusplus/gcc/#_4","title":"\u6c47\u7f16","text":"<pre><code>\u5c06\u6c47\u7f16\u4ee3\u7801\u8f6c\u6210\u673a\u5668\u7801\u3002\n</code></pre> <pre><code>gcc -c test.s -o test.o\n</code></pre>"},{"location":"blog/cplusplus/gcc/#_5","title":"\u94fe\u63a5","text":"<pre><code>\u8be5\u76ee\u6807\u6587\u4ef6\u4e0e\u5176\u4ed6\u76ee\u6807\u6587\u4ef6\u3001\u5e93\u6587\u4ef6\u3001\u542f\u52a8\u6587\u4ef6\u7b49\u94fe\u63a5\u8d77\u6765\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\u3002\n</code></pre> <pre><code>gcc test.o -o test\n</code></pre>"},{"location":"blog/cplusplus/gcc/#attribute-syntax","title":"\u5c5e\u6027\u8bed\u6cd5\uff08Attribute Syntax\uff09","text":"<p>\u53c2\u8003\uff1a\u5b98\u65b9\u6587\u6863\u3002</p>"},{"location":"blog/cplusplus/gcc/#function-attributes","title":"\u51fd\u6570\u5c5e\u6027\uff08Function Attributes\uff09","text":"<p>\u53c2\u8003\uff1a</p> <ul> <li>stackoverflow</li> <li>gcc\u5b98\u65b9\u6587\u6863\uff1aFunction Attributes</li> </ul> <p>\u5c5e\u6027\u5217\u4e3e\uff1a</p> <ul> <li> <p><code>format (archetype, string-index, first-to-check)</code></p> <p>format \u5c5e\u6027\uff0c\u6307\u5b9a\u51fd\u6570\u91c7\u7528 printf\u3001scanf\u3001strftime \u6216 strfmon \u98ce\u683c\u7684\u53c2\u6570\uff0c \u8fd9\u4e9b\u53c2\u6570\u5e94\u6839\u636e\u683c\u5f0f\u5b57\u7b26\u4e32\uff08format string\uff09\u8fdb\u884c\u7c7b\u578b\u68c0\u67e5\uff08type-checked\uff09\u3002 \u7c7b\u578b\u68c0\u67e5\u53d1\u751f\u5728\u7f16\u8bd1\u671f\u3002</p> <p>\u4e3e\u4f8b\uff1a <pre><code>extern int\nmy_printf (void *my_object, const char *my_format, ...)\n    __attribute__ ((format (printf, 2, 3)));\n</code></pre></p> </li> <li> <p><code>archetype</code>\u51b3\u5b9aformat string\u5e94\u8be5\u5982\u4f55\u89e3\u91ca\u3002   \u53ef\u9009\u4e3a<code>printf</code>\u3001<code>scanf</code>\u3001<code>strftime</code>\u6216<code>strfmon</code>\uff08\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>__printf__</code>\u3001<code>__scanf__</code>\u3001<code>__strftime__</code>\u6216<code>__strfmon__</code>\uff09\u3002</p> </li> <li><code>string-index</code>\u6307\u5b9a\u54ea\u4e2a\u53c2\u6570\u662fformat string\uff08\u4ece1\u5f00\u59cb\uff09\u3002</li> <li><code>first-to-check</code>\u6307\u5b9aformat string\u5bf9\u5e94\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u7684\u5e8f\u53f7\u3002   \u5bf9\u4e8e\u90a3\u4e9b\u65e0\u6cd5\u68c0\u67e5\u53c2\u6570\u7684\u51fd\u6570\uff08\u6bd4\u5982<code>vprintf</code>\uff09\uff0c\u8be5\u53c2\u6570\u6307\u5b9a\u4e3a<code>0</code>\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7f16\u8bd1\u5668\u4ec5\u68c0\u67e5format string\u7684\u4e00\u81f4\u6027\u3002\u5bf9\u4e8e<code>strftime</code>\u683c\u5f0f\uff0c\u8be5\u53c2\u6570\u5fc5\u987b\u4e3a<code>0</code>\u3002</li> </ul>"},{"location":"blog/cplusplus/gdb/","title":"gdb\u8c03\u8bd5","text":"<p>\u672c\u6587\u6863\u8bb0\u5f55gdb\u76f8\u5173\u5b9e\u8df5\u7ecf\u9a8c\u3002</p>"},{"location":"blog/cplusplus/gdb/#gdb_1","title":"gdb\u5b9e\u73b0\u539f\u7406","text":"<p>\u53c2\u8003\u94fe\u63a5\u3002</p>"},{"location":"blog/cplusplus/gdb/#gdb_2","title":"gdb\u547d\u4ee4","text":"<ul> <li> <p><code>thread apply [threadno] [all] args</code> - \u5c06\u547d\u4ee4\u4f20\u9012\u7ed9\u4e00\u4e2a\u6216\u591a\u4e2a\u7ebf\u7a0b\uff0c\u53c2\u89c1\u94fe\u63a5\u3002 \u6bd4\u5982\uff0c<code>thread apply all continue</code>\u8868\u793a\u5c06<code>continue</code>\u547d\u4ee4\u4f20\u9012\u7ed9\u6240\u6709\u7ebf\u7a0b\uff0c\u4e5f\u5c31\u662f\u8ba9\u6240\u6709\u7ebf\u7a0b\u90fd\u7ee7\u7eed\u8fd0\u884c\u3002</p> </li> <li> <p><code>rbreak</code> - Set a breakpoint for all functions matching REGEXP. \u53c2\u8003\u94fe\u63a5\u3002</p> <p>e.g. <code>rbreak file.C:.*</code> - \u7ed9file.C\u7684\u6240\u6709\u51fd\u6570\u52a0\u4e0a\u65ad\u70b9\u3002</p> </li> <li> <p><code>info</code></p> </li> <li><code>info inferior</code> - \u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u8c03\u8bd5\u7684\u8fdb\u7a0b\u7684PID\u3002\u53e6\u5916\u4e00\u79cd\u65b9\u6cd5\u662f\u5728gdb\u547d\u4ee4\u884c\u4e2d\u76f4\u63a5\u8c03\u7528C\u51fd\u6570\uff1a<code>print (int)getpid()</code>\u3002\u53c2\u8003\uff1a\u94fe\u63a5\u3002</li> <li><code>info source</code> - \u5f53\u524d\u8c03\u8bd5\u7684\u6e90\u6587\u4ef6\u8def\u5f84\u3002</li> <li><code>info proc</code> - \u5f53\u524d\u8fdb\u7a0b\u4fe1\u606f\u3002<ul> <li><code>info proc files</code> - \u5f53\u524d\u8fdb\u7a0b\u6253\u5f00\u7684\u6587\u4ef6\uff08\u548c\u6587\u4ef6\u63cf\u8ff0\u7b26\uff09\u3002</li> </ul> </li> <li><code>attach</code> - \u8fde\u63a5\u5230\u6b63\u5728\u8fd0\u884c\u7684\u8fdb\u7a0b\u3002\u4e0e<code>gdb -p</code>\u6548\u679c\u76f8\u540c\u3002</li> <li><code>detach</code> - \u53d6\u6d88\u8fde\u63a5\u7684\u8fdb\u7a0b\u3002</li> <li><code>handle &lt;signal&gt; print pass nostop</code> - \u6355\u83b7\u4fe1\u53f7\uff08\u6bd4\u5982<code>SIGSEGV</code>\uff09\u5e76\u4e14\u5ffd\u7565\u5b83\u3002<code>handle &lt;signal nostop</code>\u3002</li> <li><code>set</code> - \u4fee\u6539\u53d8\u91cf\u7684\u503c\uff0c\u6bd4\u5982<code>set x=10</code>\uff08\u6216<code>set var x=10</code>\uff09\u5c06\u53d8\u91cf<code>x</code>\u7684\u503c\u6539\u4e3a<code>10</code>\u3002\u53c2\u8003\u535a\u5ba2\u3002</li> <li><code>show directories</code></li> <li><code>print</code> - gdb\u9ed8\u8ba4\u8bbe\u7f6e\u6253\u5370\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u4e3a200\uff1b\u66f4\u6539\u6253\u5370\u6700\u5927\u957f\u5ea6\uff1a<code>set print elements &lt;number-of-elements&gt;</code>\uff0c<code>0</code>\u8868\u793aunlimited.</li> <li><code>ptype &lt;variable name&gt;</code> - \u6253\u5370\u53d8\u91cf\u7c7b\u578b\u3002</li> </ul>"},{"location":"blog/cplusplus/gdb/#_1","title":"\u65ad\u70b9","text":"<p>\u6dfb\u52a0\u65ad\u70b9\uff1a</p> <pre><code>break file:line_no\n</code></pre> <p>\u67e5\u770b\u65ad\u70b9\uff1a</p> <pre><code>info break\n</code></pre> <p>\u5220\u9664\u7b2c2\u4e2a\u65ad\u70b9\uff1a</p> <pre><code>delete 2\n</code></pre>"},{"location":"blog/cplusplus/gdb/#_2","title":"\u6761\u4ef6\u65ad\u70b9","text":"<p>\u53c2\u8003\uff1a\u535a\u5ba2\u3002</p> <p><code>break ... if cond</code></p>"},{"location":"blog/cplusplus/gdb/#_3","title":"\u89c2\u5bdf\u65ad\u70b9","text":""},{"location":"blog/cplusplus/gdb/#_4","title":"\u6355\u6349\u65ad\u70b9","text":"<p>try...catch</p>"},{"location":"blog/cplusplus/gdb/#_5","title":"\u6253\u5370\u957f\u5ea6\u7684\u9650\u5236","text":"<ul> <li>Value sizes - \u53c2\u8003\uff1a\u6587\u6863</li> </ul> <pre><code>set max-value-size bytes\nset max-value-size unlimited\n</code></pre> <ul> <li>\u6253\u5370\u5b57\u7b26\u957f\u5ea6\u9650\u5236</li> </ul> <p>gdb\u9ed8\u8ba4\u8bbe\u7f6e\u6253\u5370\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u4e3a200\uff1b\u66f4\u6539\u6253\u5370\u6700\u5927\u957f\u5ea6\uff1a<code>set print elements</code></p>"},{"location":"blog/cplusplus/gdb/#coredump","title":"coredump","text":"<p>gdb\u547d\u4ee4\uff1a<code>gcore</code>\u3002</p> <p>\u53c2\u8003\uff1ahttps://man7.org/linux/man-pages/man5/core.5.html</p>"},{"location":"blog/cplusplus/gdb/#wslwindowsgdb","title":"WSL\uff08windows\u865a\u62df\u673a\uff09\u65e0\u6cd5\u4f7f\u7528gdb","text":"<p>\u89e3\u51b3\u65b9\u6cd5\uff1a</p> <p>\u5b89\u88c5PPA\u7684daily build\u7248\u672c</p> <p>sudo add-apt-repository ppa:ubuntu-support-team/gdb   sudo apt update   sudo apt install gdb</p>"},{"location":"blog/cplusplus/gnu/","title":"Gnu","text":"<ul> <li>GNU</li> <li>GNU Software</li> <li>Gnulib</li> <li>Gnumake</li> </ul>"},{"location":"blog/cplusplus/libc/","title":"libc","text":""},{"location":"blog/cplusplus/libc/#memory-protection","title":"Memory Protection","text":"<p>\u53c2\u89c1\uff1a\u6587\u6863\u3002</p>"},{"location":"blog/cplusplus/libc/#_1","title":"\u53c2\u8003","text":""},{"location":"blog/cplusplus/linker/","title":"\u73af\u5883\u53d8\u91cf","text":"<p>\u53c2\u8003\uff1a<code>man ld.so</code></p> <pre><code>PATH\nLD_LIBRARY_PATH\nLD_PRELOAD\n</code></pre>"},{"location":"blog/cplusplus/linker/#_2","title":"\u51fd\u6570","text":""},{"location":"blog/cplusplus/linker/#_3","title":"\u547d\u4ee4","text":"<p>\u53c2\u8003\uff1a<code>man ld.so</code>, <code>man vdso</code>, <code>man elf</code>, scanelf</p> <pre><code>ld(1), ldd(1), pldd(1), sprof(1), dlopen(3),getauxval(3), elf(5), capabilities(7),\nrtld-audit(7), ldconfig(8), sln(8), vdso(7), as(1), elfedit(1), gdb(1), nm(1),\nobjcopy(1), objdump(1), patchelf(1), readelf(1), size(1), strings(1), strip(1),\nexecve(2), dl_iterate_phdr(3), core(5), ld.so(8)\n</code></pre> <p>ldconfig</p> <pre><code>\u914d\u7f6e\u52a8\u6001\u8fde\u63a5\u5668\uff08dynamic linker\uff09\u7684\u8fd0\u884c\u65f6\u7ed1\u5b9a\uff08dynamic bindings\uff09\u3002\n\u5982\u679c\u4f60\u521a\u521a\u5b89\u88c5\u597d\u5171\u4eab\u5e93\uff0c\u53ef\u80fd\u9700\u8981\u8fd0\u884cldconfig\uff1a\n    sudo ldconfig\n\u901a\u5e38\u9700\u8981\u8d85\u7ea7\u7528\u6237\u6765\u8fd0\u884cldconfig\uff0c\u56e0\u4e3a\u53ef\u80fd\u5bf9\u9700\u8981\u67d0\u4e9broot\u7528\u6237\u6240\u6709\u7684\u76ee\u5f55\u548c\u6587\u4ef6\u6709\u5199\u5165\u6743\u9650\u3002\nlddconfig \u4e3a\u4ece\u4ee5\u4e0b\u76ee\u5f55\u627e\u5230\u7684\u5171\u4eab\u5e93\u521b\u5efa\u5fc5\u8981\u7684 links \u548c cache \uff1a\n    command line\u6307\u5b9a\u7684\u76ee\u5f55\uff1b\n    /etc/ld.so.conf\u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u76ee\u5f55\uff1b\n    \u53d7\u4fe1\u4efb\u7684\u76ee\u5f55: /lib, /lib64, /usr/lib, /usr/lib64 \u3002\n\u8be5 cache \u88ab\u8fd0\u884c\u65f6\u8fde\u63a5\u5668\uff08run-time linker\uff09 ld.so \u6216 ld-linux.so \u4f7f\u7528\u3002\n\nldconfig \u5c1d\u8bd5\u57fa\u4e8e\u8be5\u5e93\u8fde\u63a5\u7684 C \u5e93\u6765\u63a8\u65ad ELF \u5e93\uff08\u6bd4\u5982 libc5 \u6216 libc6/glibc\uff09\u7684\u7c7b\u578b\u3002\n\n\u4e00\u4e9b\u73b0\u6709\u7684\u5e93\u6ca1\u6709\u5305\u542b\u8db3\u591f\u7684\u4fe1\u606f\u6765\u63a8\u65ad\u5176\u7c7b\u578b\u3002\n\u56e0\u6b64\uff0c /etc/ld.so.conf \u6587\u4ef6\u683c\u5f0f\u5141\u8bb8\u6307\u5b9a\u671f\u671b\u7684\u7c7b\u578b\u3002\n\u8fd9\u53ea\u5728\u8fd9\u4e9b ELF \u5e93\u4e0d\u80fd\u88ab\u89e3\u51b3\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002\n\nldconfig \u671f\u671b\u7684\u7b26\u53f7\u94fe\u63a5\u6709\u67d0\u79cd\u7279\u5b9a\u7684\u5f62\u5f0f\uff0c\u6bd4\u5982\uff1a\n\n    libfoo.so -&gt; libfoo.so.1 -&gt; libfoo.so.1.12\n\n\u5176\u4e2d\uff0c\u4e2d\u95f4\u7684\u6587\u4ef6 libfoo.so.1 \u662f\u5e93\u7684 SONAME \u3002\n\n\u5982\u679c\u4e0d\u9075\u5faa\u8fd9\u79cd\u683c\u5f0f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5347\u7ea7\u540e\u7684\u517c\u5bb9\u6027\u95ee\u9898\u3002\n</code></pre> <p>ldd</p> <pre><code>\u63cf\u8ff0\uff1a\n    ldd\u8c03\u7528\u6807\u51c6\u52a8\u6001\u8fde\u63a5\u5668\uff08\u89c1 ld.so(8)\uff09\uff0c\u5e76\u4e14\u5c06\u73af\u5883\u53d8\u91cf LD_TRACE_LODADED_OBJECTS \u4e3a 1 \u3002\n    \u8fd9\u4f1a\u8ba9\u52a8\u6001\u8fde\u63a5\u5668\u68c0\u67e5\u7a0b\u5e8f\u7684\u52a8\u6001\u4f9d\u8d56\uff0c\u5e76\u4e14\u5bfb\u627e\uff08\u6839\u636e ld.so(8) \u63cf\u8ff0\u7684\u89c4\u5219\uff09\n    \u548c\u52a0\u8f7d\u6ee1\u8db3\u8fd9\u4e9b\u4f9d\u8d56\u7684\u76ee\u6807\u3002\u5bf9\u4e8e\u6bcf\u4e00\u6761\u4f9d\u8d56\uff0c\n    ldd \u663e\u793a\u5339\u914d\u7684\u76ee\u6807\u7684\u4f4d\u7f6e\u548c\u5176\u8f7d\u5165\u5904\u768416\u8fdb\u5236\u5730\u5740\u3002\n    \uff08linux-vdso\u548cld-linux\u5171\u4eab\u4f9d\u8d56\u662f\u7279\u6b8a\u7684\uff1b\u89c1vdso(7)\u548cld.so(8)\uff09\n\n\u5b89\u5168\u6027\uff1a\n    \u6ce8\u610f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e9b\u7248\u672c\u7684ldd\u53ef\u80fd\u4f1a\u5c1d\u8bd5\u901a\u8fc7\u76f4\u63a5\u8fd0\u884c\u7a0b\u5e8f\uff08\u53ef\u80fd\u5bfc\u81f4\u7a0b\u5e8f\u4e2d\u7684ELF\u89e3\u91ca\u5668\n    \u6216\u7a0b\u5e8f\u672c\u8eab\u7684\u8fd0\u884c\uff09\u6765\u83b7\u53d6\u4f9d\u8d56\u4fe1\u606f\u3002\n\n    \u56e0\u6b64\uff0c\u6c38\u8fdc\u4e0d\u8981\u5728\u4e0d\u53d7\u4fe1\u4efb\u7684\u53ef\u6267\u884c\u6587\u4ef6\u4e0a\u4f7f\u7528ldd\uff0c\u56e0\u4e3a\u4f1a\u5bfc\u81f4\u968f\u610f\u4ee3\u7801\u7684\u8fd0\u884c\u3002\u66f4\u5b89\u5168\u66ff\u4ee3\u65b9\u6cd5\u4e3a\uff1a\n        $ objdump -p /path/to/program | grep NEEDED\n    \u6ce8\u610f\uff0c\u8fd9\u79cd\u66ff\u4ee3\u65b9\u6cd5\u53ea\u4f1a\u663e\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u7684\u76f4\u63a5\u4f9d\u8d56\uff0c\u800cldd\u663e\u793a\u8be5\u53ef\u6267\u884c\u6587\u4ef6\u7684\u6574\u4e2a\u4f9d\u8d56\u6811\u3002\n</code></pre> <p>ldd output\u8bf4\u660e</p> <p>sprof</p> <p>\u53c2\u8003\uff1astackoverflows</p> <p>objdump</p> <pre><code>[-p|--private-headers]\n[-x|--all-headers]\n</code></pre> <p>readelf</p> <pre><code>[-d|--dynamic]\n</code></pre>"},{"location":"blog/cplusplus/linker/#_4","title":"\u6587\u4ef6","text":"<pre><code>/lib/ld.so\n    Run-time linker/loader.\n/etc/ld.so.conf\n    File containing a list of directories, one per line, in which to search for libraries.\n/etc/ld.so.cache\n    File containing an ordered list of libraries found in the directories specified in /etc/ld.so.conf, as well as those found in the trusted directories.\n\nThe trusted directories:\n    /lib\n    /lib64\n    /usr/lib\n    /usr/lib64\n</code></pre> <p>ld.so</p> <pre><code>\u540d\u5b57\n    ld.so, ld-linux.so - \u52a8\u6001\u8fde\u63a5/\u52a0\u8f7d\u5668\u3002\n\n\u7b80\u4ecb\n    \u52a8\u6001\u8fde\u63a5\u5668\u53ef\u4ee5\u88ab\u95f4\u63a5\u8fd0\u884c\u6216\u76f4\u63a5\u8fd0\u884c\u3002\n    \u95f4\u63a5\u8fd0\u884c\uff1a\n        \u8fd0\u884c\u67d0\u4e9b\u52a8\u6001\u8fde\u63a5\u7a0b\u5e8f\u6216\u5171\u4eab\u5e93\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0d\u80fd\u5411\u52a8\u6001\u8fde\u63a5\u5668\u4f20\u9012\u547d\u4ee4\u884c\u9009\u9879\uff1b\u5e76\u4e14\u5728ELF\u60c5\u51b5\u4e0b\uff0c\u5b58\u50a8\u5728\u7a0b\u5e8f\u7684.interp section\u4e2d\u7684\u52a8\u6001\u8fde\u63a5\u5668\u88ab\u6267\u884c\u3002\n    \u76f4\u63a5\u8fd0\u884c\uff1a\n        /lib/ld-linux.so.* [OPTIONS] [PRAGRAM [ARGUMENTS]]\n\n\u63cf\u8ff0\n    ld.so \u548c ld-linux.so* \u5bfb\u627e\u548c\u52a0\u8f7d\u7a0b\u5e8f\u6240\u9700\u7684\u5171\u4eab\u5bf9\u8c61\uff08\u5171\u4eab\u5e93\uff09\uff0c\u51c6\u5907\u7a0b\u5e8f\u7684\u8fd0\u884c\uff0c\u7136\u540e\u8fd0\u884c\u5b83\u3002\n\n    \u5982\u679c\u5728\u7f16\u8bd1\u671f\u6ca1\u6709\u5411 ld(1) \u6307\u5b9a -static \u9009\u9879\uff0c\u5219Linux\u4e8c\u8fdb\u5236\u6587\u4ef6\u9700\u8981\u52a8\u6001\u8fde\u63a5\uff08\u5728\u8fd0\u884c\u65f6\u8fde\u63a5\uff09\u3002\n</code></pre>"},{"location":"blog/cplusplus/linker/#_5","title":"\u540d\u5b57","text":"<p>\u53c2\u8003\uff1a<code>man ldconfig</code></p> <p>SONAME</p> <p>\u53c2\u8003\uff1aSONAME Wiki</p> <pre><code>GNU linker\u4f7f\u7528 -hname \u6216 -soname=name \u6765\u6307\u5b9a\u8be5\u5e93\u7684library name field\u3002\n\u5728\u5185\u90e8\uff0clinker\u4f1a\u521b\u5efa\u4e00\u4e2a DT_SONAME field\u5e76\u4e14\u7528 name \u6765\u586b\u5145\u5b83\u3002\n\n\u67e5\u8be2SONAME\n    $ objdump -p libx.so.1.3 | grep SONAME\n        SONAME     libx.so.1\n    \u6216\n    $ readelf -d libtsan.so | grep SONAME\n     0x000000000000000e (SONAME)             Library soname: [libtsan.so.0]\n</code></pre>"},{"location":"blog/cplusplus/linker/#elf","title":"ELF","text":"<pre><code>ELF - Executable and Linking Format.\nELF\u63cf\u8ff0\u4e86normal executable files\u3001relocatable object files\u3001core files\u548cshared objects\u7684\u683c\u5f0f\u3002\n</code></pre> <p>\u53c2\u8003\uff1a<code>man elf</code>, \u535a\u5ba2:elf\u4ecb\u7ecd\u3002</p>"},{"location":"blog/cplusplus/linker/#_6","title":"\u94fe\u63a5\u540d","text":"<p>\u53c2\u8003\uff1a\u7a0b\u5e8f\u5458\u7684\u81ea\u6211\u4fee\u517b, <code>man ld</code></p> <p>GCC\u7684\u63d0\u4f9b\u4e86\u4e0d\u540c\u7684\u65b9\u6cd5\u6307\u5b9a\u94fe\u63a5\u7684\u5171\u4eab\u5e93\uff1a</p> <ul> <li> <p><code>l&lt;link_name&gt;</code>\u53c2\u6570</p> <p>\u6307\u5b9a\u9700\u8981\u94fe\u63a5\u7684\u5171\u4eab\u5e93lib.so <li> <p><code>l:&lt;filename&gt;</code>\u53c2\u6570</p> <p>\u901a\u8fc7\u6587\u4ef6\u540d\u6307\u5b9a\u5171\u4eab\u5e93\uff0c\u53c2\u8003LD\u624b\u518c</p> </li> <li> <p>\u5168\u8def\u5f84\u6307\u5b9a</p> </li> <li> <p><code>Wl,-static</code>\u53c2\u6570</p> <p>\u6307\u5b9a\u67e5\u627e\u9759\u6001\u5e93\uff0c\u901a\u8fc7-Wl,-Bdynamic\u6062\u590d\u6210\u52a8\u6001\u5e93\u67e5\u627e</p> </li>"},{"location":"blog/cplusplus/linker/#_7","title":"\u94fe\u63a5\u5668\u9009\u9879","text":"<p>\u53c2\u8003\uff1a<code>man ld</code></p> <pre><code>ld - The GNU linker\n</code></pre> <p>\u9009\u9879\uff1a</p> <pre><code>-rpath=dir\n    \u6dfb\u52a0\u4e00\u4e2a\u76ee\u5f55\u5230\u8fd0\u884c\u65f6\u5e93\u641c\u5bfb\u8def\u5f84\u4e2d\u3002\n</code></pre> <p>gcc\u901a\u8fc7 <code>-Wl</code> \u524d\u7f00\u6307\u5b9a\u94fe\u63a5\u5668\u9009\u9879\uff0c\u4f8b\u5982\uff1a</p> <pre><code> gcc -Wl,--start-group foo.o bar.o -Wl,--end-group\n gcc -Wl,-rpath,'$ORIGIN/../lib'\n</code></pre>"},{"location":"blog/cplusplus/makefile/","title":"Makefile","text":""},{"location":"blog/cplusplus/makefile/#makefile","title":"makefile\u540c\u540d\u76ee\u6807\u5904\u7406\u65b9\u5f0f","text":"<p>\u53c2\u8003\uff1a</p> <ul> <li>\u94fe\u63a5</li> <li>\u94fe\u63a5</li> </ul> <p>makefile\u5c06\u547d\u4ee4\u7ed3\u679c\u8d4b\u503c\u7ed9\u53d8\u91cf</p>"},{"location":"blog/cplusplus/makefile/#makefile_1","title":"Makefile\u4e2d\u77ed\u5212\u7ebf","text":"<pre><code>all:\n    -/bin/rm -rf *.log\n</code></pre> <p>\u5176\u4e2d\uff0c\"<code>-/bin/rm</code>\"\u7684\u77ed\u5212\u7ebf\"<code>-</code>\"\u662f\u4e00\u4e2a\u7279\u6b8a\u524d\u7f00\uff0c\u8868\u793a\u5ffd\u7565\u547d\u4ee4\u6267\u884c\u8fc7\u7a0b\u7684\u9519\u8bef\u3002</p>"},{"location":"blog/cplusplus/makefile/#_1","title":"\u4e3a\u6bcf\u4e2a\u6e90\u6587\u4ef6\u751f\u6210\u4e00\u4e2a\u53ef\u6267\u884c\u7a0b\u5e8f","text":"<pre><code>SRCS = $(wildcard *.c)\n\nall: $(SRCS:.c=)\n\n# Unnecessary, as the default rules are adequate.\n.c:\n    gcc $(CPFLAGS) $&lt; -o $@\n</code></pre> <p>\u6700\u540e\u4e24\u884c\u5176\u5b9e\u4e0d\u9700\u8981\uff0c\u9ed8\u8ba4\u89c4\u5219\u5df2\u7ecf\u8db3\u591f\u4e86\u3002</p> <p>\u5176\u4e2d\uff0c<code>$(SRCS:.c=.o)</code>\u8868\u793a\u5c06\u53d8\u91cf<code>SRCS</code>\u4e2d\u7684\u6bcf\u4e2a\u5355\u8bcd\uff08\u4ee5\u7a7a\u683c\u5206\u5272\uff09\u4e2d\u7684<code>.c</code>\u66ff\u6362\u4e3a<code>.o</code>\u3002\u4ee5\u4e0a\u4ee3\u7801\u5219\u662f\u5c06\u6240\u6709<code>.c</code>\u90fd\u53bb\u6389\u3002</p>"},{"location":"blog/cplusplus/marcos/","title":"\u9884\u5b9a\u4e49\u5b8f","text":""},{"location":"blog/cplusplus/marcos/#c","title":"C\u6807\u51c6\u9884\u5b9a\u4e49\u5b8f","text":"<ul> <li><code>__LINE__</code></li> <li><code>__func__</code></li> <li><code>__FILE__</code></li> <li><code>NDEBUG</code>\uff1a\u53c2\u8003_DEBUG\u548cNDEBUG\u7684\u533a\u522b\uff0c\u5176\u4e2d\uff0c<code>_DEBUG</code>\u662fVisual Studio\u5b9a\u4e49\u7684\uff0c<code>NDEBUG</code>\u662fC/C++\u6807\u51c6\u3002</li> </ul>"},{"location":"blog/cplusplus/marcos/#gnu-c","title":"GNU C\u9884\u5b9a\u4e49\u5b8f","text":"<p>\u5b98\u65b9\u6587\u6863</p> <ul> <li><code>__COUNTER__</code>: \u6269\u5c55\u4e3a\u4ece<code>0</code>\u5f00\u59cb\u7684\u8fde\u7eed\u6574\u6570\u503c\uff0c\u6bcf\u6b21\u5728\u6e90\u7801\u4e2d\u51fa\u73b0\uff0c\u5219\u52a0<code>1</code>\u3002\u4e0d\u540c\u6e90\u6587\u4ef6\u7684<code>__COUNTER__</code>\u4e92\u4e0d\u5f71\u54cd\u3002</li> </ul> <p>\u53ef\u4ee5\u7528\u6765\u751f\u6210\u552f\u4e00\u7684\u547d\u540d\u3002   \u53c2\u8003\u94fe\u63a5\u3002</p> <pre><code>#define CONCAT_IMPL(x,y) x##y\n#define CONCAT(x,y) CONCAT_IMPL(x,y)\n#define VAR(name) CONCAT(name,__COUNTER__)\nint main() {\n    int VAR(myvar); // \u5c55\u5f00\u4e3a int myvar0;\n    int VAR(myvar); // \u5c55\u5f00\u4e3a int myvar1;\n    int VAR(myvar); // \u5c55\u5f00\u4e3a int myvar2;\n}\n</code></pre> <ul> <li><code>program_invocation_name</code>\uff1a\u53c2\u8003man page</li> <li></li> </ul>"},{"location":"blog/cplusplus/misc/","title":"\u6742\u9879","text":"<p>\u8bb0\u5f55\u4ee3\u7801\u5c0f\u6280\u5de7\u3002</p>"},{"location":"blog/cplusplus/misc/#_2","title":"\u73af\u5883\u53d8\u91cf","text":"<ul> <li> <p><code>environ</code> - \u7528\u6237\u73af\u5883\uff0c\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf\u3002\u5934\u6587\u4ef6 <code>&lt;unistd.h&gt;</code>\u3002\u53ef\u4ee5\u901a\u8fc7 <code>man environ</code> \u67e5\u770b\u624b\u518c\u3002</p> <pre><code>#include &lt;unistd.h&gt;\n#include &lt;iostream&gt;\nusing namespace std;\n\nint main() {\n    cout &lt;&lt; \"program environment: \" &lt;&lt; endl;\n    for (char** entry = environ; *entry; ++entry) {\n        cout &lt;&lt; *entry &lt;&lt; endl;\n    }\n}\n</code></pre> </li> <li> <p><code>getenv</code> - \u83b7\u53d6\u73af\u5883\u53d8\u91cf\u3002\u5934\u6587\u4ef6 <code>&lt;stdlib.h&gt;</code>\u3002</p> </li> <li><code>setenv</code> - \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u3002\u5934\u6587\u4ef6 <code>stdlib.h</code>\u3002</li> </ul>"},{"location":"blog/cplusplus/misc/#printf","title":"printf\u6253\u5370","text":"<ul> <li> <p>\u975e\u6253\u5370\u5b57\u7b26 - \u53c2\u89c1 Escape sequeneces.</p> <pre><code>char str[] = \"\\x1E\"; // \"0x1E\" \u662f\u4e00\u4e2a\u975e\u6253\u5370\u5b57\u7b26\n</code></pre> </li> </ul>"},{"location":"blog/cplusplus/permance_analysis/","title":"Permance Analysis","text":""},{"location":"blog/cplusplus/permance_analysis/#_1","title":"\u6027\u80fd\u5206\u6790","text":""},{"location":"blog/cplusplus/permance_analysis/#cpu","title":"CPU\u65f6\u95f4","text":"<p>Function's CPU time:</p> <pre><code>* Inclusive time: total cpu time, include all functions it calls.\n* Exclusive time: only the time used by the function itself, exclusive all its children.\n\nRefer to [here](https://stackoverflow.com/questions/15760447/what-is-the-meaning-of-incl-cpu-time-excl-cpu-time-incl-real-cpu-time-excl-re/74426370).\n</code></pre> <ol> <li>Wall time: total time the process used, containing IO time.</li> <li>CPU usage (CPU\u5229\u7528\u7387) = CPU time / Wall time.</li> <li>real/user/system time</li> <li>Real is wall clock time - time from start to finish of the call. This is all elapsed time including time slices used by other processes and time the process spends blocked (for example if it is waiting for I/O to complete).</li> <li>User is the amount of CPU time spent in user-mode code (outside the kernel) within the process. This is only actual CPU time used in executing the process. Other processes and time the process spends blocked do not count towards this figure.</li> <li> <p>Sys is the amount of CPU time spent in the kernel within the process. This means executing CPU time spent in system calls within the kernel, as opposed to library code, which is still running in user-space. Like 'user', this is only CPU time used by the process. See below for a brief description of kernel mode (also known as 'supervisor' mode) and the system call mechanism.</p> <p>Refer to here.</p> </li> <li> <p>CPU \u65f6\u95f4\u53ef\u80fd\u5927\u4e8e\u5899\u4e0a\u65f6\u95f4\uff1a</p> </li> </ol> <p>\u8fd9\u662f\u56e0\u4e3a CPU \u65f6\u95f4\u662f\u6240\u6709 CPU \u6838\u7684\u8fd0\u884c\u65f6\u95f4\u7684\u7d2f\u52a0\u548c\uff0c\u5899\u4e0a\u65f6\u95f4\u5219\u662f\u5b9e\u9645\u7684\u65f6\u95f4\u3002\u6b64\u65f6 CPU \u5229\u7528\u7387\u5927\u4e8e 100%. \uff08\u8fd9\u662f\u81ea\u5df1\u7684\u7406\u89e3\uff09</p>"},{"location":"blog/cplusplus/permance_analysis/#_2","title":"\u8ba1\u65f6\u5de5\u5177","text":"<pre><code>$ /usr/bin/time -p ls\n</code></pre> <p>Or,</p> <pre><code>$ time ls\n</code></pre> <p>\u5176\u4e2d\uff08\u53c2\u8003\u94fe\u63a5\uff09\uff0c</p> <pre><code>$ type -a time\ntime is a shell keyword\ntime is /usr/bin/time\n</code></pre>"},{"location":"blog/cplusplus/permance_analysis/#_3","title":"\u91ca\u7591","text":"<ol> <li>Is CPU time in flame graph sum of all the CPU time? Or is it the wall time when CPU works?</li> </ol>"},{"location":"blog/cplusplus/permance_analysis/#_4","title":"\u6027\u80fd\u5206\u6790\u5de5\u5177","text":"<p>Oracle Developer Studio\uff1a</p> <p>Performance Analyzer\uff1a\u624b\u518c</p> <p>Thread Analyzer</p> <p>gprof: \u4f7f\u7528\u65b9\u6cd5</p>"},{"location":"blog/cplusplus/permance_analysis/#_5","title":"\u5185\u5b58\u5206\u6790","text":""},{"location":"blog/cplusplus/permance_analysis/#_6","title":"\u5185\u5b58\u5206\u6790\u5de5\u5177","text":"<p>AddressSanitizer</p>"},{"location":"blog/cplusplus/string/","title":"Functions","text":"<ul> <li>sprintf</li> <li>bcopy</li> </ul>"},{"location":"blog/cplusplus/system_call/","title":"\u7cfb\u7edf\u8c03\u7528","text":""},{"location":"blog/cplusplus/system_call/#sched_setaffinity","title":"<code>sched_setaffinity</code>","text":"<p>\u53c2\u8003manpage.</p>"},{"location":"blog/cplusplus/tools/","title":"Tools","text":""},{"location":"blog/cplusplus/tools/#_1","title":"\u8c03\u8bd5\u5de5\u5177","text":"<p>DDT</p>"},{"location":"blog/git/QA/","title":"Qa","text":""},{"location":"blog/git/QA/#gitignore","title":"gitignore\u4e0d\u751f\u6548","text":"<p>\u53c2\u8003\uff1a\u94fe\u63a5\u3002</p>"},{"location":"blog/git/QA/#file-mode-10064","title":"file mode 10064\u7684\u542b\u4e49","text":"<p>\u53c2\u8003\u535a\u5ba2</p>"},{"location":"blog/movie/gu-zhu-yi-zhi/","title":"Gu Zhu Yi Zhi","text":"<p>\u5f71\u7247\u540d\uff1a\u5b64\u6ce8\u4e00\u63b7\u3002</p> <p>\u9646\u79c9\u5764\uff1a\u8bc6\u4eba\u5584\u7528\u3002</p> <ol> <li>\u5728\u88ab\u963f\u624d\u80cc\u523a\u4e4b\u540e\uff0c\u653e\u4e86\u963f\u624d\uff0c\u8bf4\u201c\u6211\u4e0d\u602a\u4f60\uff0c\u4f60\u5e2e\u6211\u4e00\u6b21\uff0c\u5e2e\u6211\u628a\u4e3b\u673a\u4fe1\u606f\u9500\u6bc1\u3002\u201d \u963f\u624d\u611f\u6069\u6234\u5fb7\uff0c\u5728\u8b66\u5bdf\u91cd\u67aa\u73af\u4f3a\u60c5\u51b5\u4e0b\uff0c\u5e2e\u52a9\u5176\u5f00\u67aa\u9500\u6bc1\u624b\u673a\uff08\u8bc1\u636e\uff09\u3002</li> <li>\u8ba9\u4e3b\u89d2\u5e2e\u5fd9\u5c06\u5c0f\u5973\u5b69\u9001\u5230\u5176\u6bcd\u4eb2\u90a3\u91cc\u3002\u56e0\u4e3a\u4e3b\u89d2\u54c1\u5fb7\u9ad8\u5c1a\u3001\u505a\u4eba\u4ec1\u4e49\uff0c\u5728\u63d0\u51fa\u5199\u81ea\u52a8\u7a0b\u5e8f\u65f6\uff0c\u8981\u6c42\u653e\u4e86\u6240\u6709\u4eba\u3002\u5c0f\u5973\u5b69\u65e0\u8f9c\uff0c\u4e3b\u89d2\u4e00\u5b9a\u505a\u5f97\u5230\u3002\u4ed6\u8bf4\u81ea\u5df1\u4e0d\u4fe1\u8b66\u5bdf\uff0c\u8fd9\u4e00\u70b9\u4e5f\u5f88\u5408\u7406\uff0c\u56e0\u4e3a\u8b66\u5bdf\u53ef\u80fd\u6709\u4eba\u8150\u8d25\uff0c\u5c06\u5973\u513f\u4ea4\u7ed9\u9ed1\u5e2e\uff0c\u800c\u9ed1\u5e2e\u5185\u90e8\u9ad8\u5c42\u4e3a\u4e86\u9632\u6b62\u738b\u5410\u51fa\u81ea\u5df1\uff0c\u53ef\u80fd\u4ee5\u5176\u5973\u513f\u4e3a\u8981\u631f\uff0c\u8ba9\u81ea\u5df1\u9876\u9ed1\u9505\uff1b\u4e5f\u6709\u53ef\u80fd\u8b66\u5bdf\u529e\u4e86\u6848\u5c31\u6536\u573a\uff0c\u628a\u5b69\u5b50\u76f4\u63a5\u9001\u53bb\u5b64\u513f\u9662\u3002</li> </ol>"},{"location":"blog/movie/the-killings-at-badgers-drift/","title":"The Killings at Badger's Drift","text":"<p>\u89c6\u9891\uff1a\u94fe\u63a5\u3002</p> <p>\u5f71\u7247\u540d\uff1aMidsomer Murders, S01:E01, The Killings at Badger's Drift</p> <p>S01:E01 - Season 01 : Episode 01\uff0c\u7b2c1\u5b63\u7b2c1\u96c6\u3002episode\uff0c\u63d2\u66f2\uff08\u67d0\u4e8b\u4ef6\uff1b\u67d0\u4e8b\u53d1\u751f\u7684\u77ed\u6682\u65f6\u95f4\uff09\uff1b\u5267\u96c6\uff08\u4e00\u822c\u4e00\u5468\u66f4\u65b0\u653e\u6620\u4e00\u6b21\uff09\u3002</p> <p>midsomer - midsummer\u7684\u8fc7\u65f6\u5199\u6cd5\u3002\u672c\u7247\u4e2d\u662f\u4e00\u4e2a\u865a\u6784\u7684\u82f1\u683c\u5170\u53bf\uff0c\u5f71\u7247\u5f00\u5934\u6709\u4e00\u4e2a\u8def\u724c\uff0c\u5199\u7740\uff1a\u201cBadger's Drift, Midsomer's best kept village\u201d\uff0c\u610f\u601d\u5927\u6982\u662f\uff0cBadger's Drift\u662fMidsomer\u4fdd\u5b58\u6700\u597d\u7684\u6751\u5e84\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#_1","title":"\u5f00\u5e55\u4ecb\u7ecd","text":"<p>Screenplay by Anthony Horowitz - Screenplay \u5267\u672c\u3002</p> <p>From the novel by Caroline Graham</p> <p>Starring - \u4e3b\u6f14</p> <p>Directed by - \u5bfc\u6f14\u662f</p> <p>caption - \u5b57\u5e55\u3002</p> <p>subtitle - \u5b57\u5e55\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#emily","title":"\u7b2c\u4e00\u5e55 Emily\u4e4b\u6b7b","text":""},{"location":"blog/movie/the-killings-at-badgers-drift/#_2","title":"\u6751\u843d\u5c0f\u8def\u4e0a","text":"<p>-[Doctor] Hello, Missis Simpson. Have a very good afternoon.</p> <p>bright playful music - \u660e\u5feb\u4fcf\u76ae\u7684\u97f3\u4e50\u3002</p> <p>Daily Mirror, forward with the people. \u8fd9\u662f\u4e00\u5757\u62db\u724c\u4e0a\u7684\u5b57\u6837\u3002\u300a\u6bcf\u65e5\u955c\u62a5\u300b\u7684\u53e3\u53f7\u662f\u201c\u4e0e\u4eba\u6c11\u540c\u884c\u201d\uff0cThe Sun's slogan was 'Forward with the People', which had been adopted by the Mirror in 1945 and only recently dropped. - \u53c2\u89c1\u8c37\u6b4c\u5feb\u7167\u300aAn Introduction to the Daily Mirror\u300b\u3002hayday\u597d\u5929\u6c14\uff0c\u5168\u76db\u65f6\u671f\u3002hay\u5e72\u8349\u3002</p> <p>-[Lucy] Ah, sneaking off, aren't you, Emily? \u5077\u5077\u6e9c\u8d70\uff0c\u4e0d\u662f\u5417\uff1f</p> <p>-[Emily] I wouldn't call it sneaking, Lucy. Anyway, who's talking? You've been out all day! \u6211\u4e0d\u4f1a\u79f0\u5b83\u4e3a\u6e9c\u3002\u4e0d\u7ba1\u600e\u6837\uff0c\u662f\u8c01\u5728\u8bf4\u8bdd\uff1f\u4f60\u81ea\u5df1\u5df2\u7ecf\u51fa\u53bb\u4e00\u6574\u5929\u4e86\uff01</p> <p>-I'm not gonna tell you where. \u6211\u4e0d\u4f1a\u544a\u8bc9\u4f60\u6211\u53bb\u4e86\u54ea\u91cc\u3002</p> <p>-You didn't find it? \u4f60\u6ca1\u6709\u627e\u5230\uff1f</p> <p>-No. \u6ca1\u6709\u3002</p> <p>-You'll be buying me tea this year, my dear. You wait and see! \u4eca\u5e74\u4f60\u4f1a\u7ed9\u6211\u4e70\u8336\uff0c\u4f60\u7b49\u7740\u770b\uff01</p> <p>-Chance would be a fine thing! \u6709\u673a\u4f1a\uff08\u8ba9\u6211\u7ed9\u4f60\u4e70\u8336\uff09\u5c31\u597d\u4e86\uff01</p> <p>pros and cons - \u4f18\u70b9\u548c\u7f3a\u70b9\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#_3","title":"\u6811\u6797","text":"<p>birds chirp - \u9e1f\u513f\u53fd\u53fd\u55b3\u55b3\u3002</p> <p>Spurred coral root - \u523a\u73ca\u745a\u6839\u3002spur\u9a6c\u523a\u3002\"It's an orchid\uff08\u5170\u82b1\uff09, not a flower.\"</p> <p>padlock clicks - \u6302\u9501\u5494\u5494\u58f0\u3002</p> <p>camera clicks - \u76f8\u673a\u5494\u5494\u58f0\u3002</p> <p>man moans - \u7537\u4eba\u547b\u541f\u3002</p> <p>man pants - \u7537\u4eba\u5598\u606f\u3002pant\u5598\u6c14\u3002</p> <p>bird flaps - \u9e1f\u513f\u62cd\u98de\u3002</p> <p>Emily shrieks - Emily\u5c16\u53eb\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#emily_1","title":"Emily\u56de\u5bb6\u8def\u4e0a","text":"<p>brakes screech - \u5239\u8f66\u58f0\u3002brake\u5239\u8f66\uff0cscreech\u53d1\u51fa\u5c16\u53eb\u3001\u566a\u58f0\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#emily_2","title":"Emily\u5bb6","text":"<p>slow sinister music - sinister\u9669\u6076\u7684\u3002</p> <p>bees buzz - \u871c\u8702\u55e1\u55e1\u3002</p> <p>beehive cottage - \u8702\u5de2\u5c0f\u5c4b\u3002beehive /\u02c8bi\u02d0.ha\u026av/ \u8702\u7a9d\uff1bcottage /\u02c8k\u0251\u02d0.t\u032c\u026ad\u0292/ /\u02c8k\u0252t.\u026ad\u0292/\u5c0f\u5c4b\u3002</p> <p>cat meows - meow /\u02ccmi\u02c8a\u028a/ \u55b5</p> <p>Come on, out you go - \u6765\uff0c\u4f60\u51fa\u53bb\u3002</p> <p>door thuds - \u95e8\u7830\u7684\u4e00\u58f0\u3002thud /\u03b8\u028cd/ \u649e\u51fb\u58f0\uff0c\u7830\u3002</p> <p>dial up phone rattles - \u62e8\u53f7\u560e\u560e\u58f0\u3002rattle \u62e8\u6d6a\u9f13\uff1b\u560e\u560e\u58f0\u3002</p> <p>door rattles.</p> <p>bangs. - to (cause something to) make a sudden very loud noise or noises.</p> <p>birds squawk - \u9e1f\u53eb\uff08\u4e0d\u597d\u7684\u58f0\u97f3\uff09\u3002squawk - (of a bird) to make an unpleasantly loud, sharp noise.</p> <p>door knocks - \u6572\u95e8\u58f0\u3002</p> <p>door knob screeches - \u95e8\u628a\u624b\u5c16\u53eb\uff08\u58f0\uff09\u3002</p> <p>intense sinister music - \u6fc0\u70c8\u9669\u6076\u7684\u97f3\u4e50\u3002</p> <p>dark dreamy music - \u9ed1\u6697\u68a6\u5e7b\u7684\u97f3\u4e50\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#_4","title":"\u7b2c\u4e8c\u5e55 \u521d\u6b65\u8c03\u67e5","text":"<p>-This is it, here, Sir.</p> <p>-Really, Troy? I'd never have guessed.</p> <p>crowd chatters - \u4eba\u7fa4\u95f2\u804a\u3002</p> <p>We only ever meet when there's a corpse. - \u6211\u4eec\u53ea\u6709\u5728\u6709\u5c38\u4f53\u7684\u65f6\u5019\u4f1a\u89c1\u9762\u3002corpose - \u5c38\u4f53\u3002ever - at any time: Nothing ever happened in this evening. Have you ever gone to London?</p> <p>broken neck - \u8116\u5b50\u65ad\u4e86\u3002</p> <p>scuff marks on the carpet - \u5730\u6bef\u4e0a\u6709\u78e8\u635f\u75d5\u8ff9\u3002scuff vt. \u78e8\u635f\uff0c\u64e6\u4f24\u3002</p> <p>a blow to the back of the neck and then dragged over here - \u9888\u540e\u906d\u5230\u4e00\u51fb\uff0c\u7136\u540e\u88ab\u62d6\u5230\u8fd9\u91cc\u3002</p> <p>spinster - \u8001\u5904\u5973\u3002</p> <p>The old girl who lives opposite - \u4f4f\u5728\u5bf9\u9762\u7684\u8001\u59d1\u5a18\u3002</p> <p>She slammed the door for a start - \u5979\u731b\u5730\u5173\u4e0a\u95e8\u3002slam \u731b\u649e\u3002</p> <p>She didn't padlock her tricycle - \u5979\u6ca1\u6709\u9501\u4e0a\u4e09\u8f6e\u8f66\u3002padlock \u6302\u9501\u3002tricycle \u4e09\u8f6e\u8f66\u3002</p> <p>There's no reflection on you, Chief Inspector, but to leave her tricycle like that, she must have been very upset. \u603b\u7763\u5bdf\uff0c\u5bf9\u4f60\u6765\u8bf4\u6ca1\u6709\u4ec0\u4e48\u53cd\u5e94\uff08\u6ca1\u6709\u4ec0\u4e48\u597d\u5947\u602a\u7684\uff09\uff0c\u4f46\u662f\u5c31\u8fd9\u6837\u628a\u5979\u7684\u4e09\u8f6e\u8f66\u4e22\u4e0b\uff0c\u5979\u4e00\u5b9a\u5f88\u6cae\u4e27\u3002</p> <p>-I'll have to go over tomorrow. I still haven't told the bees. - go over: to make one's way \u5f00\u8f9f\u65b0\u7684\u8def\u3002 i.g. go over to store for supplies. \u53bb\u5546\u5e97\u8d2d\u4e70\u65e5\u7528\u54c1\u3002</p> <p>-I'm sorry?</p> <p>-Well you have to tell the bees when someone dies. Otherwise they just clear off. - Telling the bees \u517b\u8702\u4eba\u6709\u4e00\u4e2a\u4f20\u7edf\uff0c\u4f1a\u5c06\u91cd\u5927\u4e8b\u4ef6\uff08\u751f\u8001\u75c5\u6b7b\u5a5a\u59fb\u7b49\uff09\u544a\u8bc9\u871c\u8702\uff0c\u5426\u5219\u4e0a\u5929\u4f1a\u4f7f\u517b\u8702\u5bb6\u5ead\u53d7\u5230\u60e9\u7f5a\uff08\u6bd4\u5982\u672c\u7247\u4e2dMiss Bellringer \u8bf4\u871c\u8702\u4f1a\u5168\u90e8\u8d70\u5f00\uff09\u3002</p> <p>clock bell chimes - \u949f\u58f0\u54cd\u8d77\u3002chime /t\u0283a\u026am/ 1.\uff08\u949f\uff09\u54cd\u8d77\uff08\u5c24\u5176\u662f\u544a\u8bc9\u4f60\u5230\u51e0\u70b9\u4e86\uff09\uff1b2. \u4e0e\u67d0\u67d0\u76f8\u540c\u6216\u5177\u6709\u76f8\u540c\u7684\u6548\u679c\uff1ae.g. Her views on life didn't chime with mine. \u5979\u7684\u4eba\u751f\u89c2\u548c\u6211\u4e0d\u592a\u4e00\u81f4\u3002</p> <p>tower bell rings.</p> <p>-Clear off her rocker, if you ask me. - rock: \u5ca9\u77f3\uff1b\u524d\u540e\u6447\u6643\uff0crock music\u6447\u6eda\u4e50\u3002rocker\uff0c\u6447\u6905\uff0c\uff08\u6447\u6905\u7b49\u4e0b\u9762\u7684\uff09\u4e24\u6761\u5f2f\u6728\uff08\u7528\u6765\u6447\u6643\uff09\u4e4b\u4e00\uff1boff one's rocker: \u5904\u4e8e\u6781\u5ea6\u6df7\u4e71\u6216\u7cbe\u795e\u4e0d\u5065\u5168\u7684\u72b6\u6001\u3002in a state marked by extreme confusion or mental unsoundness: \u2026 he felt dizzy, slightly off his rocker at this extraordinary assailment of his senses.</p> <p>-You didn't believed her?</p> <p>-Well, what she got to go on? A slammed door and a trike that wasn't padlocked. It's a waste of time.</p> <p>undertaker - \u6ba1\u4eea\u5458\u3002</p> <p>-I based in Causton but it happens I live here in Badger's Drift and I thought I ought to pop by. Miss Simpson was a client. \u6211\u5728Causton\u4e0a\u73ed\uff0c\u4f46\u662f\u78b0\u5de7\u6211\u4f4f\u8fd9\u91cc\u3002pop by: \u987a\u4fbf\u8fc7\u6765\u4e00\u4e0b\uff1bpop, (spoken) to go somewhere for a short time.</p> <p>-I'm sorry?</p> <p>-She'd pre-paid. Our Satin Service. It's one of our complete funeral packages. Very up-market, although between you and me. I let her have it at a discount (sniffs). She taught my mom, you know. - Satin\uff0c\u7f0e\u9762\uff0c\u7ef8\u7f0e\uff0c\u8fd9\u91cc\u5e94\u8be5\u6307\u670d\u52a1\u7684\u7b49\u7ea7\uff0c\u7c7b\u4f3c\u91d1\u5361\u4f1a\u5458\u3001\u94f6\u5361\u4f1a\u5458\u3002</p> <p>-What can I do for you, Mister Rainbird?</p> <p>-I was wondering if I could take her, the deceased. - decease=death. the deceased\u53bb\u4e16\u7684\u4eba\u3002</p> <p>-Oh, I'm afraid that won't be possible for a little while.</p> <p>-Oh! You do suspect some naughtiness. It was her neck, I undertand. \u4f60\u786e\u5b9e\u6000\u7591\u6709\u4e00\u4e9b\u6363\u86cb\u9b3c\u3002\u81f4\u547d\u4f24\u5728\u9888\u90e8\uff0c\u6211\u77e5\u9053\u7684\u3002- naughty \u987d\u76ae\u7684\uff1bnaughtiness \u540d\u8bcd\uff0c\u987d\u76ae\u3002</p> <p>-[Troy] Who told you that?</p> <p>-Come on, everybody knows that by now. It's that sort of village.</p> <p>-[Troy] Well, you can't have the body yet. All right? Sir?</p> <p>-[to Barnaby] Oh, I see you've got a right constable there. You let me know when you're ready for me.</p> <p>-[Troy] See the car?</p> <p>-Yes.</p> <p>-You wouldn't have thought they were so well paid, would you, undertakers? \u4f60\u5e94\u8be5\u6ca1\u6709\u60f3\u5230\u6ba1\u4eea\u5458\u4f1a\u83b7\u5f97\u5982\u6b64\u9ad8\u7684\u62a5\u916c\uff0c\u4e0d\u662f\u5417\uff1f</p> <p>-Check the camera, and the telephones. Find out what calls did Miss Simpson made after six o'clock.</p> <p>-So you're taking it seriously then, sir?</p> <p>-No, Troy, I'm just filling in time until tea.</p> <p>-Right! Oh, camera and telephone, right. What about you?</p> <p>-I must find a doctor.</p> <p>-Something wrong, sir?</p> <p>-Emily Simpson's doctor, Troy. Maybe she did suffer from dizzy spells. Maybe she did just fail. Either way, I want to know. - spell \u62fc\u5199\uff1b\u5492\u8bed\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#_5","title":"\u533b\u751f\u7684\u5bb6\u91cc","text":"<p>\u533b\u751f\u7684\u62db\u724c\uff1a</p> <pre><code>DR. TREVOR LESSITER\nM.B B.S M.R.C.G.P\n\nPHSICIAN &amp; SURGEON\n</code></pre> <p>DR. - Doctor\u3002Trevor Lessiter\u662f\u533b\u751f\u7684\u540d\u5b57\u3002</p> <p>M.B B.S - Bachelor of Medicine, Bachelor of Surgery \u5185\u5916\u5168\u79d1\u533b\u5b66\u58eb</p> <p>M.R.C.G.P - Membership of the Royal College of General Practitioners \u82f1\u56fd\u7687\u5bb6\u5168\u79d1\u533b\u751f\u5b66\u9662\u4f1a\u5458\u8d44\u683c\u3002pratitioner \u4ece\u4e1a\u8005\u3002general pratitioner \u5168\u79d1\u533b\u751f\u3002</p> <p>She is remarkably fit for her age. - \u5728\u5979\u8fd9\u4e2a\u5e74\u9f84\uff0c\u5979\u663e\u5f97\u975e\u5e38\u5065\u5eb7\u3002fit \u5065\u5eb7\u7684\u3002</p> <p>I liked to drop in at the end of my rounds. You know, glass of sherry and all that. - go round to sb's house \u62dc\u8bbf\u67d0\u4eba\u3002 drop in - \u987a\u4fbf\u8fc7\u6765\u3002</p> <p>cricket \u677f\u7403\u3002</p> <p>But she never got round to saying what it was. - \u5979\u6ca1\u80fd\u8bf4\u51fa\u6765\u662f\u4ec0\u4e48\u4e8b\u3002get round to \u505a\u6210\u4e86\u4e00\u4ef6\u4f60\u56e0\u5176\u4ed6\u4e8b\u60c5\u88ab\u803d\u6401\u4e86\u4e8b\u3002</p> <p>I've got to talk to someone. - \u6211\u5f97\u8fd9\u4e2a\u4eba\u8bf4\u8bf4\u8bdd\u3002have (got) to \u4e0d\u5f97\u4e0d\u3002</p> <p>-Did she say what it was?</p> <p>-No.</p> <p>-Didn't you press her?</p> <p>-We're not meant to. - \u6211\u4eec\u4e0d\u662f\u6545\u610f\u7684\u3002</p> <p>-And there was nothing more?</p> <p>-I'm sorry, Inspector. I know there was something else but I can't think. \u6211\u77e5\u9053\u8fd8\u6709\u4e9b\u4e8b\u60c5\uff0c\u4f46\u662f\u6211\u60f3\u4e0d\u8d77\u6765\u3002</p> <p>-Well, if it does come to you, can you give us ring? \u5f53\u4f60\u60f3\u8d77\u6765\uff0c\u80fd\u4e0d\u80fd\u7ed9\u6211\u4eec\u4e00\u4e2a\u7535\u8bdd\u3002</p> <p>-Yes, of course.</p> <p>ring off - \u6302\u65ad\u7535\u8bdd\u3002</p> <p>Inspector - \u7763\u5bdf\u3002</p> <p>scrambled eggs - \u7092\u9e21\u86cb\u3002scramble \u4e89\u593a\u3002</p> <p>Stuck with a heavy object as yet unidentified at the base of the neck. \u8116\u5b50\u6839\u90e8\u88ab\u4e00\u4e2a\u5c1a\u672a\u8fa8\u8ba4\u7684\u91cd\u7269\u5361\u4f4f\u3002</p> <p>sombre music - \u9634\u6c89\u7684\u97f3\u4e50\u3002</p> <p>The grass flattened, brambles broken. \u8349\u88ab\u538b\u6241\u4e86\uff0c\u8346\u68d8\u65ad\u4e86\u3002</p> <p>What, you think someone's been having it away? \u4f60\u8ba4\u4e3a\u6709\u4eba\u628a\u5b83\u4eec\u62ff\u8d70\u4e86\uff1f</p> <p>Two people bonking? \u4e24\u4e2a\u4eba\u640f\u6597/\u6027\u4ea4\uff1f</p> <p>tweezers - \u954a\u5b50\u3002</p> <p>-A piece of black fibre. \u4e00\u7247\u9ed1\u8272\u7ea4\u7ef4\u3002</p> <p>-Off their clothes. \u4ece\u4ed6\u4eec\u7684\u8863\u670d\u4e0a\u6389\u4e0b\u6765\u7684\uff1f</p> <p>-No, I don't think so. I'd say a blanket or rug, something like that. \u6211\u8ba4\u4e3a\u662f\u6bef\u5b50\u6216\u5730\u6bef\u3002</p> <p>I want the whole place gone over. - go over \u4ed4\u7ec6\u68c0\u67e5\u3002</p> <p>Do you really think that's what it came down to, sir? \u4f60\u771f\u7684\u8ba4\u4e3a\u8fd9\u5c31\u662f\u95ee\u9898\u6240\u5728\u5417\uff1f</p> <p>Unless it was adultery. \u9664\u975e\u662f\u901a\u5978\u3002</p> <p>I suppose they could have been arse-bandits. - \u6211\u731c\u60f3\u53ef\u80fd\u4ed6\u4eec\u662f\u5c41\u80a1\u5c0f\u5077\uff08\u540c\u6027\u604b\uff09\u3002arse\uff08\u7c97\u9c81\u7684\u8bcd\uff09\u5c41\u80a1\u3002bandit \u6709\u6b66\u5668\u7684\u5c0f\u5077\u3002</p> <p>You mean \"homesexuals\", Troy?  Troy\uff0c\u4f60\u662f\u8bf4\u540c\u6027\u604b\uff1f</p> <p>You are as politically correct as Nuremberg rally. \u4f60\u548c\u7ebd\u4f26\u5821\u96c6\u4f1a\uff08\u5fb7\u56fd\u7eb3\u7cb9\u4e00\u5e74\u4e00\u5ea6\u7684\u515a\u4ee3\u4f1a\uff09\u4e00\u6837\u653f\u6cbb\u6b63\u786e\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#rainbird","title":"Rainbird\u5bb6","text":"<p>eerie music - \u602a\u5f02\u7684\u97f3\u4e50\u3002</p> <p>pot to kettle. \u628a\u9505\u91cc\uff08\u7684\u6c34\uff09\u5012\u5230\u58f6\u91cc\uff0c\u5e94\u8be5\u662f\u4e0a\u8336\u7684\u610f\u601d\u3002\uff08\u5f71\u7247\u4e2d\uff0c\u8336\u6c34\u662f\u88c5\u5728\u74f7\u58f6\u91cc\uff09</p> <p>eyrie - \u662f aerie \u7684\u53e6\u4e00\u79cd\u5199\u6cd5\uff0c\u9e70\u5de2\u3002an elevated often secluded dwelling, structure, or position \u8f83\u9ad8\u4e14\u901a\u5e38\u50fb\u9759\u7684\u4f4f\u5b85\u3001\u7ed3\u6784\u6216\u4f4d\u7f6e\u3002If you refer to a place such as a house or a castle as an eyrie, you mean it is built high up and is difficult to reach.</p> <p>My hide. Yes, I'm a keen observer of wild life, birds. \u6211\u7684\u9690\u85cf\u7231\u597d\uff0c\u6211\u559c\u6b22\u89c2\u5bdf\u91ce\u751f\u52a8\u7269\u2014\u2014\u9e1f\u3002</p> <p>I thought I saw a pair of binoculars. \u6211\u60f3\u6211\u770b\u89c1\u4e86\u4e00\u526f\u671b\u8fdc\u955c\u3002</p> <p>trolley \u624b\u63a8\u8f66\u3002</p> <p>Do help yourself. \u8bf7\u81ea\u4fbf\u3002</p> <p>widower - \u9ccf\u592b\u3002widow \u5be1\u5987\u3002</p> <p>The clubs are anchovy. Salmon spread in the hearts. Marmite spades and potted meat diamonds.</p> <p>\u6885\u82b1\u72b6\u7684anchovy\u3002Salmon spread\u662f\u5fc3\u5f62\u7684\u3002\u9ed1\u6843\u72b6\u7684Marmite\u3002\u65b9\u5757\u72b6\u7684potted meat. - potted: preserved in a pot, jar, or can: potted meat.</p> <p>Not that you'll find her there. \u5e76\u4e0d\u662f\u8bf4\u4f60\u4f1a\u5728\u90a3\u91cc\u627e\u5230\u5979\u3002</p> <p>Done very nicely for herself. \u4e3a\u81ea\u5df1\u505a\u5f97\u5f88\u597d\u3002</p> <p>-Iced sombrero, constable. - Iced sombrero\u51b0\u9614\u8fb9\u5e3d\uff08\u5e94\u8be5\u662f\u8fd9\u79cd\u5f62\u72b6\u7684\u98df\u7269\uff09\uff0cconstable \u8b66\u5458\u3002constabulary \u8b66\u5bdf\u5c40\u3002</p> <p>-No, thank you. And I'm a sergeant.</p> <p>\u5927\u4e0d\u5217\u98a0\u8b66\u5bdf\u7b49\u7ea7\uff08\u7531\u9ad8\u5230\u4f4e\uff09\uff1a</p> <p>Chief constable, Deputy chief constable, Assistant chief constable, Chief superintendent\u603b\u8b66\u53f8, Superintendent\u8b66\u53f8, Chief inspector\u603b\u7763\u5bdf, Inspector\u7763\u5bdf, Sergeant\u8b66\u957f, Constable\u8b66\u5458. - \u53c2\u8003\u7ef4\u57fa\u767e\u79d1\u3002</p> <p>Detective\u662f\u8b66\u5bdf\u7684\u524d\u7f00\u4e4b\u4e00\uff0c\u6bd4\u5982Detective Chief Inspector\u3002\u8fd9\u79cd\u8b66\u5bdf\u4e00\u822c\u7a7f\u4fbf\u8863\uff0c\u804c\u4f4d\u548c\u804c\u7ea7\u548c\u5236\u670d\u8b66\u5bdf\u4e00\u6837\u3002</p> <p>-I mean what are you likely to see flying at that time? \u6211\u7684\u610f\u601d\u4f60\u90a3\u4e2a\u65f6\u5019\u60f3\u8981\u770b\u4ec0\u4e48\u98de\u79bd\uff1f</p> <p>-Owls. \u732b\u5934\u9e70\u3002</p> <p>These two give me the creeps. \u8fd9\u4e24\u4e2a\u4eba\u8ba9\u6211\u6bdb\u9aa8\u609a\u7136\u3002give someone the creeps - to cause someone to have uncomfortable feelings of nervousness or fear:</p> <p>-You don't suppose it was him in the woods, do you? \u4f60\u8be5\u4e0d\u4f1a\u8ba4\u4e3a\u662f\u4ed6\u5728\u6811\u6797\u91cc\u5427\uff1f</p> <p>-I somehow doubt it, Troy. \u6211\u6709\u70b9\u6000\u7591\u3002</p> <p>They certainly had it in for her. \u4ed6\u4eec\u5f53\u7136\u662f\u4e3a\u4e86\u5979\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#barnaby","title":"Barnaby\u5bb6","text":"<p>'Tis Pity She's a Whore. \u53ef\u60dc\u5979\u662f\u4e00\u4e2a\u5993\u5973\uff0cJohn Ford \u5bfc\u6f14\u7684\u97f3\u4e50\u5267\u3002'Tis \u662f it is \u7684\u7f29\u5199\u3002</p> <p>Would you go through my lines with me? \u4f60\u53ef\u4ee5\u5e2e\u6211\u4e00\u8d77\u7ec3\u4e60\u4e00\u4e0b\u53f0\u8bcd\u5417\uff1f</p> <p>I doubt he'll have time. \u6211\u6000\u7591\u4ed6\u662f\u5426\u6709\u65f6\u95f4\u3002</p> <p>quail - \u9e4c\u9e51\u3002</p> <p>(Telephone rings) I'll get it. \u6211\u53bb\u63a5\u7535\u8bdd\u3002</p> <p>In the pond behind the quarry. \u5728\u91c7\u77f3\u573a\u540e\u9762\u7684\u6c60\u5858\u91cc\u3002</p> <p>-Think what the police would make of it if their forensic people got hold of it. \u60f3\u60f3\u8b66\u5bdf\u4f1a\u600e\u4e48\u60f3\uff0c\u5982\u679c\u4ed6\u4eec\u7684\u6cd5\u533b\u4eba\u5458\u62ff\u5230\u4e86\u5b83\u3002make of - to have an impression or understanding about something. \u5bf9\u67d0\u4e8b\u6709\u5370\u8c61\u6216\u6709\u4e86\u89e3\u3002</p> <p>-They'd have a field day. \u4ed6\u4eec\u4f1a\u5ea6\u8fc7\u6109\u5feb\u7684\u4e00\u5929\u3002field day \u7279\u6b8a\u7684\u4e00\u5929\u3002</p> <p>-This is the big one, Denny. This is going to make us very, very rich. \u8fd9\u662f\u6700\u91cd\u8981\u7684\uff0c\u8fd9\u4f1a\u8ba9\u6211\u53d8\u5f97\u975e\u5e38\u5bcc\u6709\u3002</p> <p>Two colomns in the local rag and a coroner's re-port. - coroner \u9a8c\u5c38\u5b98\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#tye-house","title":"Tye House","text":"<p>tyres screech - \u8f6e\u80ce\u5c16\u53eb\u58f0\u3002</p> <p>bright upbeat music - \u660e\u4eae\u6b22\u5feb\u7684\u97f3\u4e50\u3002upbeat \u4e50\u89c2\u7684\u3002</p> <p>-How the other half live?</p> <p>-Rather less then half I'd say. \u6211\u8bf4\u76ee\u524d\u8fd8\u4e0d\u662f\uff08\u5bcc\u8c6a\u7684\uff09\u53e6\u4e00\u534a\u3002</p> <p>estate manager - \u7269\u4e1a\u7ecf\u7406\u3002</p> <p>-I don't suppose you were in the village at any time at between six and eight on Wednesday? \u6211\u60f3\u4f60\u5468\u4e09\u516d\u70b9\u5230\u516b\u70b9\u4e4b\u95f4\u7684\u4efb\u4f55\u65f6\u95f4\u90fd\u4e0d\u4f1a\u5728\u6751\u5b50\u91cc\uff1f</p> <p>-No. Don't remember where I was. Out in the fields. \u4e0d\u5728\u3002\u4e0d\u592a\u8bb0\u5f97\u6211\u53bb\u4e86\u54ea\u91cc\u3002\u6211\u51fa\u53bb\u5230\u7530\u91ce\u91cc\u53bb\u4e86\u3002</p> <p>drawing room - \u5ba2\u5385\u3002</p> <p>late wife - \u5df2\u6545\u7684\u59bb\u5b50\u3002</p> <p>as a matter of fact - \u4e8b\u5b9e\u4e0a\u3002</p> <p>-If it's not too painful, sir, I'd be interested to know how your wife died. \u5982\u679c\u4e0d\u662f\u592a\u75db\u82e6\u7684\u8bdd\uff0c\u5148\u751f\uff0c\u6211\u5f88\u60f3\u77e5\u9053\u4f60\u59bb\u5b50\u662f\u600e\u4e48\u6b7b\u7684\u3002</p> <p>-It is painful. And I don't see how it's relevant. \u5f88\u75db\u82e6\u3002\u5e76\u4e14\u6211\u6ca1\u6709\u770b\u5230\uff08\u8fd9\u4e24\u4ef6\u4e8b\u7684\uff09\u76f8\u5173\u6027\u3002</p> <p>-Miss Simpson could have known your wife as Annabella. As a nick name, pet name or something like that. If there is a connection - - Simpson\u5973\u58eb\u53ef\u80fd\u77e5\u9053\u4f60\u7684\u59bb\u5b50\u662fAnnabella\uff0c\u4e00\u4e2a\u6635\u79f0\u3001\u7231\u79f0\u6216\u5176\u4ed6\u5565\u7684\u3002</p> <p>-There is no connection.</p> <p>-We need to be sure.</p> <p>-(sighs) If you insist. It was two years ago... \u5982\u679c\u4f60\u575a\u6301\u7684\u8bdd\u3002</p> <p>And Bella's sister had come along. Phyllis, Phyllis Cadell. She didn't shoot that ofen and I always wondered why she closed that day of all days. - Bella\u7684\u59d0\u59b9Phyllis Cadell\u4e5f\u6765\u4e86\uff0c\u5979\u4e0d\u7ecf\u5e38\u5c04\u51fb\uff0c\u6211\u5e38\u5e38\u60f3\u77e5\u9053\uff0c\u4e3a\u4ec0\u4e48\u90a3\u5929\u5979\u6574\u5929\u5173\u95e8\uff08\u53ef\u80fd\u662f\u6709\u4e2a\u79c1\u4eba\u5546\u5e97\uff09\u3002</p> <p>He'd come as a beater, to scare the birds. \u4ed6\u6765\u7684\u4efb\u52a1\u6572\u51fb\u5413\u552c\u9e1f\u3002</p> <p>I suppose it's always easy to talk about these thing with hindsight but I'm often felt think we were ill-fated that day. \u6211\u60f3\u4e8b\u540e\u8c08\u8bba\u8fd9\u4e9b\u4e8b\u60c5\u603b\u662f\u5f88\u5bb9\u6613\u7684\uff0c\u4f46\u6211\u5e38\u5e38\u89c9\u5f97\u6211\u4eec\u90a3\u5929\u8fd0\u6c14\u4e0d\u597d\u3002</p> <p>Bella tripped on a root and twisted her ankle rather badly. - Bella\u88ab\u6811\u6839\u7eca\u5012\u5e76\u4e14\u811a\u8e1d\u88ab\u626d\u4f24\u5f97\u975e\u5e38\u4e25\u91cd\u3002</p> <p>But by the time ambullance arrived it was all over. \u4f46\u5f53\u6551\u62a4\u8f66\u5230\u8fbe\u65f6\uff0c\u4e00\u5207\u90fd\u7ed3\u675f\u4e86\u3002</p> <p>dog whines - \u72d7\u545c\u545c\u58f0\u3002</p> <p>generator - \u53d1\u7535\u673a\u3002</p> <p>marquee - \u5e10\u7bf7\u3002</p> <p>You finished it, I take it? \uff08\u8b66\u5b98\uff09\u4f60\u7684\u95ee\u8baf\u7ed3\u675f\u4e86\u5427\uff1f\u6211\u53ef\u4ee5\u505a\u5176\u4ed6\u7684\u4e8b\u60c5\u5427\uff1f</p> <p>He was a sort of guardian. \u4ed6\u662f\u67d0\u79cd\u5b88\u62a4\u8005\u3002</p> <p>We won't take up any more or your time. \u6211\u4eec\u4e0d\u518d\u5360\u7528\u60a8\u7684\u65f6\u95f4\u4e86\u3002</p> <p>exhale - \u547c\u6c14\u3002</p> <p>But I do what I can even I'm quite worn out. - \u6211\u5c3d\u6211\u6240\u80fd\u5e2e\u5fd9\uff0c\u5373\u4f7f\u6211\u7d2f\u574f\u4e86\u3002wear \u78e8\u635f\u3002</p> <p>mistress - \u5973\u4e3b\u4eba\uff0c\u5177\u6709\u6743\u5a01\u6216\u63a7\u5236\u5730\u4f4d\u7684\u5973\u4eba\uff1b\u60c5\u5987\u3002</p> <p>Henry has a cottage on the estate and I'm being pensioned off there. I'm quite looking forward to it.</p> <p>Pathetic. - \u53ef\u601c\u7684\u3002</p> <p>She was scared shitless. - \u5979\u88ab\u5413\u5f97\u5c41\u6eda\u5c3f\u6d41\u3002</p> <p>You do have a way with words, don't you?</p> <p>What are we investigating, sir? Emily Simpson or Belly Trace?</p> <p>There's no point asking me about it. \u6ca1\u6709\u5fc5\u8981\u95ee\u6211\u8fd9\u4e2a\u95ee\u9898\u3002</p> <p>I don't have anything to do with the village. And the village doesn't have much to do with me.\u6211\u548c\u90a3\u6751\u5b50\u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\u3002\u90a3\u6751\u5b50\u548c\u6211\u4e5f\u6ca1\u6709\u592a\u5927\u5173\u7cfb\u3002</p> <p>-Could you tell me where you were on last Wednesday?</p> <p>-No. I don't know. Maybe I'm here, I'm most days. </p> <p>-Not much of life. \u6ca1\u4ec0\u4e48\u751f\u6d3b\u3002</p> <p>-My work is my life. You wouldn't understand that. \u6211\u7684\u5de5\u4f5c\u5c31\u662f\u6211\u7684\u751f\u6d3b\u3002\u4f60\u4e0d\u4f1a\u7406\u89e3\u8fd9\u4e00\u70b9\u3002I might have gone for a walk or something, I don't remember.</p> <p>Missis - Miss, Misses \u5c0f\u59d0\u3002</p> <p>I ran hell for leather back to Tye House. - hell\u8868\u793a\u7a0b\u5ea6\uff0c\u52a0\u5f3a\u8bed\u6c14\u3002</p> <p>I'll say one thing for Katherine. She certainly doesn't come cheap. \u6211\u8981\u4e3aKatherine\u8bf4\u4e00\u4ef6\u4e8b\uff0c\u5979\u7684\u4ef7\u683c\u5f53\u7136\u4e0d\u4fbf\u5b9c\u3002</p>"},{"location":"blog/movie/the-killings-at-badgers-drift/#barnaby_1","title":"Barnaby\u5bb6","text":"<p>intense uneasy music - \u5f3a\u70c8\u4e0d\u5b89\u7684\u97f3\u4e50\u3002</p> <p>-This noble creature was in every part. So angel-like, so glorious, that a woman, who was not human, as was I -- \u8fd9\u4e2a\u9ad8\u8d35\u7684\u751f\u7269\u65e0\u5904\u4e0d\u5728\u3002</p> <p>-Had not been but human. \u53ea\u4e0d\u8fc7\u662f\u4eba\u7c7b\u3002</p> <p>-Who had not been but human, as was I. Would have kneeled to him and begged for love. \u8c01\u4e0d\u662f\u4eba\u7c7b\uff0c\u5c31\u50cf\u6211\u4e00\u6837\u3002\u4f1a\u5411\u4ed6\u4e0b\u8dea\u5e76\u4e5e\u7231\u3002You, why you are not worthy once to name. His name without true worship, or indeed. Unless you kneeled, to have another name him. \u4f60\uff0c\u4e3a\u4f55\u8fde\u4e00\u6b21\u7684\u540d\u5b57\u90fd\u4e0d\u914d\u3002 \u4ed6\u7684\u540d\u5b57\u6ca1\u6709\u771f\u6b63\u7684\u5d07\u62dc\uff0c\u6216\u8005\u8bf4\u786e\u5b9e\u5982\u6b64\u3002 \u9664\u975e\u4f60\u8dea\u4e0b\u6765\u7ed9\u4ed6\u8d77\u53e6\u4e00\u4e2a\u540d\u5b57</p> <p>-What was he called?</p> <p>-We not come to that. \u6211\u4eec\u5e76\u6ca1\u6709\u8c08\u5230\u8fd9\u4e2a\u3002Let it suffice that you shall have the glory. \u53ea\u8981\u4f60\u62e5\u6709\u8363\u8000\u5c31\u8db3\u591f\u4e86\u3002To father what so brave a father got. \u5bf9\u4e8e\u7236\u4eb2\u6765\u8bf4\uff0c\u4e00\u4e2a\u7236\u4eb2\u6709\u591a\u4e48\u52c7\u6562\u3002</p> <p>That sounded good. It's coming along.</p> <p>She's wonderful. We're gonna have to go up and see it.</p> <p>-If I ever manage to learn it all. \u5982\u679c\u6211\u80fd\u5b66\u4f1a\u8fd9\u4e00\u5207\u5c31\u597d\u4e86\u3002manage to do \u8bbe\u6cd5\u505a\uff0c\uff08\u5c3d\u7ba1\u6709\u56f0\u96be\uff09\u6210\u529f\u505a\u3002</p> <p>I've got a nice Pot-au-feu in the deep freeze. \u6211\u6709\u4e00\u4efd\u7f8e\u5473\u7684\u51b7\u51bb\u7096\u9505\u3002Pot-au-feu (/\u02ccp\u0252to\u028a\u02c8f\u025c\u02d0r/; French: [p\u0254t\u203fo f\u00f8] ( listen); \"pot on the fire\") is a French dish of slowly boiled meat and vegetables, usually served as two courses: first the broth (bouillon) and then the meat (bouilli) and vegetables.</p> <p>horse nickers - nicker: 1, (of a horse) give a soft, low, breathy whinny. 2, a nickering sound.</p> <p>white lilies - \u767d\u767e\u5408\u3002</p> <p>This is the Satin Service.</p> <p>Whimsical sombre music - \u5f02\u60f3\u5929\u5f00\u7684\u5fe7\u90c1\u97f3\u4e50\u3002</p> <p>You've withdrawn 500 pounds from our joint reserve account. \u60a8\u5df2\u7ecf\u4ece\u6211\u4eec\u7684\u8054\u5408\u50a8\u84c4\u8d26\u6237\u4e2d\u63d0\u53d6\u4e86500\u82f1\u9551\u3002</p> <p>overdraw - \u900f\u652f\u3002</p> <p>I thought I'd leave you two to bicker in private. \u6211\u60f3\u6211\u5e94\u8be5\u8ba9\u4f60\u4fe9\u79c1\u4e0b\u6597\u5634\u3002</p> <p>I know that my redeemer liveth, and that he shall stand upon the last on the earth. Whom I shall see for myself, and mine eyes shall behold, and not another.\uff08\u7977\u544a\uff09\u6211\u77e5\u9053\u6211\u7684\u6551\u4e16\u4e3b\u8fd8\u6d3b\u7740\u3002- mine \u7528\u5728\u5143\u97f3\u4e4b\u524d\uff0c\u76f8\u5f53\u4e8emy.</p> <p>Missis Rainbird no more a bird-wather than I am. - Rainbird\u5973\u58eb\u548c\u6211\u4e00\u6837\u90fd\u4e0d\u662f\u9e1f\u7c7b\u89c2\u5bdf\u8005\u3002</p> <p>personalised Porsche. \u4e2a\u6027\u5316\u7684\u4fdd\u65f6\u6377\u3002</p> <p>Rain stopped play. \u96e8\u505c\u6b62\u4e86\u6bd4\u8d5b\u3002</p> <p>His wife's just as bad. \u4ed6\u7684\u59bb\u5b50\u540c\u6837\u7cdf\u7cd5\u3002</p> <p>It's early closing. \u5173\u95e8\u8fd8\u65e9\u5440\u3002</p> <p>There's something wrong and something that doesn't add up. \u6709\u4e9b\u5730\u65b9\u51fa\u4e86\u95ee\u9898\uff0c\u6709\u4e9b\u5730\u65b9\u4e0d\u5408\u903b\u8f91\u3002</p> <p>Maybe he was. Maybe he simply mistaken in his account. But he wasn't telling us the truth. \u4ed6\u53ef\u80fd\u662f\uff08\u5728\u6492\u8c0e\uff09\uff0c\u4e5f\u53ef\u80fd\u53ea\u662f\u8bb0\u9519\u4e86\u3002\u4f46\u662f\u4ed6\u6ca1\u6709\u544a\u8bc9\u6211\u4eec\u4e8b\u5b9e\u3002</p> <p>Why did he run all the way back to Tye House to call the ambullance when the accident happened on the other side of the village? \u4e8b\u6545\u53d1\u751f\u5728\u6751\u5b50\u7684\u53e6\u4e00\u8fb9\uff0c\u4e3a\u4ec0\u4e48\u4ed6\u8fd8\u8981\u5343\u91cc\u8fe2\u8fe2\u8dd1\u56deThe House\u53eb\u6551\u62a4\u8f66\u5462\uff1f</p> <p>-It seems they're all bloody liars. \u770b\u8d77\u6765\u4ed6\u4eec\u90fd\u662f\u8be5\u6b7b\u7684\u6492\u8c0e\u8005\u3002bloody - used to express anger or to emphasize what you are saying in a slightly rude way.</p> <p>-One of them is something more. \u5176\u4e2d\u4e00\u4e2a\u6709\u66f4\u591a\u4e1c\u897f\u3002</p> <p>Forasmuch as it hath pleased Almighty God of his great mercy to take unto himself, the soul of our dear sister here departed, we therefore commit her body to the ground; earth to earth, ashes to ashes, dust to dust; Amen.</p> <p>It's early days yet. \u73b0\u5728\u8fd8\u65e9\u5462\u3002</p> <p>Not for poor Emily.</p> <p>Come and have sherry. \u6765\u559d\u676f\u96ea\u8389\u9152\u5427\uff01I feel the need of a drink. I'm afraid funerals do that for me. \u6211\u89c9\u5f97\u9700\u8981\u559d\u4e00\u676f\uff0c\u6050\u6015\u846c\u793c\u5bf9\u6211\u6765\u8bf4\u5c31\u662f\u8fd9\u6837\u3002</p> <p>polio - \u810a\u9ad3\u7070\u8d28\u708e\u3002</p> <p>pensive music - pensive\u6c89\u601d\u7684\u3002</p> <p>She adored him. Still does for all I know. - \u5979\u5d07\u62dc/\u559c\u6b22\u4ed6\uff0c\u636e\u6211\u6240\u77e5\uff08for all I know\uff09\u4ecd\u7136\u5982\u6b64\u3002</p> <p>She was Herry's ward. \u5979\u662fHerry\u7684\u88ab\u76d1\u62a4\u4eba\u3002</p> <p>Herry sort of adopted them. - Herry\u6709\u70b9\u6536\u517b\u4e86\u4ed6\u4eec\u3002</p> <p>set them up in a gamekeeper's cottage on the estate. - \u628a\u4ed6\u4eec\u653e\u5728\u5e84\u56ed\u7684\u730e\u573a\u770b\u5b88\u4eba\u7684\u5c0f\u5c4b\u91cc\u3002</p> <p>They are very young then, barely in their teens. - \u4ed6\u4eec\u90a3\u65f6\u5019\u8fd8\u5f88\u5c0f\uff0c\u624d\u5341\u51e0\u5c81\u3002</p> <p>nanny - \u4fdd\u59c6\u3002</p> <p>There was a nanny, Mary Sharpe, Nanny Sharpe, which was meant to look after them. - \u6709\u4e00\u4e2a\u4fdd\u59c6\uff0c\u53ebSharpe\uff0c\u662f\u4e3a\u4e86\u7167\u987e\u4ed6\u4eec\u3002</p> <p>-But she had a terrible time. \u4f46\u662f\u5979\u5ea6\u8fc7\u4e86\u4e00\u6bb5\u7cdf\u7cd5\u7684\u65f6\u5149\u3002</p> <p>-In what way? \u4ee5\u4ec0\u4e48\u6837\u7684\u65b9\u5f0f\uff1f</p> <p>-The children were always fighting. Endless rows. - \u5b69\u5b50\u4eec\u603b\u662f\u6253\u67b6\uff0c\u65e0\u4f11\u6b62\u5730\u4e89\u5435\u3002row \u53ef\u6570\u540d\u8bcd\uff0c\u4e89\u5435\uff1aA row is a serious disagreement between people or organizations.</p> <p>In the end, Mary upped and left. - \u6700\u540e\uff0cMary\u8d77\u8eab\u79bb\u5f00\u4e86\u3002up \u52a8\u8bcd\uff0c\u589e\u52a0\uff1b\u7a81\u7136\u79bb\u5f00\uff1aIf you up and leave a place, you go away from it, often suddenly or unexpectedly.</p> <p>Now she's retired down on the coast. \u73b0\u5728\u5979\u5728\u6d77\u8fb9\u9000\u4f11\u4e86\u3002</p> <p>-If you ask me, Katherine is the one to look out for. \u5982\u679c\u4f60\u95ee\u6211\uff0c\u51ef\u745f\u7433\u662f\u503c\u5f97\u7559\u610f\u7684\u4eba\u3002</p> <p>-Meaning? \u610f\u601d\u662f\uff1f</p> <p>-That girl is far too beautiful for other people's good. \u90a3\u4e2a\u5973\u5b69\u592a\u6f02\u4eae\u4e86\uff0c\u4e0d\u5229\u4e8e\u522b\u4eba\u3002That girl is far too beautiful for other people's good. If she was found bonking in the wood, she has the most to lose. \u5982\u679c\u5979\u88ab\u53d1\u73b0\u5728\u6811\u6797\u91cc\u6253\u6eda\uff08\u6027\u4ea4\uff09\uff0c\u5979\u7684\u635f\u5931\u5c06\u662f\u6700\u5927\u7684\u3002</p> <p>She's got a point. \u5979\u8bf4\u5f97\u6709\u9053\u7406\u3002</p> <p>it barks its head off. \u5b83\u62fc\u547d\u72c2\u53eb\u3002its head\u5728\u8fd9\u91cc\u8868\u793a\u5f3a\u70c8\u7a0b\u5ea6\u3002You'd have heard it a mile away! \u4f60\u4e00\u82f1\u91cc\u5916\u90fd\u80fd\u542c\u89c1\u5b83\u3002</p> <p>Damn! Do you know, for a minute I thought I had the whole thing solved. \u8be5\u6b7b\uff01\u4f60\u77e5\u9053\u5417\uff0c\u6709\u4e00\u77ac\u95f4\u6211\u4ee5\u4e3a\u6211\u5df2\u7ecf\u89e3\u51b3\u4e86\u6574\u4e2a\u95ee\u9898\u3002</p> <p>I think I deserve another Marron Lyonnaise. - \u6211\u8ba4\u4e3a\u6211\u503c\u5f97\u518d\u6765\u4e00\u4efd\u6211\u503c\u5f97\u518d\u6765\u4e00\u4efd\u9a6c\u9f99\u00b7\u91cc\u6602\u9171\u3002</p> <p>I want their clothes bagged and down forensics. - \u6211\u60f3\u628a\u4ed6\u4eec\u7684\u8863\u670d\u6253\u5305\u5e76\u53d6\u8bc1\u3002forensics\u6cd5\u533b\u3002</p> <p>What a mess. - \u771f\u662f\u4e00\u56e2\u7cdf\u3002</p> <p>She's being treated for shock outside, no surprise. - \u5979\u4f11\u514b\u4e86\uff0c\u6b63\u5728\u5916\u9762\u63a5\u53d7\u6cbb\u7597\uff0c\u8fd9\u5e76\u4e0d\u5947\u602a\u3002shock\u4f11\u514b\u3002</p> <p>Don't expect to get much sense. - \u4e0d\u8981\u6307\u671b\u5f97\u5230\u592a\u591a\u610f\u4e49\u3002</p> <p>You'd better come up and take a look at this. \u4f60\u6700\u597d\u8fc7\u6765\u770b\u770b\u8fd9\u4e2a\u3002</p> <p>-You're not going to believe it. \u4f60\u4e0d\u4f1a\u76f8\u4fe1\u7684\u3002</p> <p>-On the contrary, Troy, I rather think I will. \u6070\u6070\u76f8\u53cd\uff0c\u6211\u89c9\u5f97\u6211\u4f1a\u76f8\u4fe1\u7684\u3002</p> <p>What was it she said, sir? \u5148\u751f\uff0c\u5979\u8bf4\u4e86\u4ec0\u4e48\uff1f</p> <p>Listen to this: At 10:30 a.m. Mister and Missis W crossed over by post box to avoid Miss G. 10\u70b930\u5206\uff0cW\u5148\u751f\u548cW\u5c0f\u59d0\u7a7f\u8fc7\u90ae\u653f\u4fe1\u7bb1\u4ee5\u907f\u514dG\u5c0f\u59d0\u3002</p> <p>11:00 a.m. A called on Miss S., stayed 15 minutes. \u4e0a\u534811:00\uff0cA\u62dc\u8bbf\u4e86S\u5c0f\u59d0\uff0c\u505c\u7559\u4e8615\u5206\u949f\u3002</p> <p>There must be a couple of hundred entries in this file alone. \u4ec5\u8fd9\u4e2a\u6587\u4ef6\u4e2d\u5c31\u5f97\u6709\u4e0a\u767e\u4e2a\u6761\u76ee\u3002May thousands of them over the years. \u53ef\u80fd\u6709\u8fd9\u51e0\u5e74\u7684\u4e0a\u5343\u6761\u8bb0\u5f55\u3002</p> <p>I want them all taken down. \u6211\u5e0c\u671b\u4ed6\u4eec\u90fd\u88ab\u8bb0\u5f55\u4e0b\u6765\u4e86\u3002take down 1, \u8bb0\u5f55write down; 2, \u62c6\u9664dismantle: wall, fence etc.</p> <p>We're gonna have to go through the whole lot of them. \u6211\u4eec\u4e0d\u5f97\u4e0d\u8981\u628a\u5b83\u4eec\u5168\u90e8\u6d4f\u89c8\u4e00\u904d\u3002</p> <p>blackmail - n. &amp; vt. \u52d2\u7d22\u3002</p> <p>She wasn't a bad old stick. \u5979\u4e0d\u662f\u4e00\u4e2a\u5f88\u574f\u7684\u4eba\u3002</p> <p>She is a bit perculiar, her and her son. Him being au undertaker and all. - \u5979\u548c\u5979\u7684\u513f\u5b50\u6709\u70b9\u5947\u602a\u3002\u4ed6\u662f\u6ba1\u4eea\u9986\u7684\u627f\u529e\u4eba\u7b49\u7b49\u3002perculiar - \u5947\u7279\u7684\u3002</p> <p>But she was very good for me, in her own way, very good to me.</p> <p>One is getting wed. \u5c06\u8981\u7ed3\u5a5a\u7684\u90a3\u4e2a\u3002</p> <p>-That's a bend just ahead. \u524d\u9762\u5c31\u662f\u4e00\u4e2a\u8f6c\u5f2f\u3002</p> <p>-Now, I've seen it, sir. \u6211\u770b\u5230\u4e86\u3002</p> <p>And do me a favor, Troy, when we get there, if we get there, park at the bottom of the lane. \u5e2e\u6211\u4e00\u4e2a\u5fd9\uff0c\u7279\u6d1b\u4f0a\uff0c\u5f53\u6211\u4eec\u5230\u8fbe\u90a3\u91cc\u65f6\uff0c\u5982\u679c\u6211\u4eec\u5230\u8fbe\u90a3\u91cc\uff0c\u8bf7\u5c06\u8f66\u505c\u5728\u8f66\u9053\u7684\u5e95\u90e8\u3002</p> <p>yells - \u547c\u558a\u3002</p> <p>Sometimes you really make me sick. \u6709\u65f6\u4f60\u771f\u7684\u8ba9\u6211\u611f\u5230\u6076\u5fc3\u3002</p> <p>I don't care if you marry him for money, but why can't you come clean and admit it? \u6211\u4e0d\u5728\u4e4e\u4f60\u5ac1\u7ed9\u4ed6\u662f\u4e0d\u662f\u4e3a\u4e86\u94b1\uff0c\u4f46\u4f60\u4e0d\u5766\u767d\u627f\u8ba4\u3002come clean \u5766\u767d\u8bf4\u51fa\u6765\u3002admit \u627f\u8ba4\u3002</p> <p>It's not like that. \u4e0d\u662f\u90a3\u6837\u7684\u3002</p> <p>So what is it like? Tying yourself to a bloody cripple at your age. \u5728\u4f60\u8fd9\u4e2a\u5e74\u7eaa\uff0c\u628a\u81ea\u5df1\u7ed1\u5728\u4e00\u4e2a\u8be5\u6b7b\u7684\u7638\u5b50\u8eab\u4e0a\u3002tying - tie\u7684\u73b0\u5728\u5206\u8bcd\u3002</p> <p>That bloody cripple looked after us. If it hadn't been for him, we wouldn't have had a home. We wouldn't have had anything.</p> <p>Yes, he's getting his pound of flesh, isn't he? - \u662f\u7684\uff0c\u4ed6\u6b63\u5728\u5f97\u5230\u4e00\u78c5\u8089\uff08\u610f\u601d\u662f\u4e70\u5230\u56de\u62a5\uff09\u3002</p> <p>He's not buying me, Michael.</p> <p>So what is he doing then? Renting you by the hour? \u90a3\u4ed6\u73b0\u5728\u662f\u505a\u4ec0\u4e48\uff1f\u6309\u5c0f\u65f6\u79df\u8d41\u4f60\u5417\uff1f</p> <p>slaps - \u62cd\u51fb\u3002</p> <p>Alright, then. Don't come to our wedding. Henry and I are better off without you. \u90a3\u597d\u5427\u3002\u4e0d\u8981\u6765\u53c2\u52a0\u6211\u4eec\u7684\u5a5a\u793c\u3002\u6ca1\u6709\u4f60\uff0c\u4ea8\u5229\u548c\u6211\u4f1a\u8fc7\u5f97\u66f4\u597d\u3002be better off - If you say that someone would be better off doing something, you are advising them to do it or expressing the opinion that it would benefit them to do it: If you've got bags you're better off taking a taxi.</p> <p>I won't bother buying a present, then!</p> <p>-Do you want to go follow her, sir?</p> <p>-No, Troy, I'd like to take a closer look in here.</p> <p>-What? Go in without a warrant? Isn't that a bit? - \u4ec0\u4e48\uff1f\u6ca1\u6709\u641c\u67e5\u4ee4\u5c31\u8fdb\u53bb\uff1fwarrant - \u4fdd\u8bc1\uff1b\u503c\u5f97\uff0c\u6709\u5fc5\u8981\uff1b\u641c\u67e5\u4ee4\uff1b\u505a\u67d0\u4e8b\u7684\u4f9d\u636e\u3002</p> <p>-You have a problem, Troy?</p> <p>-No, no. Just glad I didn't suggest it. \u53ea\u662f\u5e86\u5e78\u6211\u6ca1\u5982\u6b64\u5efa\u8bae\u3002</p> <p>-If anybody finds us, you did.</p> <p>-Pity. \u771f\u9057\u61be\u3002</p> <p>-Locked? \u9501\u4e0a\u4e86\uff1f</p> <p>-Yep.</p> <p>-I can force it. \u6211\u53ef\u4ee5\u5f3a\u884c\u5f04\u5f00\u5b83\u3002</p> <p>Thank you all the same.</p> <p>-Mom gone to bed? \u5988\u5988\u5df2\u7ecf\u7761\u4e86\u5417\uff1f</p> <p>-Hours ago. \u51e0\u5c0f\u65f6\u524d\uff08\u5c31\u7761\u4e86\uff09\u3002What's all this? \u8fd9\u5230\u5e95\u662f\u4ec0\u4e48\uff1f</p> <p>-Notebooks. Iris Rainbrid took a Neighbourhood Watch to unheard of extremes. - Iris Rainbrid\u5c06\u90bb\u91cc\u5b88\u671b\u8005\u7ec4\u7ec7\u5e26\u5230\u4e86\u524d\u6240\u672a\u95fb\u7684\u6781\u7aef\u3002extreme - \u6781\u7aef\u3002</p> <p>You wouldn't think that one small village could have so much trouble bubbling under the surface.</p> <p>-Was it very horrid? The bodies.</p> <p>-I've seen worse.</p> <p>I'm one more step further down the road. - \u6211\u5728\u8def\u4e0a\u53c8\u5411\u524d\u8fc8\u8fdb\u4e86\u4e00\u6b65\u3002</p> <p>-I haven't read lines with you. How's it going?</p> <p>-Oh well, four acts down, one to go. - \u56db\u5e55\u5df2\u7ed3\u675f\uff0c\u8fd8\u5269\u4e00\u5e55\u3002</p> <p>-Yes, I suppost it's the last act that really matters. \u662f\u7684\uff0c\u6211\u8ba4\u4e3a\u771f\u6b63\u91cd\u8981\u7684\u662f\u6700\u540e\u4e00\u5e55\u3002</p> <p>car rumbles - \u8f66\u9686\u9686\u5730\u3002</p> <p>peacock hoots - \u5b54\u96c0\u53eb\u3002</p> <p>It's out of the question. - \u8fd9\u662f\u4e0d\u53ef\u80fd\u7684\u3002</p> <p>Voice of sanity. \u7406\u667a\u7684\u58f0\u97f3\u3002</p> <p>Parish Council - \u6559\u533a\u8bae\u4f1a\u3002</p> <p>It was only later I realised. \u540e\u6765\u6211\u624d\u610f\u8bc6\u5230\u3002</p> <p>Everything's over, it's all slipping away. \u4e00\u5207\u90fd\u7ed3\u675f\u4e86\uff0c\u4e00\u5207\u90fd\u8fc7\u53bb\u4e86\u3002</p> <p>-I don't suppose you saw anyone in the woods? \u6211\u60f3\u4f60\u5728\u6811\u6797\u91cc\u6ca1\u6709\u770b\u5230\u4efb\u4f55\u4eba\u5427\uff1f</p> <p>-No. \u6ca1\u6709\u770b\u5230\u3002</p> <p>Phillips Codell, I'm here arresting you on suspicion of the murder of Bella Trace on 26th of June 1995.</p> <p>You don't have to say anything, but it may harm your defence if you do not mention when questioned something that you reply on in court. Anything you do say may be given in evidence.</p> <p>He was in that wheelchair and she just couldn't cope.</p> <p>It's something one does in the country. \u8fd9\u662f\u56fd\u5185\u6bcf\u4e2a\u4eba\u90fd\u4f1a\u505a\u7684\u4e8b\u60c5\u3002</p> <p>I took a hip flask, filled with vodka and I kept on drinking. It was the only that I could get the courge.</p> <p>All the dead birds. The noise, the blood that made me feel sick and dizzy. \u5230\u5904\u90fd\u662f\u6b7b\u9e1f\u3002\u566a\u97f3\u3001\u8840\u6db2\u8ba9\u6211\u611f\u5230\u6076\u5fc3\u548c\u5934\u6655\u3002</p> <p>I didn't think I was gonna be able to do it.</p> <p>I doubled back behind the trees and managed to hide. - \u6211\u6298\u56de\u6811\u540e\u5e76\u8bbe\u6cd5\u8eb2\u4e86\u8d77\u6765\u3002double back, to turn and go back in the direction you have come from.</p> <p>Then I waited until I had a clear shot. And then. I shot her. \u7136\u540e\u6211\u5c31\u7b49\u5230\u4e86\u6e05\u6670\u7684\u89c6\u89d2\u3002\u7136\u540e\uff0c\u6211\u5c31\u5f00\u67aa\u6253\u4e86\u5979\u3002\u7b2c\u4e00\u4e2ashot\u662f\u201c\u955c\u5934\u201d\u7684\u610f\u601d\uff0c\u7b2c\u4e8c\u4e2ashot\uff0c\u662fshoot\u7684\u8fc7\u53bb\u5f0f\u53ca\u8fc7\u53bb\u5206\u8bcd\u3002</p> <p>It was terrible. I saw her pitch forward and fall to the ground. - \u592a\u53ef\u6015\u4e86\u3002\u6211\u770b\u5230\u5979\u5411\u524d\u503e\u5012\uff0c\u5012\u5728\u4e86\u5730\u4e0a\u3002pitch, to move or be moved suddenly, especially by throwing or being thrown.</p> <p>And then, I just panicked. \u7136\u540e\uff0c\u6211\u5c31\u60ca\u614c\u5931\u63aa\u4e86\u3002panickis a common misspelling of panic.</p> <p>I got up and I ran and I ran.</p> <p>I thought then that I'd done it, that I got away with it. \u90a3\u65f6\u6211\u60f3\u6211\u5df2\u7ecf\u505a\u5230\u4e86\uff0c\u6211\u9003\u8131\u4e86\u60e9\u7f5a\u3002</p> <p>How could I have known that I'd been seen? \u6211\u60f3\u77e5\u9053\uff0c\u6211\u662f\u600e\u4e48\u88ab\u770b\u89c1\u7684\uff1f</p> <p>She put it all in those notebooks, didn't she? I had to go to that revolting house.</p> <p>I expect you'll be needed more than ever at Tye House now. \u6211\u9884\u8ba1Tye House\u73b0\u5728\u6bd4\u4ee5\u5f80\u4efb\u4f55\u65f6\u5019\u90fd\u66f4\u9700\u8981\u4f60\u3002Quite the chatelaine you'll be, won't you? Now, what will you have?</p> <p>dramatic siniter music - \u620f\u5267\u6027\u7684\u9669\u6076\u97f3\u4e50</p> <p>The diamonds are marmite, the spades are jam, the hearts are tuna and the clubs are sandwich spread. \u65b9\u5757\u662f\u9a6c\u9ea6\u9171\uff0c\u9ed1\u6843\u662f\u679c\u9171\uff0c\u7ea2\u5fc3\u662f\u91d1\u67aa\u9c7c\uff0c\u6885\u82b1\u662f\u4e09\u660e\u6cbb\u3002</p> <p>spread - \u653e\u5728\u9762\u5305\u6216\u997c\u5e72\u4e0a\u7684\u8f6f\u8d28\u98df\u7269\uff08\u9171\uff09\u3002a soft food for putting on bread and crackers:</p> <p>cheese/chocolate/fish spread</p> <p>There's bread and various spreads for tea.</p> <p>voiceover - \u753b\u5916\u97f3\u3002</p> <p>How much did they take? \u4ed6\u4eec\u62ff\u4e86\u591a\u5c11\u94b1\uff1f</p> <p>They'd even stopped asking me. They knew I was cleaned out. \u4ed6\u4eec\u751a\u81f3\u4e0d\u518d\u627e\u6211\u8981\u4e86\u3002\u4ed6\u4eec\u77e5\u9053\u6211\u88ab\u638f\u7a7a\u4e86\u3002</p> <p>Sir, there's someone here for you in reception. \u5148\u751f\uff0c\u6709\u4eba\u5728\u63a5\u5f85\u5904\u7b49\u5019\u60a8\u3002</p> <p>There's something about that story, the shooting party, that still not right.</p> <p>You know you featured in here? \u4f60\u77e5\u9053\u4f60\u81ea\u5df1\u88ab\u5305\u62ec\u5728\u8fd9\u4e2a\u7b14\u8bb0\u672c\u4e2d\u4e86\u5417\uff1f</p> <p>He was wearing his denims and that cap he wears. \u90a3\u4e2a\u4eba\u7a7f\u7740\u4ed6\u7684\u725b\u5b50\u88e4\u548c\u5e3d\u5b50\u3002</p> <p>brutal - \u91ce\u86ee\u7684\u3002</p> <p>-You again. You don't give up, do you?</p> <p>-Mister Lacey, we're here in connection with the death of Iris Rainbird.</p> <p>-In connection with. You policemen have a wonderful way of expressing yourselves.</p> <p>-As you may know, Mister Lacey, she was murdered in a particularly brutal fashion. \u4f60\u53ef\u80fd\u77e5\u9053\uff0c\u83b1\u897f\u5148\u751f\uff0c\u5979\u662f\u88ab\u4ee5\u4e00\u79cd\u7279\u522b\u6b8b\u9177\u7684\u65b9\u5f0f\u8c0b\u6740\u7684\u3002</p> <p>-I hope you're not looking for insincere expressions of regret on my part, Chief Inspector. \u6211\u5e0c\u671b\u4f60\u4e0d\u662f\u5728\u5bfb\u627e\u6211\u4e0d\u771f\u8bda\u7684\u9057\u61be\u8868\u793a\uff0c\u603b\u7763\u5bdf\u3002She was a very nasty woman. \u5979\u662f\u4e2a\u4ee4\u4eba\u8ba8\u538c\u7684\u5973\u4eba\u3002</p> <p>-Did you ever go to her house?</p> <p>-No.</p> <p>-So what would you say if I told you that somebody had been you entering her front door shortly after four o'clock yesterday afternoon?</p> <p>-I would say they needed their eyes testing.</p> <p>-(Troy) Mister Lacey, we have a warrant here to search these premises. - premises, \u67d0\u4eba\uff08\u4e00\u822c\u662f\u516c\u53f8\u6216\u7ec4\u7ec7\uff09\u62e5\u6709\u7684\u571f\u5730\u548c\u5efa\u7b51the land and buildings owned by someone, especially by a company or organization. premise, \u524d\u63d0\u3002</p> <p>-So how do you explain this, Sir?</p> <p>-I can't! Of course I can't!</p> <p>-Where have you put the clothes?</p> <p>-What clothes?</p> <p>-The dungarees, the cap and the golves. \u5de5\u4f5c\u670d\u3001\u5e3d\u5b50\u548c\u624b\u5957\u3002</p> <p>-What?</p> <p>-The clothes you wore to kill Iris Rainbird.</p> <p>-You're raving mad! \u4f60\u75af\u4e86\u5427\uff01rave, to speak in an uncontrolled way, usually because you are upset or angry, or because you are sick.</p> <p>I've been framed. \u6211\u88ab\u9677\u5bb3\u4e86\u3002</p> <p>a custody death.</p> <p>-Maybe we should have put her on suicide watch, sir?</p> <p>-Is that a reprimant, Troy? 'Cause you're right. This is my fault.</p> <p>-Maybe she's better off this way. All things considered.</p> <p>-That is not the point.</p> <p>Lacey has been shouting  his mouth off, sir. \u83b1\u897f\u4e00\u76f4\u5728\u5927\u558a\u5927\u53eb\u3002</p> <p>door clanks. \u95e8\u53ee\u5f53\u54cd\u3002</p> <p>How nice of you to look in, Chief Inspector.</p> <p>-You say what you've got to say and get on with it. \u4f60\u8bf4\u51fa\u4f60\u5fc5\u987b\u8bf4\u7684\u8bdd\uff0c\u7136\u540e\u7ee7\u7eed\u8bf4\u4e0b\u53bb\u3002</p> <p>-I want to go home.</p> <p>-Aren't you, Mister Comedy? You want the truth, Mister Lacey. I've had you up to here. \u6211\u51e0\u4e4e\u90fd\u67e5\u51fa\u4f60\u7684\u7f6a\u4e86\u3002</p> <p>You were in such a hurry to drag me off yesterday. \u4f60\u6628\u5929\u90a3\u4e48\u6025\u7740\u628a\u6211\u62d6\u8d70\u3002</p> <p>mid-morning - \u4e0a\u5348\u4e2d\u65ec\u3002</p> <p>Caped Crusader - \u6597\u7bf7\u5341\u5b57\u519b</p> <p>He only did the first sketches but they took all day. \u4ed6\u53ea\u753b\u4e86\u8349\u56fe\uff0c\u4f46\u662f\u8fd9\u4e9b\u8349\u56fe\u82b1\u4e86\u4e00\u5929\u7684\u65f6\u95f4\u3002</p> <p>He said I had a wonderful complicated face.</p> <p>He's a surrealist, is he? \u4ed6\u662f\u8d85\u73b0\u5b9e\u4e3b\u4e49\u8005\uff0c\u662f\u5417\uff1f</p> <p>-And since everyone's always picking on him, you might as well know he was there the night Emily Simpson died too. \u65e2\u7136\u6bcf\u4e2a\u4eba\u90fd\u5728\u627e\u4ed6\u7684\u832c\uff0c\u4f60\u4e0d\u59a8\u77e5\u9053\u827e\u7c73\u4e3d\u00b7\u8f9b\u666e\u68ee\u53bb\u4e16\u7684\u90a3\u5929\u665a\u4e0a\u4ed6\u4e5f\u5728\u4ed6\u7684\u5de5\u4f5c\u5ba4\u91cc\u3002</p> <p>-You've seen quite a bit of him, is there something that I ought to know? \u4f60\u5df2\u7ecf\u548c\u4ed6\u89c1\u8fc7\u4e0d\u5c11\u6b21\u9762\u4e86\uff0c\u6709\u6ca1\u6709\u4ec0\u4e48\u4e8b\u662f\u6211\u8be5\u77e5\u9053\u7684\uff1f\uff08\u4f60\u6709\u6ca1\u6709\u548c\u4ed6\u53d1\u751f\u8fc7\u4ec0\u4e48\uff1f\uff09</p> <p>-What? Something like you and your Missis Whiplash? Or Barbara and all her boyfriends? No, dad, there's nothing you need to know at all. \u4ec0\u4e48\u4e8b\uff1f\u5c31\u50cf\u4f60\u548cWhiplash\u592a\u592a\u90a3\u6837\u5417\uff1f\u6216\u8005Barbara\u548c\u5979\u7684\u90a3\u4e9b\u7537\u670b\u53cb\u4e00\u6837\uff1f\u6ca1\u6709\uff0c\u7238\u7238\uff0c\u6ca1\u6709\u4ec0\u4e48\u4e8b\u662f\u4f60\u5e94\u8be5\u77e5\u9053\u7684\uff08\u6211\u548c\u4ed6\u6ca1\u6709\u53d1\u751f\u90a3\u6837\u7684\u4e8b\uff09\u3002</p> <p>In fact I think she may have told us more than she meant to. \u4e8b\u5b9e\u4e0a\u6211\u8ba4\u4e3a\u5979\u544a\u8bc9\u4e86\u6211\u4eec\u6bd4\u5979\u672c\u610f\u66f4\u591a\u7684\u4e8b\u60c5\u3002</p> <p>-It's very good.</p> <p>-It's only Marks and Sparks, I'm afraid. You should have told me you were coming.</p> <p>-Marks and Sparks is fine.</p> <p>The Lessiter girl backed up his alibi. \u83b1\u65af\u7279\u5973\u5b69\u652f\u6301\u4e86\u4ed6\u7684\u4e0d\u5728\u573a\u8bc1\u636e\u3002</p> <p>It had to be a trick. \u8fd9\u4e00\u5b9a\u662f\u4e00\u4e2a\u8be1\u8ba1\u3002</p> <p>car honks. \u6c7d\u8f66\u9e23\u7b1b\u3002</p> <p>I have to be off. \u6211\u8981\u8d70\u4e86\u3002</p> <p>Burnham Crescent - Burnham\u53d1\u97f3\u4e3a[BUR] + [NUHM]\u3002crescent\u96d5\u523b\u6210\u7684\u7c7b\u4f3c\u65b0\u6708\u7684\u5f62\u72b6\u3002</p> <p>Up ahead this road on the left. \u5f80\u8fd9\u6761\u8def\u524d\u9762\u7684\u5de6\u8fb9\u8d70\u3002</p> <p>They were not easy children but of course under the circumstances, one had to make allowances. \u4ed6\u4eec\u4e0d\u662f\u597d\u5b69\u5b50\uff0c\u4f46\u5f53\u7136\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4eba\u4eec\u5fc5\u987b\u4f53\u8c05\u4ed6\u4eec\u3002</p> <p>Every day it was a slanging match. \u6bcf\u5929\u90fd\u662f\u4e00\u573a\u8c29\u9a82\u6bd4\u8d5b\u3002She'd scream at him and he'd fling himself out of the house.</p> <p>cup shatters. \u676f\u5b50\u7c89\u788e\u3002</p> <p>How could I've betrayed them? \u6211\u600e\u4e48\u53ef\u80fd\u80cc\u53db\u4ed6\u4eec\uff1f</p> <p>All she had to do was to hand the dog over to her brother. \u5979\u6240\u8981\u505a\u7684\u5c31\u662f\u628a\u72d7\u4ea4\u7ed9\u5979\u54e5\u54e5\u3002</p> <p>Why wouldn't he open the door. Because then she'd have seen the dog and that would have spoiled the whole set-up. \u90a3\u4f1a\u7834\u574f\u6574\u4e2a\u8bbe\u8ba1\u3002</p> <p>If it hadn't been for an observant neighbour and an unlocked tricycle, we'd have never been any the wiser. \u5982\u679c\u6ca1\u6709\u7ec6\u5fc3\u7684\u90bb\u5c45\u548c\u4e00\u8f86\u6ca1\u4e0a\u9501\u7684\u4e09\u8f6e\u8f66\uff0c\u6211\u4eec\u6c38\u8fdc\u4e0d\u4f1a\u53d8\u5f97\u66f4\u806a\u660e\u3002</p> <p>Yes, they're clever, weren't they? Always working off one another.</p> <p>Whoever went to the house was wearing overalls and a cap and they probably made sure they were seen at least from behind. - overalls\u5de5\u4f5c\u670d\u3002</p> <p>Katherine stabbed them and then she put the knife and the blood-soaked overalls into the basket.</p> <p>Bella Trace was just a freak change, wrong place, wrong time.</p> <p>makesman - \u5236\u9020\u8005\u3002</p> <p>bludgeon, poison, stab</p> <p>sheep bleat - \u7f8a\u54a9\u54a9\u53eb\u3002</p> <p>\"I've been framed.\" And he made this sign. It was a coded message. He was warning her to remove the picture. - \u6211\u628a\u753b\u88c5\u5728\u6846\u91cc\u4e86\u3002frame, \u628a\u753b\u88c5\u6846\uff0cWhen a picture or photograph is framed, it is put in a frame.</p> <p>It'd have given the game away, wouldn't it? \u8fd9\u5e45\u753b\u6cc4\u9732\u4e86\u8fd9\u4e2a\u6e38\u620f\uff0c\u4e0d\u662f\u5417\uff1fgive away\u6cc4\u9732\uff0cIf you give away information that should be kept secret, you reveal it to other people.</p> <p>-It's powerful. It's brilliant even in its own way.</p> <p>-He had talent.</p> <p>-But so twisted.</p> <p>-I almost guessed it when we came here. The three bedrooms and only one bed slept in. They pulled the wool right over my eyes.</p> <p>-(Troy) When?</p> <p>-That time we came here and they were arguing. They really did seem to hate each other, didn't they? And they couldn't have staged it for our benefit. Because they didn't know we were here. Except they did. They saw us in the mirror. And they did put on a show.</p> <p>-Poor Emily.</p> <p>-(Troy) And poor Annabella. Who was she?</p> <p>-I don't suppose we'll ever know. </p> <p>I hope you're not gonna fall asleep in this.</p> <p>I wouldn't dream of it.</p> <p>Anyway, after what you've just been through, a start of incest should be right up your street.</p> <p>Come this in sadness from you.</p> <p>Let some mystery befall me soon if I dissemble all.</p>"},{"location":"blog/personal_site/blog/","title":"Blog","text":"<ul> <li>Hexo\u535a\u5ba2\u6846\u67b6</li> <li>Hexo\u4e2d\u6587\u6587\u6863</li> <li>Create and host your blog for free with hexo &amp; Github</li> <li>npm show \"NPM ELF : not found error\" in WSL</li> <li>Github\u4e2a\u4eba\u8bbf\u95ee\u4ee4\u724c</li> </ul>"},{"location":"blog/personal_site/github_pages/","title":"Github Pages","text":""},{"location":"blog/personal_site/github_pages/#github-pages","title":"Github Pages","text":"<p>\u4f7f\u7528github pages\u53ef\u4ee5\u642d\u5efa\u4e2a\u4eba\u4e3b\u9875\u3002</p> <p>github pages\u7b80\u4ecb\uff1a\u5b98\u65b9\u94fe\u63a5\u3002</p> <p>github pages\u4f7f\u7528\u4e86CNAME record\u6280\u672f\uff0c\u53c2\u8003\uff1a\u94fe\u63a51\u3001\u94fe\u63a52\u3001Custom domains in Github Pages\u3002</p> <p>\u6ce8\uff1aRead the Docs\u4e5f\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u642d\u5efa\u4e2a\u4eba\u4e3b\u9875\u7684\u7f51\u7ad9\u3002</p>"},{"location":"blog/personal_site/github_pages/#github-pages_1","title":"Github Pages \u7ad9\u70b9\u7c7b\u578b","text":"<p>\u67093\u79cd\u7c7b\u578b\u7684 Github Pages \u7ad9\u70b9\uff08sites\uff09\uff1aproject, user \u548c organization \u3002</p> <p>Project sites \u8fde\u63a5\u5230 github \u4e0a\u7279\u5b9a project \uff0c\u6bd4\u5982 Javascript library \u6216 recipe collection\u3002user \u6216 organization sites \u8fde\u63a5\u5230 github.com \u7684\u7279\u5b9a\u8d26\u6237\u3002</p> <p>\u53d1\u5e03 user site \uff0c\u4f60\u5fc5\u987b\u521b\u5efa\u4e00\u4e2a\u4f60\u7684\u4e2a\u4eba\u8d26\u6237\u4e0b\u7684\u4e00\u4e2a\u540d\u4e3a <code>&lt;username&gt;.github.io</code> \u7684 repository \u3002\u53d1\u5e03 organization site \uff0c\u4f60\u5fc5\u987b\u521b\u5efa\u4e00\u4e2a\u7ec4\u7ec7\u6240\u6709\u7684\u540d\u4e3a <code>&lt;organization&gt;.github.io</code> \u7684 repository \u3002\u9664\u975e\u4f60\u4f7f\u7528 custom domain \uff0c\u5426\u5219 user \u548c organization sites \u5c06\u4f4d\u4e8e <code>http(s)://&lt;username&gt;.github.io</code> \u6216 <code>http(s)://&lt;organization&gt;.github.io</code> \u3002</p> <p>project site \u7684\u6e90\u6587\u4ef6\u5b58\u50a8\u5728\u4f5c\u4e3a project \u7684\u76f8\u540c\u7684 repository \u4e2d\u3002\u9664\u975e\u4f7f\u7528 custom domain \uff0c \u5426\u5219 project sites \u5c06\u4f4d\u4e8e <code>http(s)://&lt;username&gt;.github.io/&lt;repository&gt;</code> \u6216 <code>http(s)://&lt;organization&gt;.github.io/&lt;repository&gt;</code> \u3002</p> <p>\u6709\u5173\u5982\u4f55\u81ea\u5b9a\u4e49\u5f71\u54cd\u60a8\u7f51\u7ad9\u7684\u57df\u540d\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u53c2\u89c1\"About custom domains and GitHub Pages\"\u3002</p> <p>\u6bcf\u4e2a github \u8d26\u6237\u5141\u8bb8\u521b\u5efa 1 \u4e2a user \u6216 organization \u7ad9\u70b9\u3002\u65e0\u8bba\u662f\u88ab\u7ec4\u7ec7\u8fd8\u662f\u4e2a\u4eba\u6240\u6709\uff0cproject \u7ad9\u70b9\u7684\u4e2a\u6570\u4e0d\u9650\u5236\u3002</p>"},{"location":"blog/personal_site/github_pages/#github-pages_2","title":"GitHub Pages \u8bbf\u95ee\u65b9\u6cd5","text":"<p>\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3002</p> <p>\u4f8b\u5982\uff0c\u4f60\u7684project\u7ad9\u70b9\u914d\u7f6e\u7684\u53d1\u5e03\u6e90\u662f<code>gh-pages</code>\u5206\u652f\uff0c\u7136\u540e\u5728<code>gh-pages</code>\u5206\u652f\u4e0a\u521b\u5efa\u4e86\u4e00\u4e2a<code>about/contact-us.md</code>\u6587\u4ef6\uff0c\u4f60\u5c06\u53ef\u4ee5\u5728<code>https://&lt;user&gt;.github.io/&lt;repository&gt;/about/contact-us.html</code>\u8bbf\u95ee\u5b83\u3002</p> <p>\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528<code>Jekyll</code>\u7b49\u9759\u6001\u7ad9\u70b9\u751f\u6210\u5668\u6765\u7ed9\u4f60\u7684github page\u914d\u7f6e\u4e00\u4e2a\u4e3b\u9898\u3002</p>"},{"location":"blog/personal_site/github_pages/#_1","title":"\u7ad9\u70b9\u53d1\u5e03\u5e38\u89c1\u95ee\u9898\u7684\u89e3\u51b3\u65b9\u6cd5","text":"<ul> <li>Permission denied to github-actions[bot]</li> </ul>"},{"location":"blog/personal_site/github_pages/#github-workflows","title":"Github workflows","text":"<p>\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3002</p>"},{"location":"blog/personal_site/github_pages/#_2","title":"\u914d\u7f6e\u524d\u51c6\u5907","text":""},{"location":"blog/personal_site/github_pages/#markdown","title":"Markdown\u7f16\u8f91\u5668","text":"<p>\u63a8\u8350\u7684markdown\u7f16\u8f91\u5668\uff1a - VSCode\uff1a\u514d\u8d39\u3002VSCode\u539f\u751f\u652f\u6301Markdown\uff0c\u5b89\u88c5\u4e00\u4e9b\u63d2\u4ef6\u53ef\u4ee5\u5e2e\u52a9\u66f4\u5feb\u5730\u7f16\u5199markdown\u6587\u4ef6\u3002 - Typora\uff1a\u73b0\u5728\u5df2\u7ecf\u5f00\u59cb\u6536\u8d39\u3002</p> <p>VSCode markdown\u63d2\u4ef6\uff1a - Mardown All in One: \u63d0\u4f9b\u5feb\u6377\u952e\uff0c\u5e2e\u52a9\u66f4\u5feb\u7684\u7f16\u5199markdown\u6587\u4ef6\u3002 - Markdown+Math\uff1a\u63d0\u4f9b\u6570\u5b66\u516c\u5f0f\u652f\u6301\u3002 - Markdown Preview Enhanced: \u5c06\u539f\u751fmarkdown\u9884\u89c8\u7684\u9ed1\u8272\u80cc\u666f\u6539\u6210\u767d\u8272\u3002 - Markdown Preview Github Styling\uff1a\u63d0\u4f9bGithub\u98ce\u683c\u7684\u9884\u89c8\u3002</p> <p>\u5728\u7ebf\u8868\u683c\u751f\u6210\u5668\uff1a\u53ef\u4ee5\u751f\u6210Markdown\u3001Text\u3001HTML\u3001LaTex\u3001MediaWiki\u683c\u5f0f\u7684\u8868\u683c\u3002</p>"},{"location":"blog/personal_site/github_pages/#wsl","title":"\u8f7b\u91cf\u7ea7\u865a\u62df\u673aWSL","text":"<p>WSL\uff0cWindows Subsystem for Linux\uff0c\u662fWindows\u63d0\u4f9b\u7684\u8f7b\u91cf\u7ea7Linux\u865a\u62df\u673a\u3002</p> <p>\u5b89\u88c5\u6559\u7a0b\uff1a\u89c1\u94fe\u63a5\u3002</p>"},{"location":"blog/personal_site/github_pages/#wslsystemctl","title":"WSL\u9ed8\u8ba4\u6ca1\u6709\u542f\u7528systemctl\uff1a","text":"<p>\u542f\u7528systemctl\u7684\u65b9\u6cd5\uff1a\u94fe\u63a5\u3002</p> <p>\u66ff\u4ee3\u65b9\u6cd5\uff1a\u4e0d\u9700\u8981\u542f\u52a8systemctl\uff0c\u56e0\u4e3a\u4f1a\u6bd4\u8f83\u5360\u7528\u8d44\u6e90\uff0c\u542f\u52a8\u4e5f\u4f1a\u53d8\u6162\u3002\u53ef\u4ee5\u4f7f\u7528service\u547d\u4ee4\u66ff\u4ee3\u3002</p>"},{"location":"blog/personal_site/github_pages/#wslopenssl-server","title":"WSL\u9ed8\u8ba4\u6ca1\u6709\u5b89\u88c5openssl-server\uff1a","text":"<p>\u4f7f\u7528ssh\u8fde\u63a5\u5230\u670d\u52a1\u5668\u65f6\uff0c\u9700\u8981\u670d\u52a1\u5668\u8fd0\u884c\u7740sshd\u7a0b\u5e8f\uff0c\u5426\u5219\u8fde\u63a5\u4e0d\u4e0a\uff0c\u4f1a\u51fa\u73b0\"Connection refused\"\u9519\u8bef\u3002</p> <p>\u53c2\u8003\u94fe\u63a5\u3002</p> <p>\u67e5\u770bopenssh-server\u6709\u6ca1\u6709\u5b89\u88c5\uff1a <pre><code>dpkg --list | grep ssh\n</code></pre></p> <p>\u6ce8\uff1a\u5982\u679c\u5b89\u88c5\u4e86openssh-server\uff0c\u6267\u884cwhich sshd\u53ef\u4ee5\u770b\u5230\u8def\u5f84\u3002</p> <p>WSL\u9ed8\u8ba4\u6ca1\u6709\u5b89\u88c5openssh-server\uff0c\u5b89\u88c5\u65b9\u6cd5\uff1a <pre><code>sudo apt-get install openssh-server\n</code></pre></p> <p>\u542f\u52a8ssh\uff1a <pre><code>sudo service ssh start\n</code></pre></p>"},{"location":"blog/personal_site/github_pages/#httpsgithub","title":"\u901a\u8fc7https\u767b\u5f55\u5230github","text":"<p><code>git push</code>\u4e0d\u518d\u652f\u6301\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u5f53\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u65f6\uff0c\u9700\u8981\u8f93\u5165personal access token.</p> <p>\u6b65\u9aa41\uff1a\u5728github\u4e0a\u521b\u5efapersonal access token\uff1b</p> <p>\u6b65\u9aa42\uff1a\u5728\u547d\u4ee4\u884c\u4e0a\u4f7f\u7528personal access token\uff1b</p> <p>\u6b65\u9aa43\uff1a\u4e3a\u4e86\u907f\u514d\u6bcf\u6b21\u90fd\u9700\u8981\u8f93\u5165personal access token\uff0c\u53ef\u4ee5\u5c06\u5176\u7f13\u5b58\u5728git client\u4e0a\uff1a</p> <pre><code>gh auth login\n</code></pre> <p>\u6ce8\uff1a\u4f7f\u7528<code>gh</code>\u547d\u4ee4\u9700\u8981\u5148\u5b89\u88c5GitHub CLI\uff1a</p> <pre><code>sudo apt-get install gh\n</code></pre>"},{"location":"blog/personal_site/github_pages/#_3","title":"\u9759\u6001\u7ad9\u70b9\u751f\u6210\u5668","text":"<p>\u4ee5\u4e0b\u51e0\u79cd\u9759\u6001\u7ad9\u70b9\u751f\u6210\u5668\u90fd\u53ef\u4ee5\u7528\u6765\u642d\u5efa\u4e2a\u4eba\u4e3b\u9875\u3002\u5982\u679c\u4f7f\u7528\u9664JekyII\u5916\u7684\u5de5\u5177\uff0c\u5219\u9700\u8981\u914d\u7f6eGithub Actions\u4ee5\u6784\u5efa\u548c\u53d1\u5e03\u4f60\u7684\u7ad9\u70b9\u3002</p>"},{"location":"blog/personal_site/github_pages/#mkdocs","title":"mkdocs","text":"<p>mkdocs\u662f\u4e00\u4e2a\u5feb\u901f\u7684\u9759\u6001\u7f51\u9875\u751f\u6210\u5668\u3002</p> <p><code>mkdocs.yml</code> \u6587\u4ef6\u662f MkDocs \u6587\u6863\u751f\u6210\u5668\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5176\u683c\u5f0f\u8bf4\u660e\u53c2\u89c1\u8fd9\u91cc\u3002</p>"},{"location":"blog/personal_site/github_pages/#jekyii","title":"JekyII","text":"<p>Jekyll \u662f\u4e00\u4e2a\u9759\u6001\u7ad9\u70b9\u751f\u6210\u5668\uff0c\u5185\u7f6e\u5bf9 GitHub Pages \u7684\u652f\u6301\u548c\u7b80\u5316\u7684\u6784\u5efa\u8fdb\u7a0b\u3002</p> <p>\u53c2\u89c1 About GitHub Pages and Jekyll \u3002</p>"},{"location":"blog/personal_site/markdown/","title":"Markdown documentation","text":"<p>https://daringfireball.net/projects/markdown</p>"},{"location":"blog/personal_site/mkdocs/","title":"Mkdocs","text":""},{"location":"blog/personal_site/mkdocs/#configuration","title":"Configuration","text":"<p>See the doc.</p> <ol> <li>Keep underscore in file name</li> </ol> <p>refer to: </p> <ul> <li>https://pypi.org/project/mkdocs-gen-nav-plugin/</li> <li>https://github.com/mkdocs/mkdocs/issues/2017</li> <li>https://github.com/squidfunk/mkdocs-material/discussions/5977</li> <li>https://www.mkdocs.org/user-guide/writing-your-docs/#meta-data</li> <li>No help: https://www.mkdocs.org/user-guide/custom-themes/#pagetitle</li> </ul>"},{"location":"blog/personal_site/mkdocs.yml/","title":"Mkdocs.yml","text":"<p><code>mkdocs.yml</code> \u6587\u4ef6\u662f MkDocs \u6587\u6863\u751f\u6210\u5668\u7684\u914d\u7f6e\u6587\u4ef6\u3002</p> <p>\u793a\u4f8b\uff1a<code>mkdocs.yml</code></p>"},{"location":"blog/personal_site/mkdocs.yml/#theme","title":"theme","text":"<p>\u8be5\u6587\u4ef6\u4e2d\u7684 <code>theme</code> \u90e8\u5206\u7528\u4e8e\u6307\u5b9a\u7528\u4e8e\u751f\u6210\u6587\u6863\u7684\u4e3b\u9898\u3002</p> <p>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528\u7684\u4e3b\u9898\u662f Material\u3002 <code>name</code> \u5b57\u6bb5\u6307\u5b9a\u4e3b\u9898\u7684\u540d\u79f0\uff0c\u800c <code>custom_dir</code> \u5b57\u6bb5\u6307\u5b9a\u5305\u542b\u4e3b\u9898\u81ea\u5b9a\u4e49\u5185\u5bb9\u7684\u76ee\u5f55\u3002 <code>features</code> \u5b57\u6bb5\u6307\u5b9a\u53ef\u4ee5\u4e3a\u4e3b\u9898\u542f\u7528\u7684\u53ef\u9009\u529f\u80fd\u5217\u8868\u3002</p> <p>\u4ee5\u4e0b\u662f\u5728\u6b64\u914d\u7f6e\u6587\u4ef6\u4e2d\u5217\u51fa\u7684\u53ef\u9009\u529f\u80fd\uff1a</p> <ul> <li><code>announce.dismiss</code>: \u542f\u7528\u53ef\u5173\u95ed\u7684\u516c\u544a\u6a2a\u5e45\uff0c\u663e\u793a\u5728\u6587\u6863\u7684\u6bcf\u4e2a\u9875\u9762\u9876\u90e8\u3002</li> <li><code>content.action.edit</code>: \u5728\u6bcf\u4e2a\u9875\u9762\u4e0a\u542f\u7528\u201c\u7f16\u8f91\u201d\u6309\u94ae\uff0c\u4ee5\u4fbf\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u7f16\u8f91\u9875\u9762\u5185\u5bb9\u3002</li> <li><code>content.action.view</code>: \u5728\u6bcf\u4e2a\u9875\u9762\u4e0a\u542f\u7528\u201c\u67e5\u770b\u6e90\u4ee3\u7801\u201d\u6309\u94ae\uff0c\u4ee5\u4fbf\u7528\u6237\u53ef\u4ee5\u67e5\u770b\u9875\u9762\u7684\u6e90\u4ee3\u7801\u3002</li> <li><code>content.code.annotate</code>: \u542f\u7528\u4ee3\u7801\u6ce8\u91ca\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u6dfb\u52a0\u6ce8\u91ca\u4ee5\u89e3\u91ca\u4ee3\u7801\u3002</li> <li><code>content.code.copy</code>: \u542f\u7528\u4ee3\u7801\u590d\u5236\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u590d\u5236\u4ee3\u7801\u3002</li> <li><code>content.tooltips</code>: \u542f\u7528\u5de5\u5177\u63d0\u793a\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u5728\u9f20\u6807\u60ac\u505c\u65f6\u67e5\u770b\u6709\u5173\u9875\u9762\u5143\u7d20\u7684\u4fe1\u606f\u3002</li> <li><code>navigation.footer</code>: \u5728\u6bcf\u4e2a\u9875\u9762\u4e0a\u542f\u7528\u9875\u811a\u5bfc\u822a\u680f\u3002</li> <li><code>navigation.indexes</code>: \u542f\u7528\u7d22\u5f15\u5bfc\u822a\u680f\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u6d4f\u89c8\u6587\u6863\u4e2d\u7684\u7d22\u5f15\u3002</li> <li><code>navigation.sections</code>: \u542f\u7528\u90e8\u5206\u5bfc\u822a\u680f\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u6d4f\u89c8\u6587\u6863\u4e2d\u7684\u5404\u4e2a\u90e8\u5206\u3002</li> <li><code>navigation.tabs</code>: \u542f\u7528\u9009\u9879\u5361\u5bfc\u822a\u680f\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u6d4f\u89c8\u6587\u6863\u4e2d\u7684\u5404\u4e2a\u9009\u9879\u5361\u3002</li> <li><code>navigation.top</code>: \u5728\u6bcf\u4e2a\u9875\u9762\u4e0a\u542f\u7528\u9876\u90e8\u5bfc\u822a\u680f\u3002</li> <li><code>navigation.tracking</code>: \u542f\u7528\u5bfc\u822a\u8ddf\u8e2a\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u8ddf\u8e2a\u4ed6\u4eec\u5728\u6587\u6863\u4e2d\u7684\u4f4d\u7f6e\u3002</li> <li><code>search.highlight</code>: \u542f\u7528\u641c\u7d22\u7ed3\u679c\u9ad8\u4eae\u663e\u793a\u529f\u80fd\u3002</li> <li><code>search.share</code>: \u542f\u7528\u5171\u4eab\u641c\u7d22\u7ed3\u679c\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u8f7b\u677e\u5171\u4eab\u641c\u7d22\u7ed3\u679c\u3002</li> <li><code>search.suggest</code>: \u542f\u7528\u641c\u7d22\u5efa\u8bae\u529f\u80fd\uff0c\u4f7f\u7528\u6237\u53ef\u4ee5\u5728\u8f93\u5165\u641c\u7d22\u67e5\u8be2\u65f6\u83b7\u5f97\u5efa\u8bae\u3002</li> <li><code>toc.follow</code>: \u542f\u7528\u76ee\u5f55\u8ddf\u968f\u529f\u80fd\uff0c\u4f7f\u76ee\u5f55\u59cb\u7ec8\u4fdd\u6301\u53ef\u89c1\u3002</li> </ul> <p><code>palette</code> \u5b57\u6bb5\u6307\u5b9a\u4e86\u4e00\u4e2a\u989c\u8272\u65b9\u6848\uff0c\u8be5\u65b9\u6848\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <ul> <li><code>scheme</code>: \u6307\u5b9a\u989c\u8272\u65b9\u6848\u7684\u540d\u79f0\u3002</li> <li><code>primary</code>: \u6307\u5b9a\u4e3b\u8981\u989c\u8272\u3002</li> <li><code>accent</code>: \u6307\u5b9a\u5f3a\u8c03\u989c\u8272\u3002</li> <li><code>toggle</code>: \u6307\u5b9a\u5207\u6362\u5230\u6697\u6a21\u5f0f\u65f6\u4f7f\u7528\u7684\u56fe\u6807\u548c\u540d\u79f0\u3002</li> </ul> <p>\u7b2c\u4e00\u4e2a\u65b9\u6848\u540d\u4e3a default\uff0c\u5176\u4e2d\u4e3b\u8981\u989c\u8272\u548c\u5f3a\u8c03\u989c\u8272\u5747\u4e3a indigo\u3002\u5207\u6362\u5230\u6697\u6a21\u5f0f\u65f6\uff0c\u4f7f\u7528\u7684\u56fe\u6807\u4e3a material/brightness-7\uff0c\u540d\u79f0\u4e3a\u201c\u5207\u6362\u5230\u6697\u6a21\u5f0f\u201d\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u65b9\u6848\u540d\u4e3a slate\uff0c\u5176\u4e2d\u4e3b\u8981\u989c\u8272\u548c\u5f3a\u8c03\u989c\u8272\u5747\u4e3a indigo\u3002\u5207\u6362\u5230\u4eae\u6a21\u5f0f\u65f6\uff0c\u4f7f\u7528\u7684\u56fe\u6807\u4e3a material/brightness-4\uff0c\u540d\u79f0\u4e3a\u201c\u5207\u6362\u5230\u4eae\u6a21\u5f0f\u201d\u3002</p> <p>font \u5b57\u6bb5\u6307\u5b9a\u4e86\u7528\u4e8e\u6587\u672c\u548c\u4ee3\u7801\u7684\u5b57\u4f53\u3002\u5728\u6b64\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u6587\u672c\u5b57\u4f53\u4e3a Roboto\uff0c\u4ee3\u7801\u5b57\u4f53\u4e3a Roboto Mono\u3002 favicon \u5b57\u6bb5\u6307\u5b9a\u4e86\u7f51\u7ad9\u56fe\u6807\u7684\u8def\u5f84\u3002 icon \u5b57\u6bb5\u6307\u5b9a\u4e86\u7f51\u7ad9\u6807\u5fd7\u7684\u8def\u5f84\u3002</p> <p>favicon \u548c icon \u662f\u7f51\u7ad9\u7684\u4e24\u4e2a\u4e0d\u540c\u5143\u7d20\u3002</p> <p>favicon \u662f\u7f51\u7ad9\u7684\u56fe\u6807\uff0c\u901a\u5e38\u663e\u793a\u5728\u6d4f\u89c8\u5668\u6807\u7b7e\u9875\u4e0a\u3002\u5b83\u53ef\u4ee5\u662f\u4e00\u4e2a\u5c0f\u7684\u56fe\u50cf\u6587\u4ef6\uff0c\u901a\u5e38\u662f .ico \u683c\u5f0f\u3002\u5728 mkdocs.yml \u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 favicon \u5b57\u6bb5\u6765\u6307\u5b9a\u7f51\u7ad9\u56fe\u6807\u7684\u8def\u5f84\u3002</p> <p>icon \u662f\u7f51\u7ad9\u7684\u6807\u5fd7\uff0c\u901a\u5e38\u663e\u793a\u5728\u7f51\u7ad9\u7684\u6807\u9898\u680f\u6216\u9875\u7709\u4e2d\u3002\u5b83\u53ef\u4ee5\u662f\u4e00\u4e2a\u56fe\u50cf\u6587\u4ef6\uff0c\u4f8b\u5982 .png \u6216 .jpg \u6587\u4ef6\u3002\u5728 mkdocs.yml \u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 icon \u5b57\u6bb5\u6765\u6307\u5b9a\u7f51\u7ad9\u6807\u5fd7\u7684\u8def\u5f84\u3002</p>"},{"location":"blog/personal_site/mkdocs.yml/#plugin","title":"plugin","text":"<p>\u8fd9\u91cc\u5217\u51fa\u4e86\u4e09\u4e2a\u63d2\u4ef6\uff1ablog\u3001search\u548cminify\u3002\u5176\u4e2d\uff0cblog\u63d2\u4ef6\u7528\u4e8e\u652f\u6301\u535a\u5ba2\u529f\u80fd\uff0csearch\u63d2\u4ef6\u7528\u4e8e\u652f\u6301\u641c\u7d22\u529f\u80fd\uff0c\u800cminify\u63d2\u4ef6\u7528\u4e8e\u538b\u7f29HTML\u6587\u4ef6\u3002\u5728search\u63d2\u4ef6\u4e2d\uff0cseparator\u53c2\u6570\u6307\u5b9a\u4e86\u641c\u7d22\u65f6\u7684\u5206\u9694\u7b26\uff0c\u8fd9\u91cc\u7684\u5206\u9694\u7b26\u5305\u62ec\u7a7a\u683c\u3001\u8fde\u5b57\u7b26\u3001\u9017\u53f7\u3001\u5192\u53f7\u3001\u7b49\u53f7\u3001\u611f\u53f9\u53f7\u3001\u65b9\u62ec\u53f7\u3001\u62ec\u53f7\u3001\u5f15\u53f7\u3001\u53cd\u5f15\u53f7\u548c\u659c\u6760\u7b49\u3002</p>"},{"location":"blog/personal_site/mkdocs.yml/#extra","title":"extra","text":""},{"location":"blog/personal_site/mkdocs.yml/#analytics","title":"analytics","text":"<p>analytics\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u7f51\u7ad9\u5206\u6790\u670d\u52a1\u63d0\u4f9b\u5546\u548c\u5c5e\u6027ID\uff0c\u4f8b\u5982\u8861\u91cf\u7f51\u7ad9\u6d41\u91cf\u3002</p> <ul> <li>Setting up site analytics</li> <li>google\u514d\u8d39\u8bfe\u7a0b</li> </ul>"},{"location":"blog/personal_site/python/","title":"Python","text":""},{"location":"blog/personal_site/python/#python","title":"python\u5efa\u7acb\u4e2a\u4eba\u7ad9\u70b9","text":"<pre><code>python -m http.server\n</code></pre>"},{"location":"blog/personal_site/sphinx/","title":"Sphinx","text":""},{"location":"blog/personal_site/sphinx/#install-sphinx","title":"Install Sphinx","text":"<p>https://www.sphinx-doc.org/en/master/usage/installation.html</p>"},{"location":"blog/personal_site/sphinx/#hosting-the-documentation","title":"Hosting the documentation","text":"<p>https://sphinx-intro-tutorial.readthedocs.io/en/latest/docs_hosting.html</p>"},{"location":"blog/scripts/vscode/clean-space/","title":"Clean Space","text":"<ul> <li>.vscode-server/data/User/workspaceStorage/*\uff1a\u51e0\u5341GB.</li> <li>.vscode-server\uff1a\u53c2\u80031</li> <li>.config: \u53ef\u4ee5\u9488\u5bf9\u6bcf\u4e2a\u76ee\u5f55\u627e\u5230\u76f8\u5e94\u7684\u7a0b\u5e8f\uff0c\u6bd4\u5982 Chrome\uff0c\u7136\u540e\u6709\u9488\u5bf9\u6027\u5730\u5220\u9664\u4e00\u4e9b\u6587\u4ef6\u3002\u53c2\u8003\u8fd9\u91cc\u3002</li> <li> <p>.cache: \u548c .config \u7c7b\u4f3c\u5904\u7406\uff0c\u53c2\u8003\u8fd9\u91cc\u3002</p> <p>.cache/vscode-cpptools: This cache folder stores cached precompiled headers or \"ipch\" files that the IntelliSense engine uses to improve performance. You can limit the size of the cache by changing the setting value of C_Cpp.intelliSenseCacheSize. \u53c2\u8003\u8fd9\u91cc\uff1a </p> </li> </ul>"},{"location":"blog/scripts/vscode/debugger/","title":"Debugger","text":"<p>Debug multiple processes in VSCode</p> <p>Debug Python Subprocess</p>"},{"location":"blog/scripts/vscode/hot_keys/","title":"Hot Keys","text":"<p>\u8df3\u8f6c\u5230\u5bf9\u5e94\u5927\u62ec\u53f7\uff1a<code>Ctrl Shift \\</code></p>"},{"location":"blog/scripts/vscode/plugins/","title":"Plugins","text":"<ul> <li><code>Remote - SSH</code>: Windows \u8fde\u63a5 Linux\u3002\u524d\u7f6e\u6761\u4ef6\uff1aWindows \u672c\u8eab\u9700\u8981\u5b89\u88c5 ssh \u547d\u4ee4\u884c\u5de5\u5177\u3002</li> <li><code>Perforce for VS Code</code>: perforce \u5de5\u5177\u3002</li> <li><code>intent-rainbow</code>: \u7528\u5f69\u8272\u663e\u793a\u7f29\u8fdb\u3002</li> <li><code>C/C++</code></li> <li><code>Makefile Tools</code></li> <li><code>Verilog Format</code></li> <li><code>All in one</code></li> <li><code>c/c++ definition generator</code></li> <li><code>KoroFileHeader</code>: \u53c2\u8003\u8fd9\u91cc\u3002</li> </ul>"},{"location":"book_notes/CUDA/Synopsis/","title":"Synopsis","text":"<p>CUDA Runtime API\uff1a\u51fd\u6570\u4ee5<code>cuda</code>\u5f00\u5934\u3002</p> <p>CUDA Driver API\uff1a\u51fd\u6570\u4ee5<code>cu</code>\u5f00\u5934\u3002</p>"},{"location":"book_notes/CUDA/Synopsis/#latency","title":"\u5ef6\u8fdf\uff08Latency\uff09","text":""},{"location":"book_notes/CUDA/Synopsis/#_1","title":"\u6307\u4ee4\u5ef6\u8fdf","text":"\u6570\u636e\u7c7b\u578b \u5b57\u957f\uff08bits\uff09 \u64cd\u4f5c \u5ef6\u8fdf\uff08cycles\uff09 \u5907\u6ce8 \u6574\u6570 + 4 \u6574\u6570 32 * 16 \u6574\u6570 /,mod \u7279\u522b\u6602\u8d35 \u5c3d\u53ef\u80fd\u907f\u514d\uff0c\u6216\u4f7f\u7528\u4f4d\u64cd\u4f5c\u66ff\u4ee3 \u4f4d\u64cd\u4f5c 4 \u6bd4\u8f83 4 max,min 4 \u7c7b\u578b\u8f6c\u6362 4 \u6d6e\u70b9 +,*+ 4 \u6d6e\u70b9 / 36 \u5012\u6570 16 \u5e73\u65b9\u6839\u5012\u6570 16 \u6d6e\u70b9 \u5e73\u65b9\u6839 32 \u5b9e\u73b0\uff1a\u5e73\u65b9\u6839\u5012\u6570+\u5012\u6570\uff0c\u5bf90\u548c\u65e0\u7a77\u5927\u80fd\u6b63\u786e\u5f97\u5230\u7ed3\u679c\uff1b\u56e0\u6b64\u5b83\u5904\u7406\u4e00\u4e2awarp\u82b1\u8d3932\u4e2a\u65f6\u949f\u5468\u671f\u3002 __log(x) 16 __sin(x) 32 __cos(x) 32 __exp(x) 32 __fdividef(x,y) 20 \u9664\u6cd5 - - \u5176\u4ed6\u51fd\u6570 \u66f4\u591a\u65f6\u949f\u5468\u671f \u56e0\u4e3a\u5b9e\u73b0\u4e3a\u591a\u4e2a\u6307\u4ee4\u7684\u7ec4\u5408 - - \u5185\u5b58\u6307\u4ee4 4 \u5305\u62ec\u4ece\u5171\u4eab\u6216\u5168\u5c40\u5185\u5b58\u4e2d\u8bfb\u5199\u7684\u4efb\u4f55\u6307\u4ee4\uff0cSM\u4f7f\u75284\u4e2a\u65f6\u949f\u5468\u671f\u6765\u53d1\u5c04warp\u7684\u4e00\u4e2a\u5185\u5b58\u6307\u4ee4 - - __syncthreads() 4 \u540c\u6b65 <p>\u6709\u65f6\u5019\uff0c\u7f16\u8bd1\u5668\u4e0d\u5f97\u4e0d\u989d\u5916\u63d2\u5165\u8f6c\u6362\u6307\u4ee4\uff0c\u4ece\u800c\u5f15\u5165\u989d\u5916\u7684\u6267\u884c\u5468\u671f\uff1a</p> <p>\u5bf9\u64cd\u4f5c\u6570\u4e3achar\u6216short\u7684\u51fd\u6570\u64cd\u4f5c\uff0c\u5176\u64cd\u4f5c\u6570\u901a\u5e38\u8f6c\u6362\u4e3aint\uff1b \u5728\u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570\u8ba1\u7b97\u4e2d\uff0c\u5c06\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u6570\u5e38\u91cf\uff08\u4e0d\u4f7f\u7528\u4efb\u4f55\u7c7b\u578b\u540e\u7f00\u5b9a\u4e49\uff09\u4f5c\u4e3a\u8f93\u5165\u503c\uff1b \u5728\u6570\u5b66\u51fd\u6570\u7684\u53cc\u7cbe\u5ea6\u7248\u672c\uff0c\u5c06\u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570\u53d8\u91cf\u4f5c\u4e3a\u8f93\u5165\u53c2\u6570\u3002</p> <p>\u540e\u4e24\u79cd\u60c5\u51b5\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u907f\u514d\uff1a  </p> <p>\u5bf9\u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570\u5e38\u91cf\uff0c\u4f7f\u7528f\u540e\u7f00\u5b9a\u4e49\uff0c\u6bd4\u59823.141592653f \u5bf9\u6570\u5b66\u51fd\u6570\u7684\u5355\u7cbe\u5ea6\u7248\u672c\uff0c\u4e5f\u4f7f\u7528f\u540e\u7f00\u5b9a\u4e49\uff0c\u6bd4\u5982sinf().</p>"},{"location":"book_notes/CUDA/Synopsis/#_2","title":"\u8bbf\u5b58\u5ef6\u8fdf","text":"\u5185\u5b58\u7c7b\u578b \u5ef6\u8fdf L1/Shared Memory 10-20 Global Memory 400-600"},{"location":"book_notes/CUDA/Synopsis/#_3","title":"\u6027\u80fd\u6307\u5357","text":"<p>\u300aCUDA\u4e2d\u6587\u624b\u518c\u300b\u7b2c5\u7ae0</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/","title":"9.memory Optimizations","text":"<p>\u53c2\u89c1 CUDA C Best Paratices Guide Reference</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#9","title":"9. \u5185\u5b58\u4f18\u5316","text":""},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#91","title":"9.1 \u4e3b\u673a\u4e0e\u8bbe\u5907\u95f4\u6570\u636e\u4f20\u8f93","text":""},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#911-pinned-memory","title":"9.1.1 \u56fa\u5b9a\u5185\u5b58\uff08Pinned Memory\uff09","text":"<p>\u8bbe\u5907\u5185\u5b58\u548cGPU\u4e4b\u95f4\u7684\u5cf0\u503c\u7406\u8bba\u5e26\u5bbd\u8981\u8fdc\u8fdc\u9ad8\u4e8e\u4e3b\u673a\u5185\u5b58\u548c\u8bbe\u5907\u5185\u5b58\u4e4b\u95f4\u7684\u5cf0\u503c\u7406\u8bba\u5e26\u5bbd(\u4f8b\u5982\uff0cNVIDIA Tesla V100\u7684\u5cf0\u503c\u7406\u8bba\u5e26\u5bbd\u4e3a898 GB/s)(\u4f8b\u5982\uff0cPCIe x16 Gen3\u7684\u5cf0\u503c\u7406\u8bba\u5e26\u5bbd\u4e3a16 GB/s)\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u7684\u6574\u4f53\u5e94\u7528\u7a0b\u5e8f\u6027\u80fd\uff0c\u6700\u5c0f\u5316\u4e3b\u673a\u548c\u8bbe\u5907\u4e4b\u95f4\u7684\u6570\u636e\u4f20\u8f93\u662f\u5f88\u91cd\u8981\u7684\uff0c\u5373\u4f7f\u8fd9\u610f\u5473\u7740\u5728GPU\u4e0a\u8fd0\u884c\u5185\u6838\u4e0e\u5728\u4e3b\u673aCPU\u4e0a\u8fd0\u884c\u5185\u6838\u76f8\u6bd4\u6ca1\u6709\u4efb\u4f55\u52a0\u901f\u3002</p> <p>\u4e2d\u95f4\u6570\u636e\u7ed3\u6784\u5e94\u8be5\u5728\u8bbe\u5907\u5185\u5b58\u4e2d\u521b\u5efa\uff0c\u7531\u8bbe\u5907\u64cd\u4f5c\uff0c\u5e76\u4e14\u5728\u6ca1\u6709\u88ab\u4e3b\u673a\u6620\u5c04\u6216\u590d\u5236\u5230\u4e3b\u673a\u5185\u5b58\u7684\u60c5\u51b5\u4e0b\u9500\u6bc1\u3002</p> <p>\u540c\u6837\uff0c\u7531\u4e8e\u4e0e\u6bcf\u6b21\u4f20\u8f93\u76f8\u5173\u7684\u5f00\u9500\uff0c\u5c06\u8bb8\u591a\u5c0f\u7684\u4f20\u8f93\u6279\u91cf\u6210\u4e00\u4e2a\u8f83\u5927\u7684\u4f20\u8f93\u6bd4\u5355\u72ec\u8fdb\u884c\u6bcf\u4e2a\u4f20\u8f93\u8981\u597d\u5f97\u591a\uff0c\u5373\u4f7f\u8fd9\u6837\u505a\u9700\u8981\u5c06\u5185\u5b58\u7684\u975e\u8fde\u7eed\u533a\u57df\u6253\u5305\u5230\u8fde\u7eed\u7684\u7f13\u51b2\u533a\u4e2d\uff0c\u7136\u540e\u5728\u4f20\u8f93\u4e4b\u540e\u89e3\u5305 \u3002</p> <p>\u6700\u540e\uff0c\u5f53\u4f7f\u7528\u9875\u9762\u9501\u5b9a(\u6216\u56fa\u5b9a)\u5185\u5b58\u65f6\uff0c\u4e3b\u673a\u548c\u8bbe\u5907\u4e4b\u95f4\u53ef\u4ee5\u5b9e\u73b0\u66f4\u9ad8\u7684\u5e26\u5bbd\uff0c\u5982CUDA c++\u7f16\u7a0b\u6307\u5357\u548c\u672c\u6587\u6863\u7684\u56fa\u5b9a\u5185\u5b58\u90e8\u5206\u6240\u8ff0\u3002</p> <p>\u9875\u9762\u9501\u5b9a\u6216\u56fa\u5b9a\u7684\u5185\u5b58\u4f20\u8f93\u53ef\u4ee5\u5728\u4e3b\u673a\u548c\u8bbe\u5907\u4e4b\u95f4\u5b9e\u73b0\u6700\u9ad8\u7684\u5e26\u5bbd\u3002\u4f8b\u5982\uff0c\u5728PCIe x16 Gen3\u5361\u4e0a\uff0c\u56fa\u5b9a\u5185\u5b58\u53ef\u4ee5\u8fbe\u5230\u5927\u7ea612 GB/s\u7684\u4f20\u8f93\u901f\u7387\u3002</p> <p>\u4f7f\u7528\u8fd0\u884c\u65f6API\u4e2d\u7684<code>cudaHostAlloc()</code>\u51fd\u6570\u5206\u914d\u56fa\u5b9a\u5185\u5b58\u3002bandwidthTest CUDA\u793a\u4f8b\u5c55\u793a\u4e86\u5982\u4f55\u4f7f\u7528\u8fd9\u4e9b\u51fd\u6570\u4ee5\u53ca\u5982\u4f55\u6d4b\u91cf\u5185\u5b58\u4f20\u8f93\u6027\u80fd\u3002</p> <p>\u5bf9\u4e8e\u5df2\u7ecf\u9884\u5148\u5206\u914d\u7684\u7cfb\u7edf\u5185\u5b58\u533a\u57df\uff0c\u53ef\u4ee5\u4f7f\u7528<code>cudaHostRegister()</code>\u52a8\u6001\u5730\u56fa\u5b9a\u5185\u5b58\uff0c\u800c\u4e0d\u9700\u8981\u5206\u914d\u5355\u72ec\u7684\u7f13\u51b2\u533a\u5e76\u5c06\u6570\u636e\u590d\u5236\u5230\u5176\u4e2d\u3002</p> <p>\u56fa\u5b9a\u5185\u5b58\u4e0d\u5e94\u8be5\u88ab\u8fc7\u5ea6\u4f7f\u7528\u3002\u8fc7\u5ea6\u4f7f\u7528\u4f1a\u964d\u4f4e\u6574\u4e2a\u7cfb\u7edf\u7684\u6027\u80fd\uff0c\u56e0\u4e3a\u56fa\u5b9a\u5185\u5b58\u662f\u4e00\u79cd\u7a00\u7f3a\u7684\u8d44\u6e90\uff0c\u4f46\u662f\u591a\u5c11\u5185\u5b58\u662f\u592a\u591a\u5f88\u96be\u63d0\u524d\u77e5\u9053\u3002\u6b64\u5916\uff0c\u4e0e\u5927\u591a\u6570\u6b63\u5e38\u7684\u7cfb\u7edf\u5185\u5b58\u5206\u914d\u76f8\u6bd4\uff0c\u7cfb\u7edf\u5185\u5b58\u7684\u56fa\u5b9a\u662f\u4e00\u4e2a\u91cd\u91cf\u7ea7\u64cd\u4f5c\uff0c\u56e0\u6b64\uff0c\u5bf9\u4e8e\u6240\u6709\u4f18\u5316\uff0c\u90fd\u8981\u6d4b\u8bd5\u5e94\u7528\u7a0b\u5e8f\u548c\u5b83\u6240\u8fd0\u884c\u7684\u7cfb\u7edf\uff0c\u4ee5\u83b7\u5f97\u6700\u4f73\u6027\u80fd\u53c2\u6570\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#912","title":"9.1.2 \u8ba1\u7b97\u4e0e\u5185\u5b58\u4f20\u8f93\u7684\u5f02\u6b65\u548c\u91cd\u53e0","text":"<p>\u4f7f\u7528cudaMemcpy()\u5728\u4e3b\u673a\u548c\u8bbe\u5907\u4e4b\u95f4\u8fdb\u884c\u7684\u6570\u636e\u4f20\u8f93\u963b\u6b62\u4e86\u4f20\u8f93\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c\u4ec5\u5728\u6570\u636e\u4f20\u8f93\u5b8c\u6210\u540e\uff0c\u63a7\u5236\u6743\u624d\u8fd4\u56de\u7ed9\u4e3b\u673a\u7ebf\u7a0b\u3002 cudaMemcpyAsync()\u51fd\u6570\u662fcudaMemcpy()\u7684\u975e\u963b\u585e\u53d8\u4f53\uff0c\u5728\u8be5\u53d8\u4f53\u4e2d\uff0c\u63a7\u5236\u6743\u7acb\u5373\u8fd4\u56de\u7ed9\u4e3b\u673a\u7ebf\u7a0b\u3002 \u4e0ecudaMemcpy()\u76f8\u6bd4\uff0c\u5f02\u6b65\u4f20\u8f93\u7248\u672c\u9700\u8981\u56fa\u5b9a\u7684\u4e3b\u673a\u5185\u5b58\uff08\u8bf7\u53c2\u89c1\u56fa\u5b9a\u7684\u5185\u5b58\uff09\uff0c\u5e76\u4e14\u5b83\u5305\u542b\u4e00\u4e2a\u9644\u52a0\u53c2\u6570\uff0c\u5373\u6d41ID\u3002 \u6d41\u53ea\u662f\u5728\u8bbe\u5907\u4e0a\u6309\u987a\u5e8f\u6267\u884c\u7684\u4e00\u7cfb\u5217\u64cd\u4f5c\u3002 \u4e0d\u540c\u6d41\u4e2d\u7684\u64cd\u4f5c\u53ef\u4ee5\u4ea4\u9519\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u53ef\u4ee5\u91cd\u53e0-\u8be5\u5c5e\u6027\u53ef\u7528\u4e8e\u9690\u85cf\u4e3b\u673a\u4e0e\u8bbe\u5907\u4e4b\u95f4\u7684\u6570\u636e\u4f20\u8f93\u3002</p> <p>\u5f02\u6b65\u4f20\u8f93\u4ee5\u4e24\u79cd\u4e0d\u540c\u7684\u65b9\u5f0f\u4f7f\u6570\u636e\u4f20\u8f93\u4e0e\u8ba1\u7b97\u91cd\u53e0\u3002\u5728\u6240\u6709\u652f\u6301cuda\u7684\u8bbe\u5907\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7\u5f02\u6b65\u6570\u636e\u4f20\u8f93\u548c\u8bbe\u5907\u8ba1\u7b97\u6765\u91cd\u53e0\u4e3b\u673a\u8ba1\u7b97\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u4ee3\u7801\u5c55\u793a\u4e86\u5728\u5c06\u6570\u636e\u4f20\u8f93\u5230\u8bbe\u5907\u548c\u6267\u884c\u4f7f\u7528\u8bbe\u5907\u7684\u5185\u6838\u65f6\uff0c\u5982\u4f55\u6267\u884c\u4f8b\u7a0bcpuFunction()\u4e2d\u7684\u4e3b\u673a\u8ba1\u7b97\u3002</p> <pre><code>// \u91cd\u53e0\u8ba1\u7b97\u548c\u6570\u636e\u4f20\u8f93\ncudaMemcpyAsync(a_d, a_h, size, cudaMemcpyHostToDevice, 0);\nkernel&lt;&lt;&lt;grid, block&gt;&gt;&gt;(a_d);\ncpuFunction();\n</code></pre> <p>cudaMemcpyAsync()\u51fd\u6570\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u662f\u6d41ID\uff0c\u5728\u672c\u4f8b\u4e2d\u5b83\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\uff0c\u6d410\u3002 kernel\u4e5f\u4f7f\u7528\u9ed8\u8ba4\u7684\u6d41\uff0c\u76f4\u5230\u5185\u5b58\u62f7\u8d1d\u5b8c\u6210\u624d\u4f1a\u5f00\u59cb\u6267\u884c;\u56e0\u6b64\uff0c\u4e0d\u9700\u8981\u663e\u5f0f\u540c\u6b65\u3002 \u56e0\u4e3a\u5185\u5b58\u526f\u672c\u548c\u5185\u6838\u90fd\u7acb\u5373\u5c06\u63a7\u5236\u6743\u8fd4\u56de\u7ed9\u4e3b\u673a\uff0c\u6240\u4ee5\u4e3b\u673a\u51fd\u6570cpuFunction()\u4f1a\u4e0e\u5b83\u4eec\u7684\u6267\u884c\u91cd\u53e0\u3002</p> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u5185\u5b58\u590d\u5236\u548c\u5185\u6838\u6267\u884c\u662f\u987a\u5e8f\u8fdb\u884c\u7684\u3002\u5728\u80fd\u591f\u5e76\u53d1\u590d\u5236\u548c\u8ba1\u7b97\u7684\u8bbe\u5907\u4e0a\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e3b\u673a\u548c\u8bbe\u5907\u4e4b\u95f4\u7684\u6570\u636e\u4f20\u8f93\u6765\u91cd\u53e0\u8bbe\u5907\u4e0a\u7684\u5185\u6838\u6267\u884c\u3002\u8bbe\u5907\u662f\u5426\u5177\u6709\u6b64\u529f\u80fd\u7531cudaDeviceProp\u7ed3\u6784\u7684asyncEngineCount\u5b57\u6bb5\u8868\u793a(\u6216\u5728\u8bbe\u5907\u8bbe\u5907CUDA\u793a\u4f8b\u7684\u8f93\u51fa\u4e2d\u5217\u51fa)\u3002\u5728\u5177\u6709\u6b64\u529f\u80fd\u7684\u8bbe\u5907\u4e0a\uff0c\u91cd\u53e0\u518d\u6b21\u9700\u8981\u56fa\u5b9a\u7684\u4e3b\u673a\u5185\u5b58\uff0c\u6b64\u5916\uff0c\u6570\u636e\u4f20\u8f93\u548c\u5185\u6838\u5fc5\u987b\u4f7f\u7528\u4e0d\u540c\u7684\u975e\u9ed8\u8ba4\u6d41(\u5177\u6709\u975e\u96f6\u6d41id\u7684\u6d41)\u3002\u8fd9\u79cd\u91cd\u53e0\u9700\u8981\u975e\u9ed8\u8ba4\u6d41\uff0c\u56e0\u4e3a\u4f7f\u7528\u9ed8\u8ba4\u6d41\u7684\u5185\u5b58\u590d\u5236\u3001\u5185\u5b58\u96c6\u51fd\u6570\u548c\u5185\u6838\u8c03\u7528\u53ea\u6709\u5728\u8bbe\u5907\u4e0a\u7684\u6240\u6709\u524d\u9762\u8c03\u7528(\u5728\u4efb\u4f55\u6d41\u4e2d)\u5b8c\u6210\u4e4b\u540e\u624d\u4f1a\u5f00\u59cb\uff0c\u800c\u4e14\u5728\u8bbe\u5907\u4e0a\u7684\u4efb\u4f55\u64cd\u4f5c(\u5728\u4efb\u4f55\u6d41\u4e2d)\u5728\u5b8c\u6210\u4e4b\u524d\u90fd\u4e0d\u4f1a\u5f00\u59cb\u3002</p> <pre><code>// \u5e76\u53d1\u590d\u5236\u548c\u6267\u884c\ncudaStreamCreate(&amp;stream1);\ncudaStreamCreate(&amp;stream2);\ncudaMemcpyAsync(a_d, a_h, size, cudaMemcpyHostToDevice, stream1);\nkernel&lt;&lt;&lt;grid, block, 0, stream2&gt;&gt;&gt;(otherData_d);\n</code></pre> <p>\u5728\u8fd9\u6bb5\u4ee3\u7801\u4e2d\uff0c\u6839\u636ecudaMemcpyAsync\u8c03\u7528\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u548c\u5185\u6838\u7684\u6267\u884c\u914d\u7f6e\uff0c\u521b\u5efa\u5e76\u5728\u6570\u636e\u4f20\u8f93\u548c\u5185\u6838\u6267\u884c\u4e2d\u4f7f\u7528\u4e24\u4e2a\u6d41\u3002</p> <pre><code>// \u5206\u9636\u6bb5\u590d\u5236\u548c\u6267\u884c\uff08Staged concurrent copy and execute\uff09\nsize=N*sizeof(float)/nStreams;\nfor (i=0; i&lt;nStreams; i++) {\n    offset = i*N/nStreams;\n    cudaMemcpyAsync(a_d+offset, a_h+offset, size, dir, stream[i]);\n    kernel&lt;&lt;&lt;N/(nThreads*nStreams), nThreads, 0,  \n             stream[i]&gt;&gt;&gt;(a_d+offset);\n}\n</code></pre> <p>\u8fd9\u6bb5\u4ee3\u7801\u5047\u8bbeN\u53ef\u4ee5\u88abnThreads * nStreams\u6574\u9664\u3002\u56e0\u4e3a\u6d41\u4e2d\u7684\u6267\u884c\u662f\u987a\u5e8f\u8fdb\u884c\u7684\uff0c\u6240\u4ee5\u5728\u5b83\u4eec\u5404\u81ea\u7684\u6d41\u4e2d\u7684\u6570\u636e\u4f20\u8f93\u5b8c\u6210\u4e4b\u524d\uff0c\u6ca1\u6709\u4e00\u4e2a\u5185\u6838\u4f1a\u542f\u52a8\u3002\u5f53\u524d\u7684gpu\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u5f02\u6b65\u6570\u636e\u4f20\u8f93\u548c\u6267\u884c\u5185\u6838\u3002</p> <p>\u56fe1 \u5185\u5b58\u590d\u5236\u548ckernel\u6267\u884c\u7684\u65f6\u95f4\u7ebf\u6bd4\u8f83</p> <p></p> <p>\u4e0a\u65b9\uff1a\u987a\u5e8f\uff08Sequential\uff09 \u4e0b\u65b9\uff1a\u5e76\u53d1\uff08Concurrent\uff09</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#913-zero-copy","title":"9.1.3 \u96f6\u62f7\u8d1d\u5185\u5b58\uff08Zero Copy\uff09","text":"<p>\u96f6\u62f7\u8d1d\u662fCUDA Toolkit v2.2\u53ca\u4ee5\u4e0a\u7248\u672c\u4e2d\u589e\u52a0\u7684\u4e00\u4e2a\u529f\u80fd\u3002\u5b83\u5141\u8bb8GPU\u7ebf\u7a0b\u76f4\u63a5\u8bbf\u95ee\u4e3b\u673a\u5185\u5b58\u3002\u4e3a\u6b64\uff0c\u5b83\u9700\u8981\u6620\u5c04\u56fa\u5b9a(\u975e\u5206\u9875)\u5185\u5b58\u3002\u5728\u96c6\u6210\u7684gpu\u4e0a(\u5373\u5f53CUDA\u8bbe\u5907\u5c5e\u6027\u7ed3\u6784\u7684\u96c6\u6210\u5b57\u6bb5\u88ab\u8bbe\u7f6e\u4e3a1)\u65f6\uff0c\u6620\u5c04\u56fa\u5b9a\u5185\u5b58\u603b\u662f\u4e00\u4e2a\u6027\u80fd\u589e\u76ca\uff0c\u56e0\u4e3a\u5b83\u907f\u514d\u4e86\u591a\u4f59\u7684\u62f7\u8d1d\uff0c\u56e0\u4e3a\u96c6\u6210\u7684GPU\u548cCPU\u5185\u5b58\u5728\u7269\u7406\u4e0a\u662f\u76f8\u540c\u7684\u3002\u5728\u72ec\u7acb\u7684gpu\u4e0a\uff0c\u6620\u5c04\u56fa\u5b9a\u5185\u5b58\u53ea\u6709\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\u624d\u6709\u4f18\u52bf\u3002\u7531\u4e8e\u6570\u636e\u4e0d\u662f\u7f13\u5b58\u5728GPU\u4e0a\uff0c\u6620\u5c04\u7684\u56fa\u5b9a\u5185\u5b58\u5e94\u8be5\u53ea\u88ab\u8bfb\u5199\u4e00\u6b21\uff0c\u8bfb\u5199\u5185\u5b58\u7684\u5168\u5c40\u52a0\u8f7d\u548c\u5b58\u50a8\u5e94\u8be5\u88ab\u5408\u5e76\u3002\u96f6\u62f7\u8d1d\u53ef\u4ee5\u7528\u6765\u4ee3\u66ff\u6d41\uff0c\u56e0\u4e3a\u6e90\u4e8e\u5185\u6838\u7684\u6570\u636e\u4f20\u8f93\u4f1a\u81ea\u52a8\u91cd\u53e0\u5185\u6838\u6267\u884c\uff0c\u800c\u65e0\u9700\u8bbe\u7f6e\u548c\u786e\u5b9a\u6d41\u7684\u6700\u4f73\u6570\u91cf\u3002</p> <pre><code>// \u96f6\u62f7\u8d1d\u5185\u5b58\u4e3b\u673a\u4ee3\u7801\nfloat *a_h, *a_map;\n...\ncudaGetDeviceProperties(&amp;prop, 0);\nif (!prop.canMapHostMemory) \n    exit(0);\ncudaSetDeviceFlags(cudaDeviceMapHost);\ncudaHostAlloc(&amp;a_h, nBytes, cudaHostAllocMapped);\ncudaHostGetDevicePointer(&amp;a_map, a_h, 0);\nkernel&lt;&lt;&lt;gridSize, blockSize&gt;&gt;&gt;(a_map);\n</code></pre> <p>\u5728\u8fd9\u6bb5\u4ee3\u7801\u4e2d\uff0c<code>cudaGetDeviceProperties()</code>\u8fd4\u56de\u7684\u7ed3\u6784\u7684<code>canMapHostMemory</code>\u5b57\u6bb5\u7528\u4e8e\u68c0\u67e5\u8bbe\u5907\u662f\u5426\u652f\u6301\u5c06\u4e3b\u673a\u5185\u5b58\u6620\u5c04\u5230\u8bbe\u5907\u7684\u5730\u5740\u7a7a\u95f4\u3002\u901a\u8fc7\u4f7f\u7528<code>cudaDeviceMapHost</code>\u8c03\u7528<code>cudaSetDeviceFlags()</code>\u6765\u542f\u7528\u9875\u9762\u9501\u5b9a\u5185\u5b58\u6620\u5c04\u3002\u6ce8\u610f\uff0c<code>cudaSetDeviceFlags()</code>\u5fc5\u987b\u5728\u8bbe\u7f6e\u8bbe\u5907\u6216\u8fdb\u884c\u9700\u8981\u72b6\u6001\u7684CUDA\u8c03\u7528\u4e4b\u524d\u8c03\u7528(\u672c\u8d28\u4e0a\u662f\u5728\u521b\u5efa\u4e0a\u4e0b\u6587\u4e4b\u524d)\u3002\u4f7f\u7528<code>cudaHostAlloc()</code>\u5206\u914d\u9875\u9762\u9501\u5b9a\u7684\u6620\u5c04\u4e3b\u673a\u5185\u5b58\uff0c\u5e76\u901a\u8fc7\u51fd\u6570<code>cudaHostGetDevicePointer()</code>\u83b7\u5f97\u6307\u5411\u6620\u5c04\u8bbe\u5907\u5730\u5740\u7a7a\u95f4\u7684\u6307\u9488\u3002\u5728\u96f6\u62f7\u8d1d\u4e3b\u673a\u4ee3\u7801\u4e2d\u7684\u4ee3\u7801\u4e2d\uff0ckernel()\u53ef\u4ee5\u4f7f\u7528\u6307\u9488<code>a_map</code>\u5f15\u7528\u88ab\u6620\u5c04\u7684\u56fa\u5b9a\u4e3b\u673a\u5185\u5b58\uff0c\u8fd9\u4e0ea_map\u5f15\u7528\u8bbe\u5907\u5185\u5b58\u4e2d\u7684\u4f4d\u7f6e\u662f\u5b8c\u5168\u4e00\u6837\u7684\u3002</p> <p>\u6ce8\u610f:\u6620\u5c04\u56fa\u5b9a\u4e3b\u673a\u5185\u5b58\u5141\u8bb8CPU-GPU\u7684\u5185\u5b58\u4f20\u8f93\u4e0e\u8ba1\u7b97\u91cd\u53e0\uff0c\u540c\u65f6\u907f\u514d\u4f7f\u7528CUDA\u6d41\u3002\u4f46\u662f\uff0c\u7531\u4e8e\u5bf9\u8fd9\u4e9b\u5185\u5b58\u533a\u57df\u7684\u4efb\u4f55\u91cd\u590d\u8bbf\u95ee\u90fd\u4f1a\u5bfc\u81f4CPU-GPU\u4e4b\u95f4\u7684\u91cd\u590d\u4f20\u8f93\uff0c\u56e0\u6b64\u53ef\u4ee5\u8003\u8651\u5728\u8bbe\u5907\u5185\u5b58\u4e2d\u521b\u5efa\u7b2c\u4e8c\u4e2a\u533a\u57df\u6765\u624b\u52a8\u7f13\u5b58\u4e4b\u524d\u8bfb\u53d6\u7684\u4e3b\u673a\u5185\u5b58\u6570\u636e\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#92","title":"9.2 \u8bbe\u5907\u5185\u5b58\u7a7a\u95f4","text":"<p>\u56fe2 \u8bbe\u5907\u5185\u5b58\u7a7a\u95f4</p> <p></p> <p>\u5728\u8fd9\u4e9b\u4e0d\u540c\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\uff0c\u5168\u5c40\u5185\u5b58\u662f\u6700\u4e30\u5bcc\u7684\uff1b \u5168\u5c40\u3001\u672c\u5730\uff08Local\uff09\u548c\u7eb9\u7406\u5185\u5b58\u7684\u8bbf\u95ee\u5ef6\u8fdf\u6700\u5927\uff0c\u5176\u6b21\u662f\u5e38\u91cf\u5185\u5b58\u3001\u5171\u4eab\u5185\u5b58\u548c\u5bc4\u5b58\u5668\u6587\u4ef6\u3002 \u5185\u5b58\u5ef6\u8fdf\uff1aGlobal &gt; Local &gt; Texture &gt;&gt; Constant &gt; Shared &gt; Register</p> <p>\u8bbe\u5907\u4e2d\u7684GPU\u7684\u8ba1\u7b97\u80fd\u529b\u53ef\u4ee5\u901a\u8fc7\u7f16\u7a0b\u6765\u67e5\u8be2\uff0c\u5982deviceQuery CUDA\u793a\u4f8b\u6240\u793a\u3002\u8be5\u7a0b\u5e8f\u7684\u8f93\u51fa\u5982\u56fe11\u6240\u793a\u3002\u8be5\u4fe1\u606f\u662f\u901a\u8fc7\u8c03\u7528cudaGetDeviceProperties()\u5e76\u8bbf\u95ee\u5b83\u8fd4\u56de\u7684\u7ed3\u6784\u4e2d\u7684\u4fe1\u606f\u83b7\u5f97\u7684\u3002 \u89c1 CUDA Compute Capacity\u3002</p> <p>\u88689-1 \u8bbe\u5907\u5185\u5b58\u7684\u663e\u8457\u7279\u5f81</p> Memory Location on/off chip Cached Access Scope Lifetime Register On n/a R/W 1 thread Thread Local Off Yes\u2020\u2020 R/W 1 thread Thread Shared On n/a R/W All threads in block Block Global Off \u2020 R/W All threads + host Host allocation Constant Off Yes R All threads + host Host allocation Texture Off Yes R All threads + host Host allocation <p>\u2020 \u5728\u8ba1\u7b97\u80fd\u529b6.0\u548c7.x\u7684\u8bbe\u5907\u4e0a\u9ed8\u8ba4\u7f13\u5b58\u5728L1\u548cL2\u4e2d\uff1b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728\u8ba1\u7b97\u80fd\u529b\u8f83\u4f4e\u7684\u8bbe\u5907\u4e0a\uff0c\u53ea\u5728L2\u4e2d\u7f13\u5b58\uff0c\u4f46\u6709\u4e9b\u8bbe\u5907\u5141\u8bb8\u901a\u8fc7\u53ef\u9009\u7684\u7f16\u8bd1\u6807\u5fd7\u5728L1\u4e2d\u8fdb\u884c\u7f13\u5b58\u3002</p> <p>\u2020\u2020 \u9ed8\u8ba4\u7f13\u5b58\u5728L1\u548cL2\u4e2d\uff0c\u4f46\u8ba1\u7b97\u80fd\u529b\u4e3a5.x\u7684\u8bbe\u5907\u9664\u5916\uff1b5.x\u8ba1\u7b97\u80fd\u529b\u4ec5\u5728L2\u4e2d\u7f13\u5b58\u5c40\u90e8\u53d8\u91cf\u3002</p> <p>\u5728\u7eb9\u7406\u8bbf\u95ee\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u4e00\u4e2a\u7eb9\u7406\u5f15\u7528\u88ab\u7ed1\u5b9a\u5230\u5168\u5c40\u5185\u5b58\u4e2d\u7684\u4e00\u4e2a\u7ebf\u6027\u6570\u7ec4\uff0c\u90a3\u4e48\u8bbe\u5907\u4ee3\u7801\u53ef\u4ee5\u5199\u5165\u5e95\u5c42\u6570\u7ec4\u3002 \u7ed1\u5b9a\u5230CUDA\u6570\u7ec4\u7684\u7eb9\u7406\u5f15\u7528\u53ef\u4ee5\u901a\u8fc7\u7ed1\u5b9a\u4e00\u4e2a\u8868\u9762\u5230\u76f8\u540c\u7684\u5e95\u5c42CUDA\u6570\u7ec4\u5b58\u50a8\u7684\u8868\u9762\u5199\u5165\u64cd\u4f5c\uff08surface-writes\uff09\u5199\u5165\u5230CUDA\u6570\u7ec4)\u3002 \u5e94\u8be5\u907f\u514d\u5728\u540c\u4e00\u5185\u6838\u542f\u52a8\u4e2d\u4ece\u7eb9\u7406\u8bfb\u53d6\u6570\u636e\u540c\u65f6\u5199\u5165\u5176\u5e95\u5c42\u5168\u5c40\u5185\u5b58\u6570\u7ec4\uff0c\u56e0\u4e3a\u7eb9\u7406\u7f13\u5b58\u662f\u53ea\u8bfb\u7684\uff0c\u5e76\u4e14\u5728\u4fee\u6539\u5173\u8054\u7684\u5168\u5c40\u5185\u5b58\u65f6\u4e0d\u4f1a\u5931\u6548\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#921-coalesced-access-to-global-memory","title":"9.2.1 \u5168\u5c40\u5185\u5b58\u7684\u5408\u5e76\u8bbf\u95ee\uff08Coalesced Access to Global Memory\uff09","text":"<p>\u5728\u5bf9\u5177\u6709CUDA\u529f\u80fd\u7684GPU\u67b6\u6784\u8fdb\u884c\u7f16\u7a0b\u65f6\uff0c\u975e\u5e38\u91cd\u8981\u7684\u6027\u80fd\u8003\u8651\u56e0\u7d20\u662f\u5408\u5e76\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\u3002\u8bbe\u5907\u5c06warp\u7684\u5168\u5c40\u5185\u5b58\u52a0\u8f7d\u548c\u5b58\u50a8\u5408\u5e76\u5230\u5c3d\u53ef\u80fd\u5c11\u7684\u4e8b\u52a1\u4e2d\u3002</p> <p>\u8ba1\u7b97\u80fd\u529b6.0\u53ca\u4ee5\u4e0a\uff0c\u4e00\u4e2awarp\u4e2d\u7684\u7ebf\u7a0b\u7684\u5e76\u53d1\u8bbf\u95ee\u5c06\u5408\u5e76\u4e3a\u591a\u4e2a\u4e8b\u52a1\uff0c\u8be5\u4e8b\u52a1\u6570\u91cf\u7b49\u4e8e\u4e3awarp\u7684\u6240\u6709\u7ebf\u7a0b\u63d0\u4f9b\u670d\u52a1\u6240\u9700\u768432\u5b57\u8282\u4e8b\u52a1\uff0832-byte transactions\uff09\u6570\u3002</p> <p>\u6ce8\u610f\uff1a\u5728\u8ba1\u7b97\u80fd\u529b\u4e3a6.0\u6216\u66f4\u9ad8\u7684\u8bbe\u5907\u4e0a\uff0c\u9ed8\u8ba4\u8bbe\u7f6e\u4e3aL1\u7f13\u5b58\uff0c\u4f46\u662f\u65e0\u8bba\u662f\u5426\u5c06\u5168\u5c40\u8d1f\u8f7d\u7f13\u5b58\u5728L1\u4e2d\uff0c\u6570\u636e\u8bbf\u95ee\u5355\u5143\u5747\u4e3a32\u5b57\u8282\u3002</p> <p>\u5bf9\u4e8e\u67d0\u4e9b\u8ba1\u7b97\u80fd\u529b\u4e3a3.5\u30013.7\u548c5.2\u7684\u8bbe\u5907\uff0c\u53ef\u4ee5\u9009\u62e9\u542f\u7528\u5bf9\u5168\u5c40\u5185\u5b58\u7684\u8bbf\u95ee\u7684L1\u7f13\u5b58\u3002 \u5982\u679c\u5728\u8fd9\u4e9b\u8bbe\u5907\u4e0a\u542f\u7528\u4e86L1\u7f13\u5b58\uff0c\u5219\u6240\u9700\u7684\u4e8b\u52a1\u6570\u7b49\u4e8e\u6240\u9700\u7684128\u5b57\u8282\u5bf9\u9f50\u6bb5\uff08128-byte aligned segments\uff09\u7684\u6570\u76ee\u3002</p> <p>\u5728\u5177\u6709GDDR\u5185\u5b58\u7684\u8bbe\u5907\u4e0a\uff0c\u6253\u5f00ECC\u65f6\uff0c\u4ee5\u5408\u5e76\u65b9\u5f0f\u8bbf\u95ee\u5185\u5b58\u5c24\u4e3a\u91cd\u8981\u3002 \u5206\u6563\u7684\u8bbf\u95ee\u4f1a\u589e\u52a0ECC\u5185\u5b58\u4f20\u8f93\u5f00\u9500\uff0c\u5c24\u5176\u662f\u5728\u5c06\u6570\u636e\u5199\u5165\u5168\u5c40\u5185\u5b58\u65f6\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u5047\u5b9a\u8ba1\u7b97\u80fd\u529b\u4e3a6.0\u6216\u66f4\u9ad8\uff0c\u5e76\u4e14\u9664\u975e\u53e6\u6709\u8bf4\u660e\uff0c\u5426\u5219\u8bbf\u95ee\u9488\u5bf94\u5b57\u8282\u7684\u5b57\uff084-byte words\uff09\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#9211","title":"9.2.1.1 \u7b80\u5355\u8bbf\u95ee\u6a21\u5f0f","text":"<p>\u7b2ck\u4e2a\u7ebf\u7a0b\u8bbf\u95ee32\u5b57\u8282\u5bf9\u9f50\u6570\u7ec4\u4e2d\u7684\u7b2ck\u4e2a\u5b57\u3002</p> <p>\u4f8b\u5982\uff0c\u5982\u679cwarp\u7684\u7ebf\u7a0b\u8bbf\u95ee\u76f8\u90bb\u76844\u5b57\u8282\u5b57\uff084-byte words\uff0c\u4f8b\u5982\uff0c\u76f8\u90bb\u7684float\u503c\uff09\uff0c\u5219\u56db\u4e2a\u5408\u5e76\u768432\u5b57\u8282\u4e8b\u52a1\u5c06\u4e3a\u8be5\u5185\u5b58\u8bbf\u95ee\u63d0\u4f9b\u670d\u52a1\u3002\u8fd9\u79cd\u6a21\u5f0f\u5982\u56fe3\u6240\u793a\u3002</p> <p>\u56fe3 \u5408\u5e76\u8bbf\u95ee</p> <p></p> <p>\u6b64\u8bbf\u95ee\u6a21\u5f0f\u5bfc\u81f4\u56db\u4e2a32\u5b57\u8282\u4e8b\u52a1\uff0c\u7528\u7ea2\u8272\u77e9\u5f62\u8868\u793a\u3002 warpSize * 4 bytes = 128 bytes\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2awarp\u4e2d\u6bcf\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u4e00\u4e2afloat\uff0c\u90a3\u4e48\u603b\u5171\u9700\u8981128 bytes\uff0c\u5408\u5e76\u8bbf\u95ee4\u6b21\uff0c\u6bcf\u6b2132 bytes\u3002</p> <p>\u5373\u4f7f\u4ece\u56db\u4e2a32\u5b57\u8282\u6bb5\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u4e2d\uff0c\u53ea\u662f\u8bf7\u6c42\u5355\u8bcd\u7684\u5b50\u96c6\uff08\u4f8b\u5982\uff0c\u5982\u679c\u591a\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u4e86\u540c\u4e00\u4e2a\u5355\u8bcd\uff0c\u6216\u8005\u67d0\u4e9b\u7ebf\u7a0b\u672a\u53c2\u4e0e\u8bbf\u95ee\uff09\uff0c\u90fd\u5c06\u83b7\u53d6\u5b8c\u6574\u7684\u6bb5\u3002</p> <p>\u6b64\u5916\uff0c\u5982\u679cwarp\u7ebf\u7a0b\u7684\u8bbf\u95ee\u5df2\u5728\u56db\u4e2a\u6bb5\u5185\u6216\u8de8\u56db\u4e2a\u6bb5\u8fdb\u884c\u4e86\u7f6e\u6362\uff0c\u90a3\u4e48\u5177\u67096.0\u6216\u66f4\u9ad8\u8ba1\u7b97\u80fd\u529b\u7684\u8bbe\u5907\u4ecd\u5c06\u4ec5\u6267\u884c\u56db\u4e2a32\u5b57\u8282\u4e8b\u52a1\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#9212","title":"9.2.1.2 \u987a\u5e8f\u4f46\u672a\u5bf9\u9f50\u7684\u8bbf\u95ee\u6a21\u5f0f","text":"<p>\u5982\u679cwarp\u4e2d\u7684\u987a\u5e8f\u7ebf\u7a0b\u8bbf\u95ee\u7684\u662f\u987a\u5e8f\u4f46\u662f\u6ca1\u6709\u4ee532\u5b57\u8282\u6bb5\u5bf9\u9f50\u7684\u5185\u5b58\uff0c\u90a3\u4e48\u5c06\u8bf7\u6c42\u4e94\u4e2a32\u5b57\u8282\u6bb5\uff0c\u5982\u56fe4\u6240\u793a\u3002</p> <p>\u56fe4 \u672a\u5bf9\u9f50\u7684\u987a\u5e8f\u5730\u5740\u5c06\u5bfc\u81f4\u4e94\u4e2a32\u5b57\u8282\u6bb5 </p> <p></p> <p>CUDA Runtime API\u7684\u5185\u5b58\u5206\u914d\uff08\u4f8b\u5982\u901a\u8fc7<code>cudaMalloc()</code>\uff09\u4fdd\u8bc1\u81f3\u5c11256-byte\u5bf9\u9f50\u3002 \u56e0\u6b64\uff0c\u9009\u62e9\u5408\u9002\u7684thread-block\u5927\u5c0f\uff0c\u4f8b\u5982\u4e3awarpSize\u7684\u500d\u6570\uff0c\u53ef\u4ee5\u4fc3\u8fdbwarp\u7684\u5185\u5b58\u8bbf\u95ee\u88ab\u5408\u9002\u5730\u5bf9\u9f50\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#9213","title":"9.2.1.3 \u672a\u5bf9\u9f50\u8bbf\u95ee\u7684\u5f71\u54cd","text":"<p><pre><code>// \u4e00\u4e2a\u590d\u5236\u529f\u80fd\u7684kernel\uff0c\u672a\u5bf9\u9f50\u8bbf\u95ee\n__global__ void offsetCopy(float *odata, float* idata, int offset)\n{\n    int xid = blockIdx.x * blockDim.x + threadIdx.x + offset;\n    odata[xid] = idata[xid];\n}\n</code></pre> \u8fd9\u4e2akernel\u7684\u529f\u80fd\u662f\uff0c\u4eceidata\u5c06\u6570\u636e\u590d\u5236\u5230odata\u8f93\u51fa\u6570\u7ec4\u4e2d\uff0cidata\u548codata\u6570\u7ec4\u90fd\u662f\u4f4d\u4e8e\u5168\u5c40\u5185\u5b58\u4e2d\u3002 \u5728\u4e3b\u673a\u4e2d\uff0ckernel\u4f4d\u4e8eoffset\u4ece0\u523032\u7684\u4e00\u4e2a\u5faa\u73af\u4e2d\u88ab\u8c03\u7528\u6267\u884c\uff08\u4f8b\u5982\u56fe4\u5bf9\u5e94\u4e86\u8fd9\u79cd\u672a\u5bf9\u9f50\uff09\u3002\u56fe5\u5c55\u793a\u4e86\u4e0d\u540coffset\u5185\u5b58\u590d\u5236\u7684\u6709\u6548\u5e26\u5bbd\u3002</p> <p>\u56fe5 offsetCopy kernel\u7684\u6027\u80fd</p> <p></p> <p>\u5bf9\u4e8eNVIDIA Tesla V100 (compute capability 7.0)\uff0c\u4e0d\u5e26\u504f\u79fb\u91cf\u6216\u504f\u79fb\u91cf\u4e3a8\u4e2a\u5b57\u7684\u500d\u6570\u7684\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\u5c06\u5bfc\u81f4\u56db\u4e2a32\u5b57\u8282\u4e8b\u52a1\u3002\u8fbe\u5230\u7684\u5e26\u5bbd\u7ea6\u4e3a790 GB / s\u3002\u5426\u5219\uff0c\u6bcf\u4e2awarp\u5c06\u52a0\u8f7d\u4e94\u4e2a32\u5b57\u8282\u7684\u6bb5\uff0c\u5e76\u4e14\u6211\u4eec\u671f\u671b\u83b7\u5f97\u5185\u5b58\u541e\u5410\u91cf\u5927\u7ea6\u4e3a\u5176\u65e0\u504f\u79fb\u91cf\u76844/5\u500d\u3002</p> <p>\u7136\u800c\uff0c\u5728\u6b64\u7279\u5b9a\u793a\u4f8b\u4e2d\uff0c\u541e\u5410\u91cf\u7ea6\u4e3a9/10\uff0c\u8fd9\u662f\u56e0\u4e3a\u76f8\u90bb\u7684warp\u91cd\u65b0\u4f7f\u7528\u4e86\u5176\u90bb\u5c45\u83b7\u53d6\u7684\u7f13\u5b58\u884c\uff08cache line\uff0c\u8ba1\u7b97\u80fd\u529b3.x\u7684\u7f13\u5b58\u884c\u5927\u5c0f\u4e3a128\u5b57\u8282\uff08\u5176\u4ed6\u8bbe\u5907\u6ca1\u6709\u63d0\u53ca\uff09\uff0c\u7f13\u5b58\u4f4d\u7f6e\u4e3aL1\u6216L2\uff09\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#9214-strided-accesses","title":"9.2.1.4 \u8de8\u6b65\u8bbf\u95ee\uff08Strided Accesses\uff09","text":"<p>\u5982\u4e0a\u6240\u793a\uff0c\u5728\u987a\u5e8f\u8bbf\u95ee\u672a\u5bf9\u9f50\u7684\u60c5\u51b5\u4e0b\uff0c\u7f13\u5b58\u6709\u52a9\u4e8e\u51cf\u8f7b\u6027\u80fd\u5f71\u54cd\u3002 \u4f46\u662f\uff0c\u975e\u5355\u5143\u8de8\u6b65\uff08non-unit-stride\uff0c\u5373\u6b65\u957f\u8d85\u8fc7\u4e00\u4e2a\u5355\u5143\uff09\u8bbf\u95ee\u53ef\u80fd\u6709\u6240\u4e0d\u540c\uff0c\u8fd9\u662f\u5728\u5904\u7406\u591a\u7ef4\u6570\u636e\u6216\u77e9\u9635\u65f6\u7ecf\u5e38\u53d1\u751f\u7684\u6a21\u5f0f\u3002\u56e0\u6b64\uff0c\u786e\u4fdd\u5b9e\u9645\u4f7f\u7528\u7684\u6bcf\u4e2a\u9ad8\u901f\u7f13\u5b58\u884c\u4e2d\u7684\u6570\u636e\u5c3d\u53ef\u80fd\u591a\u5730\u88ab\u4f7f\u7528\u662f\u8fd9\u4e9b\u8bbe\u5907\u4e0a\u5b58\u50a8\u5668\u8bbf\u95ee\u6027\u80fd\u4f18\u5316\u7684\u91cd\u8981\u90e8\u5206\u3002</p> <p>\u5982\u4e0b\u4ee3\u7801\u8bf4\u660e\u4e86\u8de8\u6b65\u8bbf\u95ee\u5bf9\u6709\u6548\u5e26\u5bbd\u7684\u5f71\u54cd\uff0c\u8be5\u590d\u5236\u5c06\u5177\u6709\u8de8\u6b65\u5143\u7d20\u7684\u8de8\u6b65\u6570\u636e\u4eceidata\u590d\u5236\u5230odata\u3002</p> <pre><code>// \u975e\u5355\u5143\u8de8\u6b65\u6570\u636e\u62f7\u8d1d\n__global__ void strideCopy(float *odata, float* idata, int stride)\n{\n    int xid = (blockIdx.x*blockDim.x + threadIdx.x)*stride;\n    odata[xid] = idata[xid];\n}\n</code></pre> <p>\u56fe6\u8bf4\u660e\u4e86\u8fd9\u79cd\u60c5\u51b5\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2awarp\u4e2d\u7684\u7ebf\u7a0b\u4ee52\u7684\u6b65\u5e45\u8bbf\u95ee\u5185\u5b58\u4e2d\u7684\u5b57\u3002\u6b64\u64cd\u4f5c\u5bfc\u81f4Tesla V100\uff08\u8ba1\u7b97\u80fd\u529b7.0\uff09\u4e0a\u6bcf\u4e2awarp\u52a0\u8f7d\u516b\u4e2aL2\u7f13\u5b58\u6bb5\u3002</p> <p>\u56fe6 \u76f8\u90bb\u7ebf\u7a0b\u4ee52\u7684\u6b65\u957f\u8bbf\u95ee\u5185\u5b58</p> <p></p> <p>\u8de8\u5ea6\u4e3a2\u5bfc\u81f4\u52a0\u8f7d/\u5b58\u50a8\u6548\u7387\uff08load / store efficiency\uff09\u4e3a50\uff05\uff0c\u8fd9\u662f\u56e0\u4e3a\u4e8b\u52a1\u4e2d\u6709\u4e00\u534a\u7684\u5143\u7d20\u6ca1\u6709\u4f7f\u7528\uff0c\u6d6a\u8d39\u4e86\u5e26\u5bbd\u3002\u56e0\u4e3a\u4e00\u6b21\u5185\u5b58\u4e8b\u52a1\u5c06\u4e3awarp\u5185\u7684\u7ebf\u7a0b\u8bfb\u53d6128\u5b57\u8282\uff0832 threads * 4 bytes\uff09\u6570\u636e\uff0c\u4f46\u662fwarp\u5185\u7684\u7ebf\u7a0b\u5374\u53ea\u5f97\u5230\u4e86\u6240\u9700\u6570\u636e\u7684\u4e00\u534a\uff0c\u6240\u4ee5\u4e00\u4e2awarp\u9700\u8981\u4e24\u6b21\u8bbf\u5b58\u4e8b\u52a1\u3002 \u6ce8\uff1aload / store\u4e00\u822c\u662f\u9488\u5bf9\u5185\u5b58\u548c\u5bc4\u5b58\u5668\u4e4b\u95f4\uff0c\u5185\u5b58-&gt;\u5bc4\u5b58\u5668\u4e3aload\uff0c\u5bc4\u5b58\u5668-&gt;\u5185\u5b58\u4e3astore. \u968f\u7740\u6b65\u5e45\u7684\u589e\u52a0\uff0c\u6709\u6548\u5e26\u5bbd\u51cf\u5c0f\uff0c\u76f4\u5230\u4e3a\u4e00\u4e2awarp\u4e2d\u768432\u4e2a\u7ebf\u7a0b\u52a0\u8f7d32\u4e2a32\u4e2a\u5b57\u8282\u7684\u6bb5\u7684\u70b9\u4e3a\u6b62\uff0c\u5982\u56fe7\u6240\u793a\u3002</p> <p>\u56fe7 strideCopy kernel\u7684\u6027\u80fd</p> <p></p> <p>\u5982\u56fe7\u6240\u793a\uff0c\u975e\u5355\u5143\u8de8\u6b65\u7684\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\u4efb\u4f55\u65f6\u5019\u90fd\u5e94\u8be5\u907f\u514d\u3002 \u4e00\u79cd\u907f\u514d\u65b9\u5f0f\u5c31\u662f\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u3002</p> <p>\u5168\u5c40\u5185\u5b58\u5408\u5e76\u8bbf\u95ee\u4ee3\u7801\u793a\u4f8b\uff1a</p> <p>\u5047\u8bbe\u6709\u4e00\u4e2a3x4\u77e9\u9635\uff08int\uff09 <pre><code>0 1 2 3\n4 5 6 7\n8 9 a b\n</code></pre> \u5b9e\u9645\u5185\u5b58\u683c\u5c40\u4e3a\u4e00\u7ef4\u7684\uff1a <pre><code>0 1 2 3 4 5 6 7 8 9 a b\n</code></pre> \u4f60\u67094\u4e2a\u7ebf\u7a0b\uff0c\u90a3\u4e48\u6709\u4ee5\u4e0b\u4e24\u79cd\u8bbf\u95ee\u65b9\u5f0f\uff1a <pre><code>// \u65b9\u5f0f\u4e00\nthread 0:  0, 1, 2\nthread 1:  3, 4, 5\nthread 2:  6, 7, 8\nthread 3:  9, a, b\n\n// \u65b9\u5f0f\u4e8c\nthread 0:  0, 4, 8\nthread 1:  1, 5, 9\nthread 2:  2, 6, a\nthread 3:  3, 7, b\n</code></pre> \u65b9\u5f0f\u4e00\uff1a\u7ebf\u7a0b\u7b2c\u4e00\u6b21\u8bbf\u95ee\u7684\u5206\u522b\u662f<code>0, 3, 6, 9</code>\uff0c\u4e0d\u8fde\u7eed\uff0c\u6240\u4ee5\u6ca1\u6709\u88ab\u5408\u5e76\u8bbf\u95ee\uff1b \u65b9\u5f0f\u4e8c\uff1a\u7ebf\u7a0b\u7b2c\u4e00\u6b21\u8bbf\u95ee\u7684\u5206\u522b\u662f<code>0, 1, 2, 3</code>\uff0c\u8fde\u7eed\uff0c\u4e8e\u662f\u88ab\u5408\u5e76\u8bbf\u95ee\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#_1","title":"\u5168\u5c40\u5185\u5b58\u5408\u5e76\u8bbf\u95ee\u7684\u9644\u52a0\u8bf4\u660e\uff1a","text":"<p>\u7ed3\u6784\u4f53\uff1a</p> <p>\u5bf9\u9f50\u8981\u6c42</p> <p>\u53ef\u4ee5\u4f7f\u7528__alignof()\u7b49\u8fdb\u884c\u5bf9\u9f50\u3002</p> <pre><code>struct __align__(16) {\n    float x;\n    float y;\n};\n</code></pre> <p>1D\u5168\u5c40\u5185\u5b58\uff1a</p> <p>\u5bf9\u4e8e1D\u7684\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u662f\uff0c\u7ebf\u7a0b\u4e3aID\u4e3atid\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u4f4d\u4e8e\u5730\u5740BaseAddress\uff08\u7c7b\u578b\u4e3atype*\uff09\u4e0a\u7684\u6570\u7ec4\u7684\u4e00\u4e2a\u5143\u7d20\uff0c\u4f7f\u7528\u4ee5\u4e0b\u5730\u5740\uff1a <code>BaseAddress + tid</code> \u4e3a\u5408\u5e76\u8bbf\u95ee\uff0ctype\u5fc5\u987b\u6ee1\u8db3\u4e0a\u8ff0\u5927\u5c0f\u548c\u5bf9\u9f50\u8981\u6c42\u3002</p> <p>2D\u5168\u5c40\u5185\u5b58\uff1a</p> <p>\u5bf9\u4e8e <code>BaseAddress + width * ty + tx</code> block\u7684\u5bbd\u5ea6\u548cwidth\u90fd\u5fc5\u987b\u4e3awarpSize\u7684\u500d\u6570\uff08\u5982\u679c\u662f\u534a\u4e2awarp\u8c03\u5ea6\uff0c\u5219\u662fhalf-warp\u5927\u5c0f\u7684\u500d\u6570\uff09\u3002</p> <p><code>cudaMallocPitch()</code>\u548c<code>cuMemAllocPitch()</code>\u4ee5\u53ca\u76f8\u5173\u7684\u5185\u5b58\u590d\u5236\u51fd\u6570\u53ef\u4ee5\u7f16\u5199\u4e0d\u4f9d\u8d56\u786c\u4ef6\u7684\u4ee3\u7801\u6765\u7b26\u5408\u5185\u5b58\u7684\u5bf9\u9f50\u548c\u5408\u5e76\u8bbf\u95ee\u7684\u7ea6\u675f\u7684\u4ee3\u7801\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#922-shared-memory","title":"9.2.2 \u5171\u4eab\u5185\u5b58\uff08Shared Memory\uff09","text":"<p>L1 / shared memory\uff1a\u5ef6\u8fdf10 ~ 20 cycles \u7531\u4e8e\u5171\u4eab\u5185\u5b58\u662f\u7247\u4e0a\u7684\uff0c\u56e0\u6b64\u4e0e\u672c\u5730\u548c\u5168\u5c40\u5185\u5b58\u76f8\u6bd4\uff0c\u5171\u4eab\u5185\u5b58\u5177\u6709\u66f4\u9ad8\u7684\u5e26\u5bbd\u548c\u66f4\u4f4e\u7684\u5ef6\u8fdf\u2014\u2014\u524d\u63d0\u662f\u7ebf\u7a0b\u4e4b\u95f4\u4e0d\u5b58\u5728\u5b58\u50a8\u4f53\u51b2\u7a81\u3002 \u5171\u4eab\u5185\u5b58\u5206\u914d\u6709\u9759\u6001\u548c\u52a8\u6001\u65b9\u5f0f\uff0c\u52a8\u6001\u5206\u914d\u65b9\u5f0f\u4e3a<code>kernel&lt;&lt;&lt;Dg,Db,Ns,S&gt;&gt;&gt;</code>\uff0c\u7b2c\u4e09\u4e2a\u53c2\u6570\u4e3a\u52a8\u6001\u5185\u5b58\u5b57\u8282\u6570\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#9221-shared-memory-and-memory-banks","title":"9.2.2.1 \u5171\u4eab\u5185\u5b58\u548c\u5b58\u50a8\u4f53\uff08Shared Memory and Memory Banks\uff09","text":"<p>\u4e3a\u4e86\u83b7\u5f97\u7528\u4e8e\u5e76\u53d1\u8bbf\u95ee\u7684\u9ad8\u5185\u5b58\u5e26\u5bbd\uff0c\u5171\u4eab\u5185\u5b58\u88ab\u5206\u4e3a\u5927\u5c0f\u76f8\u7b49\u4e14\u53ef\u4ee5\u540c\u65f6\u8bbf\u95ee\u7684\u5185\u5b58\u6a21\u5757\uff08\u5b58\u50a8\u4f53\uff0c<code>banks</code>\uff09\u3002</p> <p>\u4e3a\u4e86\u83b7\u5f97\u7528\u4e8e\u5e76\u53d1\u8bbf\u95ee\u7684\u9ad8\u5185\u5b58\u5e26\u5bbd\uff0c\u5171\u4eab\u5185\u5b58\u88ab\u5206\u4e3a\u5927\u5c0f\u76f8\u7b49\u4e14\u53ef\u4ee5\u540c\u65f6\u8bbf\u95ee\u7684\u5185\u5b58\u6a21\u5757\uff08\u5b58\u50a8\u4f53\uff09\u3002 \u56e0\u6b64\uff0c\u8de8\u8d8an\u4e2a\u4e0d\u540c\u5b58\u50a8\u4f53\u7684n\u4e2a\u5730\u5740\u7684\u4efb\u4f55\u5185\u5b58\u52a0\u8f7d/\u5b58\u50a8\uff08load / store\uff09\u53ef\u4ee5\u540c\u65f6\u5904\u7406\uff0c\u6709\u6548\u5e26\u5bbd\u662f\u5355\u4e2a\u5b58\u50a8\u4f53\u5e26\u5bbd\u7684n\u500d\u3002</p> <p>\u4f46\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u5185\u5b58\u8bf7\u6c42\u7684\u591a\u4e2a\u4e0d\u540c\u5730\u5740\u6620\u5c04\u5230\u76f8\u540c\u7684\u5b58\u50a8\u4f53\uff0c\u5219\u8bbf\u95ee\u5c06\u88ab\u5e8f\u5217\u5316\u2014\u2014\u5b58\u50a8\u4f53\u51b2\u7a81\uff08<code>Bank conflicts</code>\uff09\u3002 \u786c\u4ef6\u5c06\u5177\u6709\u5b58\u50a8\u4f53\u51b2\u7a81\u7684\u5185\u5b58\u8bf7\u6c42\u62c6\u5206\u4e3a\u5c3d\u53ef\u80fd\u591a\u7684\u5355\u72ec\u7684\u65e0\u51b2\u7a81\u8bf7\u6c42\uff0c\u4ece\u800c\u5c06\u6709\u6548\u5e26\u5bbd\u51cf\u5c11\u7b49\u4e8e\u5355\u72ec\u7684\u5185\u5b58\u8bf7\u6c42\u6570\u91cf\u7684\u56e0\u6570\u3002 \u8fd9\u91cc\u7684\u4e00\u4e2a\u4f8b\u5916\u662f\uff0c\u5f53\u7ebf\u7a0b\u675f\u4e2d\u7684\u591a\u4e2a\u7ebf\u7a0b\u5bfb\u5740\u540c\u4e00\u5171\u4eab\u5185\u5b58\u4f4d\u7f6e\u65f6\uff0c\u4f1a\u5bfc\u81f4\u5e7f\u64ad\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6765\u81ea\u4e0d\u540c\u5b58\u50a8\u4f53\u7684\u591a\u4e2a\u5e7f\u64ad\u5c06\u5408\u5e76\u4e3a\u4ece\u8bf7\u6c42\u7684\u5171\u4eab\u5185\u5b58\u4f4d\u7f6e\u5230\u7ebf\u7a0b\u7684\u5355\u4e2a\u591a\u64ad\u3002</p> <p>\u57285.x\u6216\u66f4\u9ad8\u7248\u672c\u7684\u8ba1\u7b97\u80fd\u529b\u7684\u8bbe\u5907\u4e0a\uff0c\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u6bcf\u4e2abank\u90fd\u670932\u4f4d\uff0832-bit\uff09\u7684\u5e26\u5bbd\uff0c\u5e76\u4e14\u5c06\u8fde\u7eed\u768432\u4f4d\u5b57\uff0832-bit words\uff09\u5206\u914d\u7ed9\u8fde\u7eed\u7684\u5b58\u50a8\u4f53\u3002 warp\u5927\u5c0f\u4e3a32\u4e2a\u7ebf\u7a0b\uff0c\u5e76\u4e14bank\u6570\u91cf\u4e5f\u4e3a32\uff0c\u56e0\u6b64\u5728warp\u4e2d\u7684\u4efb\u4f55\u7ebf\u7a0b\u4e4b\u95f4\u90fd\u53ef\u80fd\u53d1\u751fbank conflicts.</p> <p>\u5171\u4eab\u5185\u5b58\u5177\u670932\u4e2a\u5b58\u50a8\u4f53\uff0c\u8fd9\u4e9b\u5b58\u50a8\u4f53\u7ec4\u7ec7\u4e3a\u8fde\u7eed\u768432\u4f4d\u5b57\u6620\u5c04\u5230\u8fde\u7eed\u7684\u5b58\u50a8\u4f53\u3002\u6bcf\u4e2a\u5b58\u50a8\u4f53\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u5177\u670932\u4f4d\u7684\u5e26\u5bbd\u3002 \u53c2\u89c1 H.4.3 Shared Memory</p> <p>TODO\uff1abank\u5230\u5e95\u662f\u4ec0\u4e48\uff1f\u662f\u4e13\u95e8\u7684\u786c\u4ef6\u5417\uff1f64 KB\u7684\u5171\u4eab\u5185\u5b58\uff0c\u5374\u53ea\u670932-bit * 32\u7684bank\uff0cbank\u662f\u600e\u4e48\u8bfb\u5199\u5171\u4eab\u5185\u5b58\u5462\uff1f\u8bbf\u95eedouble\u7c7b\u578b\u65f6\uff0cbank\u53ea\u80fd\u5b58\u653e16\u4e2a\u6570\u636e\uff0c\u90a3\u4e48\u4e00\u4e2awarp\u768432\u4e2a\u7ebf\u7a0b\u600e\u4e48\u8bbf\u95ee32\u4e2a\u6570\u636e\u5462\uff1f\u5206\u4e24\u6b21\u5417\uff1f</p> <p>\u8865\u5145\uff1a\u57283.x\u53ca\u4ee5\u4e0a\u8ba1\u7b97\u80fd\u529b\uff0c\u6ca1\u6709bank conflict\u7684\u67e5\u770b\u5de5\u5177\u3002\u56e0\u4e3a\u8fd9\u4e9b\u8ba1\u7b97\u80fd\u529b\u4e4b\u540e\uff0c\u9a7b\u7559\u7684warps\u66f4\u591a\uff0c\u6ca1\u6709\u51b2\u7a81\u7684\u5171\u4eab\u5185\u5b58\u8bbf\u95ee\u53ef\u80fd\u88ab\u5408\u5e76\uff0c\u5982\u6b64\uff0cbank conflict\u53d8\u5f97\u4e0d\u518d\u91cd\u8981\u3002</p> <p>\u5b58\u50a8\u4f53\u53ef\u4ee5\u4f7f\u7528<code>cudaDeviceSetSharedMemConfig()</code>\u51fd\u6570\u8bbe\u7f6e\u4e3a4\u5b57\u8282\u30018\u5b57\u8282\uff0c\u9ed8\u8ba4\u4e3a4\u5b57\u8282\u3002 \uff08\u5171\u4eab\u5185\u5b58\u914d\u7f6e\u89c1 cudaSharedMemConfig\uff09\u3002</p> <p>Bank Conflicts\u4ee3\u7801\u793a\u4f8b\uff1a</p> <p>Bank Conflicts\u53c2\u8003\u535a\u5ba21 </p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#923-local-memory","title":"9.2.3 \u672c\u5730 / \u5c40\u90e8\u5185\u5b58\uff08Local Memory\uff09","text":"<p>\u672c\u5730\u5185\u5b58\u4e4b\u6240\u4ee5\u5982\u6b64\u547d\u540d\uff0c\u662f\u56e0\u4e3a\u5b83\u7684\u4f5c\u7528\u57df\u662f\u7ebf\u7a0b\u7684\u672c\u5730\uff0c\u800c\u4e0d\u662f\u56e0\u4e3a\u5b83\u7684\u7269\u7406\u4f4d\u7f6e\u3002\u4e8b\u5b9e\u4e0a\uff0c\u672c\u5730\u5185\u5b58\u662f\u82af\u7247\u5916\u7684\u3002\u56e0\u6b64\uff0c\u8bbf\u95ee\u672c\u5730\u5185\u5b58\u4e0e\u8bbf\u95ee\u5168\u5c40\u5185\u5b58\u4e00\u6837\u6602\u8d35\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u540d\u79f0\u4e2d\u7684\u672f\u8bedlocal\u5e76\u4e0d\u610f\u5473\u7740\u66f4\u5feb\u7684\u8bbf\u95ee\u3002</p> <p>\u672c\u5730\u5185\u5b58\u53ea\u7528\u4e8e\u4fdd\u5b58\u81ea\u52a8\u53d8\u91cf\u3002\u8fd9\u662f\u5728nvcc\u7f16\u8bd1\u5668\u53d1\u73b0\u6ca1\u6709\u8db3\u591f\u7a7a\u95f4\u7684\u5bc4\u5b58\u5668\u5b58\u653e\u81ea\u52a8\u53d8\u91cf\u65f6\u51b3\u5b9a\u7684\u3002\u5f88\u53ef\u80fd\u653e\u5728\u672c\u5730\u5185\u5b58\u4e2d\u7684\u81ea\u52a8\u53d8\u91cf\u662f\u5360\u7528\u592a\u591a\u5bc4\u5b58\u5668\u7a7a\u95f4\u7684\u5927\u578b\u7ed3\u6784\u6216\u6570\u7ec4\uff0c\u7f16\u8bd1\u5668\u786e\u5b9a\u7684\u6570\u7ec4\u53ef\u80fd\u4f1a\u88ab\u52a8\u6001\u7d22\u5f15\u3002</p> <p>\u672c\u5730\u5185\u5b58\u662f\u62bd\u8c61\u5185\u5b58\u7c7b\u578b\u3002\u5b83\u672c\u8eab\u4e0d\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u5b58\u50a8\u5668\u7cfb\u7edf\uff0c\u800c\u662f\u4e00\u4e2a\u7528\u4e8e\u4fdd\u5b58\u6ea2\u51fa\u5bc4\u5b58\u5668\u7684\u5b58\u50a8\u5668\u4f4d\u7f6e\u3002\u5f53\u7ebf\u7a0b\u5757\u9700\u8981\u6bd4SM\u4e0a\u66f4\u591a\u7684\u5bc4\u5b58\u5668\u5b58\u50a8\u65f6\uff0c\u5c31\u4f1a\u53d1\u751f\u5bc4\u5b58\u5668\u6ea2\u51fa\u3002 Fermi\u4e4b\u524d\u7684GPU\u5c06\u5bc4\u5b58\u5668\u6ea2\u51fa\u5230\u5168\u5c40\u5185\u5b58\u4e2d\uff0c\u8fd9\u5bfc\u81f4\u5e94\u7528\u7a0b\u5e8f\u6027\u80fd\u6025\u5267\u4e0b\u964d\u3002 Compute 2.0\u548c\u66f4\u9ad8\u7248\u672c\u7684\u8bbe\u5907\u5c06\u5bc4\u5b58\u5668\u6ea2\u51fa\u5230L1\u7f13\u5b58\u4e2d\uff0c\u4ece\u800c\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u4e86\u5bc4\u5b58\u5668\u6ea2\u51fa\u5bf9\u6027\u80fd\u7684\u5f71\u54cd\u3002</p> <p>\u68c0\u67e5PTX\u6c47\u7f16\u4ee3\u7801(\u901a\u8fc7\u4f7f\u7528<code>-ptx</code>\u6216<code>nvcc</code>\u7684<code>-keep</code>\u547d\u4ee4\u884c\u9009\u9879\u7f16\u8bd1\u83b7\u5f97)\uff0c\u53ef\u4ee5\u53d1\u73b0\u5728\u7b2c\u4e00\u4e2a\u7f16\u8bd1\u9636\u6bb5\u662f\u5426\u5c06\u53d8\u91cf\u653e\u5728\u4e86\u672c\u5730\u5185\u5b58\u4e2d\u3002\u5982\u679c\u662f\uff0c\u5c06\u4f7f\u7528<code>.local</code>\u52a9\u8bb0\u7b26\u58f0\u660e\u5b83\uff0c\u5e76\u4f7f\u7528<code>ld.local</code>\u548c<code>st.local</code>\u52a9\u8bb0\u7b26\u8bbf\u95ee\u5b83\u3002\u5982\u679c\u6ca1\u6709\uff0c\u5f53\u540e\u7eed\u7684\u7f16\u8bd1\u9636\u6bb5\u53d1\u73b0\u8be5\u53d8\u91cf\u5360\u7528\u4e86\u76ee\u6807\u4f53\u7cfb\u7ed3\u6784\u592a\u591a\u7684\u5bc4\u5b58\u5668\u7a7a\u95f4\uff0c\u53ef\u80fd\u4ecd\u7136\u4f1a\u505a\u51fa\u4e0d\u540c\u7684\u51b3\u5b9a\u3002\u6ca1\u6709\u529e\u6cd5\u5bf9\u7279\u5b9a\u7684\u53d8\u91cf\u8fdb\u884c\u68c0\u67e5\uff0c\u4f46\u662f\u7f16\u8bd1\u5668\u5728\u4f7f\u7528<code>\u2014\u2014ptxas-options=-v</code>\u9009\u9879\u8fd0\u884c\u65f6\uff0c\u4f1a\u62a5\u544a\u6bcf\u4e2a\u5185\u6838\u7684\u672c\u5730\u5185\u5b58\u4f7f\u7528\u603b\u91cf(lmem)\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#924-texture-memory","title":"9.2.4 \u7eb9\u7406\u5185\u5b58\uff08Texture Memory\uff09","text":"<p>\u7eb9\u7406\u548c\u8868\u9762\u5185\u5b58\uff08Texture and Surface Memory\uff09\u9a7b\u7559\u5728\u8bbe\u5907\u5185\u5b58\uff08device memory\uff09\uff0c\u5e76\u4e14\u88ab\u7eb9\u7406\u7f13\u5b58\u533a\u7f13\u5b58\uff08texture cache\uff09\u3002  \u53c2\u89c1 [CUDA C Programming Guide: 5.3.2. Device Memory Accesses]</p> <p>\u56e0\u6b64\uff0c\u7eb9\u7406\u83b7\u53d6\u53ea\u4f1a\u5728\u7f13\u5b58\u672a\u547d\u4e2d\uff08cache miss\uff09\u65f6\uff0c\u6d88\u8017\u4e00\u6b21\u8bbe\u5907\u5185\u5b58\u8bfb\u64cd\u4f5c\uff0c\u4e4b\u540e\u5b83\u53ea\u9700\u8981\u4ece\u7eb9\u7406\u7f13\u5b58\uff08texture cache\uff09\u4e2d\u8bfb\u53d6\u3002</p> <p>\u7eb9\u7406\u7f13\u5b58\u9488\u5bf92D\u7a7a\u95f4\u5c40\u90e8\u6027\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u56e0\u6b64\uff0c\u540c\u4e00\u4e2awarp\u4e2d\u8bfb\u7eb9\u7406\u5730\u5740\u5728\u4e00\u8d77\u7684\u7ebf\u7a0b\u5c06\u83b7\u5f97\u6700\u4f73\u6027\u80fd\u3002</p> <p>\u7eb9\u7406\u5185\u5b58\u88ab\u8bbe\u8ba1\u6210\u6d41\u5f0f\u8bfb\u53d6\uff0c\u5e76\u4e14\u662f\u5e38\u6570\u65f6\u95f4\u5ef6\u8fdf\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u7f13\u5b58\u547d\u4e2d\u964d\u4f4e\u4e86DRAM\u7684\u5e26\u5bbd\u8981\u6c42\uff0c\u5374\u6ca1\u6709\u8bfb\u53d6\u5ef6\u8fdf\u3002</p> <p>\u7eb9\u7406\u5185\u5b58\u662f\u53ea\u8bfb\u7684\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Best-Practices-Guide/9.Memory-Optimizations/#925-constant-memory","title":"9.2.5 \u5e38\u91cf\u5185\u5b58\uff08Constant Memory\uff09","text":"<p>\u5e38\u91cf\u5185\u5b58\u7a7a\u95f4\u9a7b\u7559\u5728\u8bbe\u5907\u5185\u5b58\u4e2d\uff0c\u5e76\u7f13\u5b58\u5728\u5e38\u91cf\u7f13\u5b58\uff08constant cache\uff09\u4e2d\u3002</p> <p>\u5728\u4e00\u4e2a\u8bbe\u5907\u4e0a\u603b\u5171\u670964 KB\u7684\u5e38\u91cf\u5185\u5b58\u3002\u5e38\u91cf\u5185\u5b58\u7a7a\u95f4\u4f1a\u88ab\u7f13\u5b58\u3002</p> <p>warp\u5185\u7684\u7ebf\u7a0b\u5bf9\u4e0d\u540c\u5730\u5740\u7684\u8bbf\u95ee\u662f\u4e32\u884c\u5316\u7684\uff0c\u56e0\u6b64\u8bbf\u5b58\u6210\u672c\u4e0ewarp\u5185\u6240\u6709\u7ebf\u7a0b\u8bfb\u53d6\u7684\u4e0d\u540c\u5730\u5740\u7684\u6570\u91cf\u6210\u7ebf\u6027\u5173\u7cfb\u3002</p> <p>\u56e0\u6b64\uff0c\u5f53\u540c\u4e00warp\u4e2d\u7684\u7ebf\u7a0b\u53ea\u8bbf\u95ee\u51e0\u4e2a\u4e0d\u540c\u7684\u4f4d\u7f6e\u65f6\uff0c\u5e38\u91cf\u7f13\u5b58\u662f\u6700\u597d\u7684\u3002\u5982\u679c\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u8bbf\u95ee\u540c\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u90a3\u4e48\u5e38\u91cf\u5185\u5b58\u7684\u8bbf\u95ee\u901f\u5ea6\u53ef\u4ee5\u548c\u5bc4\u5b58\u5668\u8bbf\u95ee\u901f\u5ea6\u4e00\u6837\u5feb\u3002</p> <p>\u5185\u5b58\u5206\u914d\u65b9\u5f0f</p> <p>kernel\u6267\u884c\u65b9\u5f0f\uff1a \u5f62\u5982<code>kernelFunc&lt;&lt;&lt; Dg, Db, Ns, S &gt;&gt;&gt;(params...)</code>\uff0c\u5176\u4e2d <code>Dg</code>\uff1a<code>dim3</code>\u7c7b\u578b\uff0c\u6307\u5b9agrid\u7ef4\u5ea6\uff0c\u5373<code>Dg.x * Dg.y * Dg.z</code>; <code>Db</code>\uff1a<code>dim3</code>\u7c7b\u578b\uff0c\u6307\u5b9ablock\u7ef4\u5ea6\uff0c\u5373<code>Db.x * Db.y * Db.</code>; <code>Ns</code>\uff1a<code>size_t</code>\u7c7b\u578b\uff0c\u4e3a\u52a8\u6001\u5206\u914d\u5171\u4eab\u5185\u5b58\u7684\u5b57\u8282\u6570\uff08\u9644\u52a0\u5230\u9759\u6001\u5206\u914d\u7684\u5171\u4eab\u5185\u5b58\u4e0a\uff09\uff1b\u52a8\u6001\u5206\u914d\u7684\u5185\u5b58\u7531\u58f0\u660e\u4e3a<code>__shared__</code>\u7684\u5916\u90e8\uff08extern\uff09\u6570\u7ec4\u7684\u4efb\u4f55\u53d8\u91cf\u4f7f\u7528; Ns\u4e3a\u53ef\u9009\u53c2\u6570\uff0c\u9ed8\u8ba4\u4e3a0;   <code>S</code>\uff1a<code>cudaStream_t</code>\u7c7b\u578b\uff0c\u6307\u5b9a\u5173\u8054\u7684\u6d41\uff1bS\u4e3a\u53ef\u9009\u53c2\u6570\uff0c\u9ed8\u8ba4\u4e3a0\uff08NULL\u6d41\uff09\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/","title":"Extracts","text":"<p>\u53c2\u89c1 CUDA C Programming Guide Reference</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#314-application-compatibility","title":"3.1.4 \u5e94\u7528\u7a0b\u5e8f\u517c\u5bb9\u6027\uff08Application Compatibility\uff09","text":""},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#324-page-locked-host-memory","title":"3.2.4 \u9875\u9501\u5b9a\u4e3b\u673a\u5185\u5b58\uff08Page-Locked Host Memory\uff09","text":"<p>https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#page-locked-host-memory</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#3241-portable-memory","title":"3.2.4.1 Portable Memory","text":""},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#3242-write-combining-memory","title":"3.2.4.2 Write-Combining Memory","text":""},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#3243-mapped-memory","title":"3.2.4.3 \u6620\u5c04\u5185\u5b58\uff08Mapped Memory\uff09","text":""},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#4-hardware-implementation","title":"4 \u786c\u4ef6\u5b9e\u73b0\uff08Hardware Implementation\uff09","text":""},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#41-simt-architecture","title":"4.1 \u5355\u6307\u4ee4\u591a\u7ebf\u7a0b\u67b6\u6784\uff08SIMT Architecture\uff09","text":""},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#42-hardware-multithreading","title":"4.2 \u786c\u4ef6\u591a\u7ebf\u7a0b\uff08Hardware Multithreading\uff09","text":"<p>\u4e00\u4e2a\u591a\u5904\u7406\u5668\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u675f\uff08warp\uff09\u7684\u6267\u884c\u4e0a\u4e0b\u6587\uff08execution context\uff0c\u4f8b\u5982pragram counters, registers, etc.\uff09\u4fdd\u5b58\u5728\u7247\u4e0a\uff08on-chip\uff09\uff0c\u751f\u547d\u671f\u4e3a\u6574\u4e2awarp. \u56e0\u6b64\uff0c\u6267\u884c\u4e0a\u4e0b\u6587\u5207\u6362\u6ca1\u6709\u4ee3\u4ef7\u3002\u6bcf\u6b21\u6307\u4ee4\u53d1\u8d77\uff08at every instruction issue time\uff09\uff0c\u7ebf\u7a0b\u675f\u8c03\u5ea6\u5668\uff08warp schedulers\uff09\u9009\u62e9\u6240\u6709\u7ebf\u7a0b\u90fd\u51c6\u5907\u597d\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u7ebf\u7a0b\u675f\uff0c\u5e76\u4e14\u628a\u6307\u4ee4\u53d1\u7ed9\u8fd9\u4e9b\u7ebf\u7a0b\u3002</p> <p>\u7279\u522b\u5730\uff0c\u6bcf\u4e2aSM\u5c0632\u4f4d\u5bc4\u5b58\u5668\uff0832-bit registers\uff09\u5728warps\u4e4b\u95f4\u5206\u533a\uff0c\u5c06\u5e76\u884c\u6570\u636e\u9ad8\u901f\u7f13\u5b58\uff08parallel data cache\uff09\u548c\u5171\u4eab\u5185\u5b58\uff08shared memory\uff09\u5728\u7ebf\u7a0b\u5757\uff08thread blocks\uff09\u4e4b\u95f4\u5206\u533a\u3002</p> <p>SM\u4e0a\u4e00\u4e2a\u7ed9\u5b9akernel\u53ef\u4ee5\u9a7b\u7559\u7684\u7ebf\u7a0b\u5757\u548c\u7ebf\u7a0b\u675f\u6570\u91cf\uff0c\u53d6\u51b3\u4e8ekernel\u4f7f\u7528\u7684\u5bc4\u5b58\u5668\u548c\u5171\u4eab\u5185\u5b58\u7684\u5927\u5c0f\u548cSM\u62e5\u6709\u7684\u5bc4\u5b58\u5668\u548c\u5171\u4eab\u5185\u5b58\u7684\u5bb9\u91cf\u3002\u4e00\u4e2aSM\u4e0a\u80fd\u9a7b\u7559\u7684blocks\u548cwarps\u7684\u6700\u5927\u6570\u91cf\u4e5f\u6709\u9650\u5236\uff0c\u53c2\u89c1 Compute Capabilities \u3002\u5982\u679c\u6bcf\u4e2aSM\u6ca1\u6709\u8db3\u591f\u7684\u5bc4\u5b58\u5668\u548c\u5171\u4eab\u5185\u5b58\u8fd0\u884c\u81f3\u5c11\u4e00\u4e2ablock\uff0c\u90a3\u4e48\u8fd9\u4e2akernel\u5c06\u4f1a\u542f\u52a8\u5931\u8d25\u3002</p> <p>\u4e00\u4e2ablock\u7684\u603bwarps\u6570\u4e3a <pre><code>ceil(T/warpSize, 1)\n</code></pre></p> <ul> <li>T\u662f\u6bcf\u4e2ablock\u7684\u7ebf\u7a0b\u6570  </li> <li>ceil(x, y)\u7b49\u4e8ex\u56db\u820d\u4e94\u5165\u5230y\u7684\u6700\u63a5\u8fd1\u500d\u6570\u3002</li> </ul>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#5-performance-guidelines","title":"5 \u6027\u80fd\u6307\u5bfc\u65b9\u9488\uff08Performance Guidelines\uff09","text":""},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#51-overall-performance-optimization-strategies","title":"5.1 \u6574\u4f53\u6027\u80fd\u4f18\u5316\u7b56\u7565\uff08Overall Performance Optimization Strategies\uff09","text":"<ul> <li>\u6700\u5927\u5316\u5e76\u884c\u6267\u884c\u5b9e\u73b0\u6700\u5927\u5229\u7528\u7387</li> <li>\u4f18\u5316\u5185\u5b58\u4f7f\u7528\u5b9e\u73b0\u6700\u5927\u5185\u5b58\u541e\u5410\u91cf</li> <li>\u4f18\u5316\u6307\u4ee4\u4f7f\u7528\u5b9e\u73b0\u6700\u5927\u6307\u4ee4\u541e\u5410\u91cf</li> </ul>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#52-maximize-utilization","title":"5.2 \u6700\u5927\u5316\u5229\u7528\u7387\uff08Maximize Utilization\uff09","text":"<p>\u4e3a\u4e86\u6700\u5927\u7a0b\u5ea6\u5730\u5229\u7528\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e94\u4ee5\u5c3d\u53ef\u80fd\u591a\u7684\u5e76\u884c\u6027\u6765\u6784\u9020\u5e94\u7528\u7a0b\u5e8f\uff0c\u5e76\u5c06\u8be5\u5e76\u884c\u6027\u6709\u6548\u5730\u6620\u5c04\u5230\u7cfb\u7edf\u7684\u5404\u4e2a\u7ec4\u4ef6\uff0c\u4ee5\u4f7f\u5b83\u4eec\u5728\u5927\u591a\u6570\u65f6\u95f4\u4fdd\u6301\u5fd9\u788c\u72b6\u6001\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#521-application-level","title":"5.2.1 \u5e94\u7528\u7a0b\u5e8f\u7ea7\u522b\uff08Application Level\uff09","text":"<ol> <li>\u5c5e\u4e8e\u76f8\u540c\u7684block\uff0c\u6240\u4ee5\u5e94\u8be5\u4f7f\u7528<code>__syncthreads()</code>\u5e76\u4e14\u901a\u8fc7\u5171\u4eab\u5185\u5b58\u5171\u4eab\u6570\u636e\u3002</li> <li>\u5c5e\u4e8e\u4e0d\u540c\u7684block\uff0c\u6240\u4ee5\u5fc5\u987b\u901a\u8fc7\u5168\u5c40\u5185\u5b58\u5171\u4eab\u6570\u636e\uff0c\u5e76\u4e14\u4f7f\u7528\u4e24\u4e2a\u4e0d\u540c\u7684kernel\uff0c\u4e00\u4e2a\u5199\uff0c\u4e00\u4e2a\u8bfb\u3002</li> </ol> <p>\u663e\u7136\u7b2c\u4e8c\u79cd\u65b9\u6848\u4e0d\u597d\uff0c\u5b83\u8c03\u7528\u4e86\u4e24\u4e2akernel\uff0c\u5e76\u4e14\u5f15\u5165\u4e86\u5168\u5c40\u5185\u5b58\u3002</p> <p>\u56e0\u6b64\uff0c\u5e94\u901a\u8fc7\u5c06\u7b97\u6cd5\u6620\u5c04\u5230CUDA\u7f16\u7a0b\u6a21\u578b\uff0c\u4ee5\u4f7f\u9700\u8981\u7ebf\u7a0b\u95f4\u901a\u4fe1\u7684\u8ba1\u7b97\u5c3d\u53ef\u80fd\u5728\u5355\u4e2a\u7ebf\u7a0b\u5757\u5185\u6267\u884c\uff0c\u4ece\u800c\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u5176\u53d1\u751f\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#522-device-level","title":"5.2.2 \u8bbe\u5907\u7ea7\u522b\uff08Device Level\uff09","text":"<p>\u5e94\u8be5\u5728\u4e00\u4e2adevice\u7684SMs\u4e4b\u95f4\u6700\u5927\u5316\u5e76\u884c\u6267\u884c\u3002</p> <p>\u591a\u4e2akernels\u53ef\u4ee5\u5728\u4e00\u4e2adevice\u4e2d\u5e76\u53d1\u6267\u884c\uff0c\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528streams\u542f\u7528\u8db3\u591f\u591a\u7684kernels\u5e76\u53d1\u6267\u884c\u3002 \u89c1 3.2.5. Asynchronous Concurrent Execution</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#523-multiprocessor-level","title":"5.2.3 \u591a\u5904\u7406\u5668\u7ea7\u522b\uff08Multiprocessor Level\uff09","text":"<p>\u5e94\u8be5\u5728\u5404\u79cd\u51fd\u6570\u5355\u5143\u4e4b\u95f4\u5e76\u884c\u6267\u884c\u3002</p> <p>\u5982 4.2. \u786c\u4ef6\u591a\u7ebf\u7a0b \u6240\u8ff0\uff0cGPU\u7684SM\u4e3b\u8981\u4f9d\u8d56\u7ebf\u7a0b\u7ea7\u5e76\u884c\u6765\u5b9e\u73b0\u6700\u5927\u5316\u51fd\u6570\u5355\u5143\u5229\u7528\u7387\uff08maximize utilization of its functional units\uff09\u7684\u76ee\u7684\u3002\u56e0\u6b64\uff0c\u5229\u7528\u7387\u76f4\u63a5\u4e0e\u9a7b\u7559\u7ebf\u7a0b\u675f\uff08resident warps\uff09\u5173\u8054\u3002\u6bcf\u6b21\u6307\u4ee4\u53d1\u5e03\uff0c\u7ebf\u7a0b\u675f\u8c03\u5ea6\u5668\uff08warp scheduler\uff09\u9009\u62e9\u4e00\u6761\u51c6\u5907\u597d\u6267\u884c\u7684\u6307\u4ee4\u3002\u8fd9\u6761\u6307\u4ee4\u53ef\u4ee5\u662f\u672cwarp\u7684\u53e6\u4e00\u6761\u72ec\u7acb\u6307\u4ee4\u2014\u2014\u5229\u7528\u6307\u4ee4\u7ea7\u5e76\u884c\uff08instruction-level parallelism\uff09\uff0c\u66f4\u53ef\u80fd\u7684\u662f\u53e6\u5916\u4e00\u4e2awarp\u7684\u6307\u4ee4\u2014\u2014\u5229\u7528\u7ebf\u7a0b\u7ea7\u5e76\u884c\uff08thread-level parallelism\uff09\u3002\u5982\u679c\u4e00\u6761\u6307\u4ee4\u88ab\u9009\u4e2d\uff0c\u90a3\u4e48\u5b83\u88ab\u53d1\u5e03\u5230warp\u7684\u6d3b\u52a8\u7ebf\u7a0b\u3002\u4e00\u4e2awarp\u7b49\u5f85\u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u65f6\u949f\u5468\u671f\u6570\u79f0\u4e3a\u5ef6\u8fdf\uff08latency\uff09\u3002\u5982\u679c\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\uff0c\u7ebf\u7a0b\u675f\u8c03\u5ea6\u5668\u90fd\u6709\u4e00\u4e9b\u6307\u4ee4\u53d1\u5e03\u5230\u4e00\u4e9bwarp\uff0c\u90a3\u4e48\u5ef6\u8fdf\u5c31\u88ab\u9690\u85cf\uff08hidden\uff09\u3002\u9690\u85cf<code>L</code>\u4e2a\u65f6\u949f\u5468\u671f\u7684\u5ef6\u8fdf\u65f6\u95f4\u6240\u9700\u7684\u6307\u4ee4\u6570\u91cf\u53d6\u51b3\u4e8e\u8fd9\u4e9b\u6307\u4ee4\u5404\u81ea\u7684\u541e\u5410\u91cf\uff08\u6709\u5173\u5404\u79cd\u7b97\u672f\u6307\u4ee4\u7684\u541e\u5410\u91cf\uff0c\u8bf7\u53c2\u89c1 5.4.1. \u7b97\u672f\u6307\u4ee4\uff09\u3002\u5982\u679c\u6307\u4ee4\u541e\u5410\u91cf\u8fbe\u5230\u6700\u5927\uff0c\u90a3\u4e48\u5b83\u5c06\u7b49\u4e8e\uff1a</p> <ol> <li>4L\uff1a\u5bf9\u4e8e\u8ba1\u7b97\u80fd\u529b\u4e3a5.x, 6.1, 6.2 and 7.x\u7684\u8bbe\u5907\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8fd9\u4e9b\u8bbe\u5907\uff0c\u4e00\u4e2aSM\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u53d1\u90014\u6761\u6307\u4ee4\uff0c\u6bcf\u6761\u6307\u4ee4\u63d0\u4f9b\u7ed9\u4e00\u4e2awarp\uff08\u56e0\u4e3a\u67094\u4e2awarp schedulers\uff0c\u6240\u4ee5\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u53ef\u4ee5\u9a7b\u75594\u4e2awarps\uff09\u3002\u53c2\u89c1 Compute Capabilities \u3002</li> <li>2L\uff1a\u5bf9\u4e8e\u8ba1\u7b97\u80fd\u529b\u4e3a6.0\u7684\u8bbe\u5907\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8fd9\u4e9b\u8bbe\u5907\uff0c\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u53d1\u51fa\u4e24\u6761\u6307\u4ee4\uff0c\u6bcf\u6761\u6307\u4ee4\u63d0\u4f9b\u7ed9\u4e24\u4e2a\u4e0d\u540c\u7684warps.</li> <li>8L\uff1a\u5bf9\u4e8e\u8ba1\u7b97\u80fd\u91cc\u4e3a3.x\u7684\u8bbe\u5907\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u8fd9\u4e9b\u8bbe\u5907\uff0c\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u53d1\u51fa8\u6761\u6307\u4ee4\uff0c\u5206\u62104\u5bf9\u63d0\u4f9b\u7ed94\u4e2a\u4e0d\u540c\u7684warps\uff0c\u6bcf\u5bf9\u5c5e\u4e8e\u76f8\u540c\u7684warp.</li> </ol> <p>\u4e00\u4e2awarp\u6ca1\u6709\u51c6\u5907\u597d\u6267\u884c\u6700\u5e38\u89c1\u7684\u539f\u56e0\u662f\uff0c\u6307\u4ee4\u7684\u8f93\u5165\u64cd\u4f5c\u6570\u6ca1\u6709\u51c6\u5907\u597d\u3002</p> <p>\u5982\u679c\u6240\u6709\u64cd\u4f5c\u6570\u90fd\u662f\u5bc4\u5b58\u5668\uff0c\u90a3\u4e48\u5ef6\u8fdf\u662f\u7531\u5bc4\u5b58\u5668\u7684\u76f8\u5173\u6027\u5f15\u8d77\u7684\uff0c\u5373\u67d0\u4e9b\u8f93\u5165\u64cd\u4f5c\u6570\u662f\u7531\u4e00\u4e9b\u5c1a\u672a\u5b8c\u6210\u6267\u884c\u7684\u5148\u524d\u6307\u4ee4\u5199\u5165\u7684\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7b49\u5f85\u65f6\u95f4\u7b49\u4e8e\u524d\u4e00\u6761\u6307\u4ee4\u7684\u6267\u884c\u65f6\u95f4\uff0c\u5e76\u4e14warp\u8c03\u5ea6\u5668\u5fc5\u987b\u5728\u8fd9\u6bb5\u65f6\u95f4\u5185\u8c03\u5ea6\u5176\u4ed6warp\u7684\u6307\u4ee4\u3002\u6267\u884c\u65f6\u95f4\u56e0\u6307\u4ee4\u800c\u5f02\u3002\u5728\u5177\u67097.x\u8ba1\u7b97\u80fd\u529b\u7684\u8bbe\u5907\uff0c\u5927\u591a\u6570\u7b97\u672f\u6307\u4ee4\u901a\u5e38\u4e3a4\u4e2a\u65f6\u949f\u5468\u671f\u3002\u8fd9\u610f\u5473\u7740\u6bcf\u4e2a\u591a\u5904\u7406\u5668\u9700\u898116\u4e2a\u6d3b\u52a8\u7ebf\u7a0b\u675f\uff084\u4e2a\u5468\u671f\uff0c4\u4e2awarp\u8c03\u5ea6\u5668\uff09\u6765\u9690\u85cf\u7b97\u672f\u6307\u4ee4\u5ef6\u8fdf\uff08\u5047\u8bbe\u6240\u6709\u6307\u4ee4\u90fd\u4ee5\u6700\u5927\u541e\u5410\u91cf\u6267\u884c\uff0c\u5426\u5219\u9700\u8981\u7684\u6d3b\u52a8\u7ebf\u7a0b\u675f\u4e2a\u6570\u53ef\u4ee5\u51cf\u5c11\uff09\u3002\u5982\u679c\u72ec\u7acb\u7684warps\u5229\u7528\u6307\u4ee4\u7ea7\u5e76\u884c\uff0c\u4f8b\u5982\uff0c\u5728\u5b83\u6240\u5728\u7684\u6307\u4ee4\u6d41\u4e2d\u6709\u591a\u4e2a\u72ec\u7acb\u7684\u6307\u4ee4\uff0c\u90a3\u4e48\u5c31\u4e0d\u9700\u8981\u8fd9\u4e48\u591awarps\uff0c\u56e0\u4e3a\u4e00\u4e2awarp\u7684\u591a\u4e2a\u72ec\u7acb\u7684\u6307\u4ee4\u53ef\u4ee5\u8fde\u7eed\u6267\u884c\u3002</p> <p>\u5982\u679c\u4e00\u4e9b\u64cd\u4f5c\u6570\u5728\u7247\u5916\u5b58\u50a8\u5668\u4e2d\uff0c\u90a3\u4e48\u5ef6\u8fdf\u5c31\u66f4\u5927\uff0c\u4e00\u822c\u9700\u8981\u51e0\u767e\u4e2a\u65f6\u949f\u5468\u671f\u3002\u4fdd\u6301warp\u8c03\u5ea6\u5668\u5fd9\u788c\u7684warp\u6570\u91cf\u4f9d\u8d56\u4e8ekernel\u4ee3\u7801\u7684\u6307\u4ee4\u7ea7\u5e76\u884c\u5ea6\u3002\u901a\u5e38\uff0c\u5982\u679c\u4e0d\u9700\u8981\u7247\u5916\u5185\u5b58\u7684\u6307\u4ee4\uff08\u6bd4\u5982\u5927\u90e8\u5206\u65f6\u95f4\u5728\u6267\u884c\u7b97\u672f\u6307\u4ee4\uff09\u6570\u5360\u6bd4\uff08\u8fd9\u4e2a\u6bd4\u7387\u79f0\u4e3a\u7a0b\u5e8f\u7684\u7b97\u672f\u5bc6\u96c6\u5ea6\uff08arithmetic intensity\uff09\uff09\u8d8a\u5c0f\uff0c\u9700\u8981\u7684warps\u6570\u91cf\u5c31\u4f1a\u8d8a\u5927\u3002</p> <p>warp\u6ca1\u6709\u51c6\u5907\u597d\u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4\u7684\u53e6\u4e00\u4e2a\u539f\u56e0\u662f\uff0c\u5b83\u5728\u67d0\u4e2a\u5185\u5b58\u6805\u680f\uff08Memory Fence Functions\uff09\u6216\u540c\u6b65\u70b9\uff08Memory Fence Functions\uff09\u4e2d\u7b49\u5f85\u3002</p> <p>\u540c\u6b65\u70b9\u53ef\u4ee5\u8feb\u4f7f\u591a\u5904\u7406\u5668\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\uff0c\u56e0\u4e3a\u8d8a\u6765\u8d8a\u591a\u7684\u7ebf\u7a0b\u675f\u7b49\u5f85\u5728\u540c\u6b65\u70b9\u4e4b\u524d\u5b8c\u6210\u6307\u4ee4\u7684\u6267\u884c\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u591a\u5904\u7406\u5668\u4f7f\u7528\u591a\u4e2a\u9a7b\u7559blocks\u53ef\u4ee5\u5e2e\u52a9\u51cf\u5c11\u7a7a\u95f2\uff0c\u56e0\u4e3a\u6765\u81ea\u4e0d\u540cblock\u7684warp\u4e0d\u9700\u8981\u5728\u540c\u6b65\u70b9\u5f7c\u6b64\u7b49\u5f85\u3002</p> <p>\u4e00\u6b21kernel\u8c03\u7528\u4e2d\uff0c\u6bcf\u4e2a\u591a\u5904\u7406\u5668\u9a7b\u7559\u7684blocks\u548cwarps\u6570\u91cf\u53d6\u51b3\u4e8e\u6b64\u6b21\u8c03\u7528\u7684\u6267\u884c\u914d\u7f6e\uff08kernel\u51fd\u6570\u8c03\u7528\u7684\u53c2\u6570\u914d\u7f6e\uff09\u3001\u591a\u5904\u7406\u5668\u4e2d\u7684\u5185\u5b58\u8d44\u6e90\u548c\u8fd9\u4e2akernel\u7684\u8d44\u6e90\u9700\u6c42\uff08\u89c1 4.2. \u786c\u4ef6\u591a\u7ebf\u7a0b \uff09\u3002\u7f16\u8bd1\u5668\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u7f16\u8bd1\u9009\u9879<code>-ptxas-options=-v</code>\u6765\u62a5\u544a\u5bc4\u5b58\u5668\u548c\u5171\u4eab\u5185\u5b58\u7684\u4f7f\u7528\u91cf\u3002</p> <p>\u4e00\u4e2ablock\u9700\u8981\u7684\u5171\u4eab\u5185\u5b58\u5927\u5c0f\u7b49\u4e8e\u9759\u6001\u548c\u52a8\u6001\u5206\u914d\uff08kernel\u8c03\u7528\u65f6\u7684\u914d\u7f6e\u53c2\u6570\uff09\u7684\u603b\u91cf\u3002</p> <p>kernel\u4f7f\u7528\u7684\u5bc4\u5b58\u5668\u6570\u91cf\u53ef\u80fd\u5bf9\u9a7b\u7559warps\u7684\u6570\u91cf\u4ea7\u751f\u663e\u8457\u5f71\u54cd\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u8ba1\u7b97\u80fd\u529b6.x\u7684\u8bbe\u5907\uff0c\u5982\u679c\u4e00\u4e2akernel\u4f7f\u7528\u4e8664\u4e2a\u5bc4\u5b58\u5668\uff0c\u6bcf\u4e2ablock\u6709512\u4e2a\u7ebf\u7a0b\uff0c\u4f7f\u7528\u5f88\u5c11\u7684\u5171\u4eab\u5185\u5b58\uff0c\u90a3\u4e48\uff0c2\u4e2ablocks\uff08\u6bd4\u598232\u4e2awarps\uff0c\u5176\u4e2d<code>32=512*2/warpSize</code>\uff09\u53ef\u4ee5\u9a7b\u7559\u5728\u591a\u5904\u7406\u5668\u4e2d\uff0c\u56e0\u4e3a\u4ed6\u4eec\u9700\u8981<code>2*512*64</code>\u4e2a\u5bc4\u5b58\u5668\uff0c\u7b49\u4e8e\u591a\u5904\u7406\u5668\u62e5\u6709\u7684\u5bc4\u5b58\u5668\u6570\u91cf\uff08<code>65536</code>\uff09\u3002\u4f46\u662f\uff0c\u4e00\u65e6kernel\u591a\u4f7f\u75281\u4e2a\u5bc4\u5b58\u5668\uff0c\u90a3\u4e48\u5c31\u53ea\u80fd\u6709\u4e00\u4e2ablock\u53ef\u4ee5\u9a7b\u7559\uff0c\u56e0\u4e3a2\u4e2ablocks\u5219\u9700\u8981<code>2*512*65</code>\u4e2a\u5bc4\u5b58\u5668\uff0c\u8d85\u51fa\u4e86SM\u7684\u786c\u4ef6\u80fd\u529b\u3002\u56e0\u6b64\uff0c\u7f16\u8bd1\u5668\u8bd5\u56fe\u5728\u4fdd\u6301\u5bc4\u5b58\u5668\u6ea2\u51fa(\u53c2\u89c1 5.3.2 \u8bbe\u5907\u5185\u5b58\u8bbf\u95ee )\u548c\u6307\u4ee4\u6570\u91cf\u6700\u5c0f\u5316\u7684\u540c\u65f6\u6700\u5c0f\u5316\u5bc4\u5b58\u5668\u7684\u4f7f\u7528\u3002\u5bc4\u5b58\u5668\u4f7f\u7528\u53ef\u4ee5\u4f7f\u7528<code>maxrregcount</code>\u7f16\u8bd1\u9009\u9879\u548c\u542f\u52a8\u9650\u5236\uff08 B.23 \u542f\u52a8\u9650\u5b9a \uff09\u6765\u63a7\u5236\u3002</p> <p>\u5bc4\u5b58\u5668\u6587\u4ef6\u88ab\u7ec4\u7ec7\u4e3a32-bit\u5bc4\u5b58\u5668\uff0c\u6240\u4ee5\uff0c\u5bc4\u5b58\u5668\u4e2d\u5b58\u653e\u7684\u4efb\u4f55\u53d8\u91cf\u90fd\u9700\u8981\u81f3\u5c11\u4e00\u4e2a32-bit\u5bc4\u5b58\u5668\uff0c\u6bd4\u5982\u4e00\u4e2a<code>double</code>\u7c7b\u578b\u53d8\u91cf\u4f7f\u75282\u4e2a32-bit\u5bc4\u5b58\u5668\u3002</p> <p>\u5e94\u7528\u7a0b\u5e8f\u4e5f\u53ef\u4ee5\u57fa\u4e8e\u5bc4\u5b58\u5668\u6587\u4ef6\u5927\u5c0f\u548c\u5171\u4eab\u5185\u5b58\u7684\u5927\u5c0f\u8bbe\u7f6e\u542f\u52a8\u914d\u7f6e\uff08kernel\u542f\u52a8\u53c2\u6570\uff09\uff0c\u53d6\u51b3\u4e8e\u8bbe\u5907\u7684\u8ba1\u7b97\u80fd\u529b\uff0c\u4ee5\u53ca\u591a\u5904\u7406\u5668\u548c\u5185\u5b58\u5e26\u5bbd\u7684\u8bbe\u5907,\u6240\u6709\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u8fd0\u884c\u65f6\u67e5\u8be2\uff08\u89c1\u53c2\u8003\u624b\u518c\uff09\u3002</p> <p>\u5e94\u8be5\u5c06\u6bcf\u4e2a\u5757\u7684\u7ebf\u7a0b\u6570\u9009\u62e9\u4e3awarpSize\u7684\u500d\u6570\uff0c\u4ee5\u907f\u514d\u5c3d\u53ef\u80fd\u7531\u4e8ewarps\u4e0d\u8db3\u5bfc\u81f4\u7684\u8ba1\u7b97\u8d44\u6e90\u6d6a\u8d39\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#5231","title":"5.2.3.1 \u5360\u7528\u7387\u8ba1\u7b97\u5668","text":"<p>\u6709\u51e0\u4e2aAPI\u51fd\u6570\u53ef\u4ee5\u5e2e\u52a9\u7a0b\u5e8f\u5458\u6839\u636e\u5bc4\u5b58\u5668\u548c\u5171\u4eab\u5185\u5b58\u9700\u6c42\u9009\u62e9\u7ebf\u7a0b\u5757\u5927\u5c0f\u3002</p> <ul> <li>\u5360\u7528\u7387\u8ba1\u7b97\u5668API\uff0c<code>cudaOccupancyMaxActiveBlocksPerMultiprocessor()</code>\uff0c\u53ef\u4ee5\u63d0\u4f9b\u57fa\u4e8e\u5757\u5927\u5c0f\u548c\u5185\u6838\u5171\u4eab\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\u7684\u5360\u7528\u7387\u9884\u6d4b\u3002\u8be5\u51fd\u6570\u6839\u636e\u6bcf\u4e2a\u591a\u5904\u7406\u5668\u7684\u5e76\u53d1\u7ebf\u7a0b\u5757\u6570\u91cf\u62a5\u544a\u5360\u7528\u60c5\u51b5\u3002 <ul> <li>\u6ce8\u610f\uff0c\u8be5\u503c\u53ef\u4ee5\u8f6c\u6362\u4e3a\u5176\u4ed6\u6307\u6807\uff0c\u4e58\u4ee5\u6bcf\u4e2a\u5757\u7684warps\u6570\u91cf\u4f1a\u5f97\u51fa\u6bcf\u4e2a\u591a\u5904\u7406\u5668\u7684\u5e76\u53d1warps\u6570\u91cf\uff1b\u8fdb\u4e00\u6b65\u5c06\u5e76\u884cwarps\u6570\u9664\u4ee5\u6bcf\u4e2a\u591a\u5904\u7406\u5668\u7684\u6700\u5927warps\u6570\uff0c\u5f97\u51fa\u5360\u7528\u767e\u5206\u6bd4\u3002</li> </ul> </li> <li>\u57fa\u4e8e\u5360\u7528\u7387\u7684\u542f\u52a8\u914d\u7f6e\u5668API\uff0c<code>cudaOccupancyMaxPotentialBlockSize()</code>\u548c<code>cudaOccupancyMaxPotentialBlockSizeVariableSMem()</code>\uff0c\u542f\u53d1\u5f0f\u5730\uff08heuristically\uff09\u8ba1\u7b97\u53ef\u4ee5\u5b9e\u73b0\u6700\u5927\u591a\u5904\u7406\u5668\u7ea7\u522b\uff08Multiprocessor-Level\uff09\u5360\u7528\u7387\u7684\u6267\u884c\u914d\u7f6e\u3002</li> </ul> <pre><code>// Device code\n__global__ void MyKernel(int *d, int *a, int *b)\n{\n    int idx = threadIdx.x + blockIdx.x * blockDim.x;\n    d[idx] = a[idx] * b[idx];\n}\n\n// Host code\nint main()\n{\n    int numBlocks;        // Occupancy in terms of active blocks\n    int blockSize = 32;\n\n    // These variables are used to convert occupancy to warps\n    int device;\n    cudaDeviceProp prop;\n    int activeWarps;\n    int maxWarps;\n\n    cudaGetDevice(&amp;device);\n    cudaGetDeviceProperties(&amp;prop, device);\n\n    cudaOccupancyMaxActiveBlocksPerMultiprocessor(\n        &amp;numBlocks,\n        MyKernel,\n        blockSize,\n        0); // \u5f97\u5230numBlocks=32\uff0c\u56e0\u4e3a\u6700\u591a\u5141\u8bb8\u9a7b\u7559Blocks\u6570\u91cf\u4e3a32\u3002\n        // \u8fd9\u6837\u4e00\u4e2aSM\u4e2d\u53ea\u670932*32=1024\u4e2a\u7ebf\u7a0b\u9a7b\u7559\uff0c\u4f46\u662fSM\u6700\u591a\u5141\u8bb82048\u4e2a\u7ebf\u7a0b\u9a7b\u7559\uff0c\u6240\u4ee5\u5360\u7528\u7387\u4e3a50%\n\n    activeWarps = numBlocks * blockSize / prop.warpSize;\n    maxWarps = prop.maxThreadsPerMultiProcessor / prop.warpSize;\n\n    std::cout &lt;&lt; \"Occupancy: \" &lt;&lt; (double)activeWarps / maxWarps * 100 &lt;&lt; \"%\" &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre> <p>\u4ee5\u4e0b\u4ee3\u7801\u63d0\u4f9b\u4e86\u57fa\u4e8e\u5360\u7528\u7387\u7684\u542f\u52a8\u914d\u7f6e\uff1a <pre><code>// Device code\n__global__ void MyKernel(int *array, int arrayCount)\n{\n    int idx = threadIdx.x + blockIdx.x * blockDim.x;\n    if (idx &lt; arrayCount) {\n        array[idx] *= array[idx];\n    }\n}\n\n// Host code\nint launchMyKernel(int *array, int arrayCount)\n{\n    int blockSize;      // The launch configurator returned block size\n    int minGridSize;    // The minimum grid size needed to achieve the\n                        // maximum occupancy for a full device\n                        // launch\n    int gridSize;       // The actual grid size needed, based on input\n                        // size\n\n    cudaOccupancyMaxPotentialBlockSize(\n        &amp;minGridSize,\n        &amp;blockSize,\n        (void*)MyKernel,\n        0,\n        arrayCount);\n\n    // Round up according to array size\n    gridSize = (arrayCount + blockSize - 1) / blockSize;\n\n    MyKernel&lt;&lt;&lt;gridSize, blockSize&gt;&gt;&gt;(array, arrayCount);\n    cudaDeviceSynchronize();\n\n    // If interested, the occupancy can be calculated with\n    // cudaOccupancyMaxActiveBlocksPerMultiprocessor\n\n    return 0;\n}\n</code></pre></p> <p>CUDA\u5de5\u5177\u5305\u8fd8\u4e3a\u4e0d\u4f9d\u8d56CUDA\u8f6f\u4ef6\u5806\u6808\u7684\u4efb\u4f55\u7528\u4f8b\u63d0\u4f9b\u4e86\u4e00\u4e2a\u81ea\u6587\u6863\uff08self-documenting\uff09\u7684\u72ec\u7acb\u5360\u7528\u7387\u8ba1\u7b97\u5668\uff0c\u5e76\u5728 /include/cuda_occupancy.h\u4e2d\u542f\u52a8\u4e86\u542f\u52a8\u914d\u7f6e\u7a0b\u5e8f\u5b9e\u73b0\u3002\u8fd8\u63d0\u4f9b\u4e86\u7535\u5b50\u8868\u683c\u7248\u672c\u7684\u5360\u7528\u8ba1\u7b97\u5668\u3002\u7535\u5b50\u8868\u683c\u7248\u672c\u4f5c\u4e3a\u5b66\u4e60\u5de5\u5177\u7279\u522b\u6709\u7528\uff0c\u5b83\u53ef\u4ee5\u53ef\u89c6\u5316\u66f4\u6539\u5f71\u54cd\u5360\u7528\u7387\u7684\u53c2\u6570\uff08\u5757\u5927\u5c0f\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u5bc4\u5b58\u5668\u548c\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u5171\u4eab\u5185\u5b58\uff09\u7684\u5f71\u54cd\u3002"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#53-maximize-memory-throughput","title":"5.3 \u6700\u5927\u5316\u5185\u5b58\u541e\u5410\u91cf\uff08Maximize Memory Throughput\uff09","text":"<p>\u7b2c\u4e00\u6b65\u5c31\u662f\u8981\u51cf\u5c11\u4f4e\u5e26\u5bbd\u7684\u5185\u5b58\u4f20\u8f93\u3002</p> <p>\u6700\u5c0f\u5316\u4e3b\u673a-\u8bbe\u5907\u4e4b\u95f4\u7684\u5185\u5b58\u4f20\u8f93\uff0c\u56e0\u4e3a\u5b83\u6bd4\u5168\u5c40\u5185\u5b58\u5230\u8bbe\u5907\u7684\u5185\u5b58\u5e26\u5bbd\u8fd8\u8981\u4f4e\u3002</p> <p>\u6700\u5c0f\u5316\u5168\u5c40\u5185\u5b58\u4e8e\u8bbe\u5907\u7684\u5185\u5b58\u4f20\u8f93\uff0c\u6700\u5927\u5316\u8bbe\u5907\u7247\u4e0a\u5185\u5b58\u7684\u4f7f\u7528\uff1a\u5171\u4eab\u5185\u5b58\u3001\u9ad8\u901f\u7f13\u5b58\uff08\u4f8b\u5982\uff0cL1\u3001L2\u9ad8\u901f\u7f13\u5b58\u3001\u7eb9\u7406\u7f13\u5b58\u548c\u5e38\u91cf\u7f13\u5b58\uff09\u3002</p> <p>\u5171\u4eab\u5185\u5b58\u7b49\u6548\u4e8e\u7528\u6237\u7ba1\u7406\u7684\u7f13\u5b58\uff1a\u6700\u5e38\u89c1\u6a21\u5f0f\u662f\u5c06\u8bbe\u5907\u5185\u5b58\u5b58\u50a8\u5230\u5171\u4eab\u5185\u5b58\uff0c\u5bf9\u4e8eBlock\u4e2d\u7684\u4e00\u4e2a\u7ebf\u7a0b</p> <ul> <li>\u4ece\u8bbe\u5907\u5185\u5b58\u52a0\u8f7d\u6570\u636e\u5230\u5171\u4eab\u5185\u5b58\uff1b</li> <li>\u4e0e\u8be5\u5757\u7684\u6240\u6709\u5176\u4ed6\u7ebf\u7a0b\u540c\u6b65\uff0c\u4ee5\u4fbf\u6bcf\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u5b89\u5168\u5730\u8bfb\u53d6\u7531\u4e0d\u540c\u7ebf\u7a0b\u586b\u5145\u7684\u5171\u4eab\u5185\u5b58\u4f4d\u7f6e\uff1b</li> <li>\u5904\u7406\u5171\u4eab\u5185\u5b58\u7684\u6570\u636e\uff1b</li> <li>\u91cd\u65b0\u540c\u6b65\uff0c\u5982\u679c\u5fc5\u8981\u7684\u8bdd\uff0c\u4ee5\u786e\u4fdd\u5171\u4eab\u5185\u5b58\u7528\u6267\u884c\u7ed3\u679c\u66f4\u65b0\uff1b</li> <li>\u5c06\u7ed3\u679c\u5199\u56de\u8bbe\u5907\u5185\u5b58\u3002</li> </ul> <p>\u5bf9\u4e8e\u67d0\u4e9b\u5e94\u7528\u7a0b\u5e8f\uff08\u4f8b\u5982\uff0c\u5176\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u4e0e\u6570\u636e\u76f8\u5173\u7684\u5e94\u7528\u7a0b\u5e8f\uff09\uff0c\u4f20\u7edf\u7684\u786c\u4ef6\u7ba1\u7406\u7684\u7f13\u5b58\u66f4\u9002\u5408\u4e8e\u5229\u7528\u6570\u636e\u5c40\u90e8\u6027\u3002\u4f8b\u5982\u5bf9\u4e8e\u5177\u6709\u8ba1\u7b97\u80fd\u529b3.x\u548c7.x\u7684\u8bbe\u5907\uff0cL1\u548c\u5171\u4eab\u5185\u5b58\u4f7f\u7528\u76f8\u540c\u7684\u7247\u4e0a\u5185\u5b58\uff0c\u5e76\u4e14\u53ef\u4ee5\u4e3a\u6bcf\u6b21\u5185\u6838\u8c03\u7528\uff08kernel call\uff09\u914d\u7f6eL1\u4e0e\u5171\u4eab\u5185\u5b58\u3002</p> <p>\u5185\u6838\uff08kernel\uff09\u5bf9\u5b58\u50a8\u5668\u7684\u8bbf\u95ee\u541e\u5410\u91cf\u53ef\u80fd\u4f1a\u6839\u636e\u6bcf\u79cd\u7c7b\u578b\u7684\u5b58\u50a8\u5668\u7684\u8bbf\u95ee\u6a21\u5f0f\u800c\u76f8\u5dee\u4e00\u4e2a\u6570\u91cf\u7ea7\u3002\u56e0\u6b64\uff0c\u6700\u5927\u5316\u5185\u5b58\u541e\u5410\u91cf\u7684\u4e0b\u4e00\u6b65\u662f\u6839\u636e 5.3.2 \u8bbe\u5907\u5185\u5b58\u8bbf\u95ee \u4e2d\u63cf\u8ff0\u7684\u6700\u4f73\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\uff0c\u5c3d\u53ef\u80fd\u4f18\u5316\u5730\u7ec4\u7ec7\u5185\u5b58\u8bbf\u95ee\u3002\u8fd9\u79cd\u4f18\u5316\u5bf9\u4e8e\u5168\u5c40\u5b58\u50a8\u5668\u8bbf\u95ee\u5c24\u4e3a\u91cd\u8981\uff0c\u56e0\u4e3a\u4e0e\u53ef\u7528\u7684\u7247\u4e0a\u5e26\u5bbd\u548c\u7b97\u672f\u6307\u4ee4\u541e\u5410\u91cf\u76f8\u6bd4\uff0c\u5168\u5c40\u5b58\u50a8\u5668\u5e26\u5bbd\u8f83\u4f4e\uff0c\u56e0\u6b64\u975e\u6700\u4f18\u7684\u5168\u5c40\u5b58\u50a8\u5668\u8bbf\u95ee\u901a\u5e38\u4f1a\u5bf9\u6027\u80fd\u4ea7\u751f\u91cd\u5927\u5f71\u54cd\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#531-data-transfer-between-host-and-deive","title":"5.3.1 \u4e3b\u673a\u4e0e\u8bbe\u5907\u95f4\u7684\u6570\u636e\u4f20\u8f93\uff08Data Transfer between Host and Deive\uff09","text":"<p>\u5e94\u7528\u7a0b\u5e8f\u5e94\u52aa\u529b\u51cf\u5c11\u4e3b\u673a\u4e0e\u8bbe\u5907\u4e4b\u95f4\u7684\u6570\u636e\u4f20\u8f93\u3002\u4e00\u79cd\u5b9e\u73b0\u6b64\u76ee\u7684\u7684\u65b9\u6cd5\u662f\u5c06\u66f4\u591a\u4ee3\u7801\u4ece\u4e3b\u673a\u79fb\u81f3\u8bbe\u5907\uff0c\u5373\u4f7f\u8fd9\u610f\u5473\u7740\u8fd0\u884c\u7684\u5185\u6838\u66b4\u9732\u7684\u5e76\u884c\u6027\u4e0d\u8db3\u4ee5\u5728\u8bbe\u5907\u4e0a\u9ad8\u6548\u5730\u6267\u884c\u3002\u4e2d\u95f4\u6570\u636e\u7ed3\u6784\u53ef\u4ee5\u5728\u8bbe\u5907\u5185\u5b58\u4e2d\u521b\u5efa\uff0c\u7531\u8bbe\u5907\u64cd\u4f5c\u5e76\u9500\u6bc1\uff0c\u800c\u65e0\u9700\u4e3b\u673a\u6620\u5c04\u6216\u590d\u5236\u5230\u4e3b\u673a\u5185\u5b58\u3002</p> <p>\u540c\u6837\uff0c\u7531\u4e8e\u4e0e\u6bcf\u4e2a\u4f20\u8f93\u76f8\u5173\u7684\u5f00\u9500\uff0c\u5c06\u8bb8\u591a\u5c0f\u4f20\u8f93\u6279\u91cf\u6210\u4e00\u4e2a\u5927\u4f20\u8f93\u603b\u662f\u6bd4\u5355\u72ec\u8fdb\u884c\u6bcf\u4e2a\u4f20\u8f93\u66f4\u597d\u3002</p> <p>\u5728\u5177\u6709\u524d\u7aef\u603b\u7ebf\uff08front-side bus\uff09\u7684\u7cfb\u7edf\u4e0a\uff0c\u5982 3.2.4 \u9875\u9501\u5b9a\u4e3b\u673a\u5185\u5b58 \u4e2d\u6240\u8ff0\uff0c\u901a\u8fc7\u4f7f\u7528\u9875\u9501\u5b9a\u4e3b\u673a\u5185\u5b58\u53ef\u4ee5\u5b9e\u73b0\u4e3b\u673a\u4e0e\u8bbe\u5907\u4e4b\u95f4\u66f4\u9ad8\u7684\u6570\u636e\u4f20\u8f93\u6027\u80fd\u3002</p> <p>\u6b64\u5916\uff0c\u4f7f\u7528\u6620\u5c04\u7684\u9875\u9762\u9501\u5b9a\u5185\u5b58\uff083.2.4.3 \u6620\u5c04\u5185\u5b58\uff09\u65f6\uff0c\u65e0\u9700\u5206\u914d\u4efb\u4f55\u8bbe\u5907\u5185\u5b58\uff0c\u4e5f\u65e0\u9700\u5728\u8bbe\u5907\u548c\u4e3b\u673a\u5185\u5b58\u4e4b\u95f4\u663e\u5f0f\u590d\u5236\u6570\u636e\u3002\u6bcf\u6b21\u5185\u6838\u8bbf\u95ee\u6620\u5c04\u7684\u5185\u5b58\u65f6\uff0c\u90fd\u4f1a\u9690\u5f0f\u6267\u884c\u6570\u636e\u4f20\u8f93\u3002\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u6027\u80fd\uff0c\u5fc5\u987b\u5c06\u8fd9\u4e9b\u5185\u5b58\u8bbf\u95ee\u4e0e\u5bf9\u5168\u5c40\u5185\u5b58\u7684\u8bbf\u95ee\u5408\u5e76\u5728\u4e00\u8d77\uff08\u8bf7\u53c2\u9605 \u8bbe\u5907\u5185\u5b58\u8bbf\u95ee\uff09\u3002\u5047\u8bbe\u5b83\u4eec\u90fd\u662f\uff0c\u5e76\u4e14\u6620\u5c04\u7684\u5185\u5b58\u53ea\u80fd\u8bfb\u53d6\u6216\u5199\u5165\u4e00\u6b21\uff0c\u5219\u4f7f\u7528\u6620\u5c04\u7684\u9875\u9762\u9501\u5b9a\u5185\u5b58\u800c\u4e0d\u662f\u5728\u8bbe\u5907\u548c\u4e3b\u673a\u5185\u5b58\u4e4b\u95f4\u8fdb\u884c\u663e\u5f0f\u590d\u5236\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002</p> <p>\u5728\u8bbe\u5907\u5185\u5b58\u548c\u4e3b\u673a\u5185\u5b58\u5728\u7269\u7406\u4e0a\u76f8\u540c\u7684\u96c6\u6210\u7cfb\u7edf\u4e0a\uff0c\u4e3b\u673a\u548c\u8bbe\u5907\u5185\u5b58\u4e4b\u95f4\u7684\u4efb\u4f55\u526f\u672c\u90fd\u662f\u591a\u4f59\u7684\uff0c\u5e94\u6539\u7528\u6620\u5c04\u7684\u9875\u9501\u5185\u5b58\u3002\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u68c0\u67e5\u96c6\u6210\u8bbe\u5907\u5c5e\u6027\uff08\u8bf7\u53c2\u9605 \u8bbe\u5907\u679a\u4e3e \uff09\u7b49\u4e8e1\u6765\u67e5\u8be2\u8bbe\u5907\u662f\u5426\u662f\u96c6\u6210\uff08<code>integrated</code>\uff09\u7684\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#532-device-memory-access","title":"5.3.2 \u8bbe\u5907\u5185\u5b58\u8bbf\u95ee\uff08Device Memory Access\uff09","text":"<p>\u53ef\u80fd\u8bbf\u95ee\u53ef\u5bfb\u5740\u5185\u5b58\uff08\u5373\u5168\u5c40\uff0c\u672c\u5730\uff0c\u5171\u4eab\uff0c\u5e38\u91cf\u6216\u7eb9\u7406\u5185\u5b58\uff09\u7684\u6307\u4ee4\u9700\u8981\u91cd\u65b0\u53d1\u51fa\u591a\u6b21\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7ebf\u7a0b\u675f\u4e2d\u7ebf\u7a0b\u4e4b\u95f4\u5185\u5b58\u5730\u5740\u7684\u5206\u5e03\u3002\u5206\u5e03\u5982\u4f55\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u5f71\u54cd\u6307\u4ee4\u541e\u5410\u91cf\u7279\u5b9a\u4e8e\u6bcf\u79cd\u7c7b\u578b\u7684\u5b58\u50a8\u5668\uff0c\u5e76\u5c06\u5728\u4ee5\u4e0b\u5404\u8282\u4e2d\u8fdb\u884c\u4ecb\u7ecd\u3002\u4f8b\u5982\uff0c\u5bf9\u4e8e\u5168\u5c40\u5b58\u50a8\u5668\uff0c\u901a\u5e38\uff0c\u5730\u5740\u8d8a\u5206\u6563\uff0c\u541e\u5410\u91cf\u5c31\u8d8a\u964d\u4f4e\u3002</p> <p>\u5168\u5c40\u5185\u5b58</p> <p>\u5168\u5c40\u5185\u5b58\u9a7b\u7559\u5728\u8bbe\u5907\u5185\u5b58\u4e2d\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc732\u300164\u6216128\u5b57\u8282\u7684\u5185\u5b58\u4e8b\u52a1\u8bbf\u95ee\u8bbe\u5907\u5185\u5b58\u3002\u8fd9\u4e9b\u5185\u5b58\u4e8b\u52a1\u5fc5\u987b\u81ea\u7136\u5bf9\u9f50\uff1a\u5185\u5b58\u53ea\u80fd\u8bfb\u53d6\u6216\u5199\u5165\u4e0e\u5176\u5927\u5c0f\u5bf9\u9f50\u768432\u300164\u6216128\u5b57\u8282\u7684\u8bbe\u5907\u5185\u5b58\u6bb5\uff08\u5373\uff0c\u5176\u9996\u5730\u5740\u662f\u5176\u5927\u5c0f\u7684\u500d\u6570\uff09\u3002</p> <p>\u5f53warp\u6267\u884c\u8bbf\u95ee\u5168\u5c40\u5185\u5b58\u7684\u6307\u4ee4\u65f6\uff0c\u5b83\u4f1a\u6839\u636e\u6bcf\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u7684\u5b57\u7684\u5927\u5c0f\u4ee5\u53ca\u7ebf\u7a0b\u8bbf\u95ee\u95f4\u7684\u7684\u5185\u5b58\u5730\u5740\u5206\u5e03\uff0c\u5c06warp\u4e2d\u7ebf\u7a0b\u7684\u5185\u5b58\u8bbf\u95ee\u5408\u5e76\u4e3a\u4e00\u4e2a\u6216\u591a\u4e2a\u8fd9\u4e9b\u5185\u5b58\u4e8b\u52a1\u3002\u901a\u5e38\uff0c\u9700\u8981\u7684\u4e8b\u52a1\u8d8a\u591a\uff0c\u9664\u4e86\u7ebf\u7a0b\u8bbf\u95ee\u7684\u5b57\u4e4b\u5916\u4f20\u8f93\u7684\u672a\u4f7f\u7528\u7684\u5b57\u8d8a\u591a\uff0c\u4ece\u800c\u76f8\u5e94\u5730\u964d\u4f4e\u4e86\u6307\u4ee4\u541e\u5410\u91cf\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u76844\u5b57\u8282\u8bbf\u95ee\u751f\u6210\u4e8632\u5b57\u8282\u7684\u5185\u5b58\u4e8b\u52a1\uff0c\u90a3\u4e48\u541e\u5410\u91cf\u5c06\u9664\u4ee58\u3002</p> <p>\u6700\u5927\u5316\u5185\u5b58\u5408\u5e76\u65b9\u5f0f\u5982\u4e0b\uff1a</p> <ul> <li>\u9075\u5faa\u4e0d\u540c\u8ba1\u7b97\u80fd\u529b\u7684\u6700\u4f18\u8bbf\u95ee\u6a21\u5f0f\uff0c\u53c2\u89c1 H.3. Compute Capabilities 3.x \u7b49\u3002</li> <li>\u4f7f\u7528\u5b57\u8282\u5bf9\u9f50\u7684\u6570\u636e\u7c7b\u578b\u3002</li> <li>\u67d0\u4e9b\u60c5\u51b5\u4e0b\u9002\u5f53\u586b\u5145\u6570\u636e\uff0c\u6bd4\u5982\u4e0b\u9762\u7684\u201c\u4e8c\u7ef4\u6570\u7ec4\u201d\u90e8\u5206\u6240\u8ff0\u8bbf\u95ee\u4e8c\u7ef4\u6570\u7ec4\u65f6\u3002</li> </ul> <p>\u5927\u5c0f\u548c\u5bf9\u9f50\u8981\u6c42</p> <p>\u5168\u5c40\u5b58\u50a8\u5668\u6307\u4ee4\u652f\u6301\u8bfb\u53d6\u6216\u5199\u5165\u5927\u5c0f\u7b49\u4e8e1\u30012\u30014\u30018\u621616\u4e2a\u5b57\u8282\u7684\u5b57\u3002\u5f53\u4e14\u4ec5\u5f53\u6570\u636e\u7c7b\u578b\u7684\u5927\u5c0f\u4e3a1\u30012\u30014\u30018\u621616\u4e2a\u5b57\u8282\u5e76\u4e14\u81ea\u7136\u662f\u81ea\u7136\u6570\u636e\u65f6\uff0c\u5bf9\u5168\u5c40\u5185\u5b58\u4e2d\u6570\u636e\u7684\u4efb\u4f55\u8bbf\u95ee\uff08\u901a\u8fc7\u53d8\u91cf\u6216\u6307\u9488\uff09\u90fd\u4f1a\u7f16\u8bd1\u4e3a\u5355\u4e2a\u5168\u5c40\u5185\u5b58\u6307\u4ee4\u5bf9\u9f50\uff08\u5373\uff0c\u5176\u5730\u5740\u662f\u8be5\u5927\u5c0f\u7684\u500d\u6570\uff09\u3002</p> <p>\u5982\u679c\u672a\u6ee1\u8db3\u6b64\u5927\u5c0f\u548c\u5bf9\u9f50\u8981\u6c42\uff0c\u5219\u8bbf\u95ee\u5c06\u7f16\u8bd1\u4e3a\u5177\u6709\u4ea4\u9519\u8bbf\u95ee\u6a21\u5f0f\u7684\u591a\u4e2a\u6307\u4ee4\uff0c\u4ece\u800c\u963b\u6b62\u8fd9\u4e9b\u6307\u4ee4\u5b8c\u5168\u5408\u5e76\u3002\u56e0\u6b64\uff0c\u5efa\u8bae\u5bf9\u9a7b\u7559\u5728\u5168\u5c40\u5185\u5b58\u4e2d\u7684\u6570\u636e\u4f7f\u7528\u7b26\u5408\u6b64\u8981\u6c42\u7684\u7c7b\u578b\u3002</p> <p>\u5185\u7f6e\u5411\u91cf\u7c7b\u578b \u4f1a\u81ea\u52a8\u6ee1\u8db3\u5bf9\u9f50\u8981\u6c42\u3002</p> <p>\u5bf9\u4e8e\u7ed3\u6784\u4f53\uff0c\u7f16\u8bd1\u5668\u53ef\u4ee5\u4f7f\u7528\u5bf9\u9f50\u8bf4\u660e\u7b26<code>__align __(8)</code>\u6216<code>__align __(16)</code>\u6765\u5f3a\u5236\u6267\u884c\u5927\u5c0f\u548c\u5bf9\u9f50\u8981\u6c42\uff0c\u4f8b\u5982 <pre><code>struct __align__(8) {\n    float x;\n    float y;\n};\n</code></pre> \u6216 <pre><code>struct __align__(16) {\n    float x;\n    float y;\n    float z;\n};\n</code></pre> \u9a7b\u7559\u5728\u5168\u5c40\u5185\u5b58\u4e2d\u6216\u7531\u9a71\u52a8\u7a0b\u5e8f\u6216\u8fd0\u884c\u65f6API\u7684\u5185\u5b58\u5206\u914d\u60ef\u4f8b\u4e4b\u4e00\u8fd4\u56de\u7684\u53d8\u91cf\u7684\u4efb\u4f55\u5730\u5740\u59cb\u7ec8\u81f3\u5c11\u4e0e256\u4e2a\u5b57\u8282\u5bf9\u9f50\u3002</p> <p>\u8bfb\u53d6\u975e\u81ea\u7136\u5bf9\u9f50\u76848\u5b57\u8282\u621616\u5b57\u8282\u5b57\u4f1a\u4ea7\u751f\u9519\u8bef\u7684\u7ed3\u679c\uff08\u504f\u79fb\u51e0\u4e2a\u5b57\uff09\uff0c\u56e0\u6b64\u5fc5\u987b\u7279\u522b\u6ce8\u610f\u4fdd\u6301\u8fd9\u4e9b\u7c7b\u578b\u7684\u4efb\u4f55\u503c\u6216\u503c\u6570\u7ec4\u7684\u8d77\u59cb\u5730\u5740\u7684\u5bf9\u9f50\u3002\u4e00\u4e2a\u53ef\u80fd\u5bb9\u6613\u88ab\u5ffd\u7565\u7684\u5178\u578b\u60c5\u51b5\u662f\uff0c\u4f7f\u7528\u67d0\u4e9b\u81ea\u5b9a\u4e49\u5168\u5c40\u5185\u5b58\u5206\u914d\u65b9\u6848\u65f6\uff0c\u591a\u4e2a\u6570\u7ec4\u7684\u5206\u914d\uff08\u5bf9<code>cudaMalloc()</code>\u6216<code>cuMemAlloc()</code>\u7684\u591a\u6b21\u8c03\u7528\uff09\u88ab\u5355\u4e2a\u5927\u5185\u5b58\u5757\u7684\u5206\u914d\u6240\u53d6\u4ee3\u5212\u5206\u4e3a\u591a\u4e2a\u6570\u7ec4\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u6570\u7ec4\u7684\u8d77\u59cb\u5730\u5740\u90fd\u504f\u79bb\u5757\u7684\u8d77\u59cb\u5730\u5740\u3002</p> <p>\u4e8c\u7ef4\u6570\u7ec4</p> <p>\u4e00\u79cd\u5e38\u89c1\u7684\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\u6a21\u5f0f\u662f\uff0c\u5f53\u7d22\u5f15(tx\uff0cty)\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u4f7f\u7528\u4ee5\u4e0b\u5730\u5740\u8bbf\u95ee\u5bbd\u5ea6\u4e3a2D\u76842D\u6570\u7ec4\u7684\u4e00\u4e2a\u5143\u7d20\u65f6\uff0c\u8be5\u5143\u7d20\u4f4d\u4e8e\u7c7b\u578b\u4e3a<code>type*</code>\u7684\u5730\u5740BaseAddress\u4e0a\uff08\u5176\u4e2d\u7c7b\u578b\u6ee1\u8db3 5.2 \u6700\u5927\u5316\u5229\u7528\u7387 \u4e2d\u63cf\u8ff0\u7684\u8981\u6c42\uff09\u5229\u7528\u7387\uff09\uff1a <pre><code>BaseAddress + width * ty + tx\n</code></pre> \u4e3a\u4e86\u4f7f\u8fd9\u4e9b\u8bbf\u95ee\u5b8c\u5168\u5408\u5e76\uff0c\u7ebf\u7a0b\u5757\u7684\u5bbd\u5ea6\u548c\u6570\u7ec4\u7684\u5bbd\u5ea6\u90fd\u5fc5\u987b\u662fwarp\u5927\u5c0f\u7684\u500d\u6570\u3002</p> <p>\u7279\u522b\u5730\uff0c\u8fd9\u610f\u5473\u7740\u5982\u679c\u5bbd\u5ea6\u5b9e\u9645\u4e0d\u7b49\u4e8e\u8be5\u5927\u5c0f\u500d\u6570\u7684\u6570\u7ec4\u88ab\u820d\u5165\u5230\u8be5\u5927\u5c0f\u7684\u6700\u63a5\u8fd1\u500d\u6570\u5e76\u76f8\u5e94\u5730\u586b\u5145\u5176\u884c\uff0c\u5219\u5c06\u66f4\u6709\u6548\u5730\u8bbf\u95ee\u5bbd\u5ea6\u4e0d\u662f\u8be5\u5927\u5c0f\u500d\u6570\u7684\u6570\u7ec4\u3002\u53c2\u8003\u624b\u518c\u4e2d\u4ecb\u7ecd\u7684<code>cudaMallocPitch()</code>\u548c<code>cuMemAllocPitch()</code>\u51fd\u6570\u4ee5\u53ca\u76f8\u5173\u7684\u5185\u5b58\u590d\u5236\u51fd\u6570\u4f7f\u7a0b\u5e8f\u5458\u80fd\u591f\u7f16\u5199\u4e0e\u786c\u4ef6\u65e0\u5173\u7684\u4ee3\u7801\u6765\u5206\u914d\u7b26\u5408\u8fd9\u4e9b\u7ea6\u675f\u7684\u6570\u7ec4\u3002</p> <p>\u672c\u5730\u5185\u5b58</p> <p>\u672c\u5730\u5b58\u50a8\u5668\u8bbf\u95ee\u4ec5\u9488\u5bf9\u67d0\u4e9b\u81ea\u52a8\u53d8\u91cf\u53d1\u751f\uff0c\u5982 \u53d8\u91cf\u5b58\u50a8\u5668\u7a7a\u95f4\u8bf4\u660e\u7b26 \u4e2d\u6240\u8ff0\u3002\u7f16\u8bd1\u5668\u53ef\u80fd\u653e\u7f6e\u5728\u672c\u5730\u5185\u5b58\u4e2d\u7684\u81ea\u52a8\u53d8\u91cf\u662f\uff1a</p> <ul> <li>\u65e0\u6cd5\u786e\u5b9a\u4e3a\u5176\u5b9a\u5e8f\u7d22\u5f15\u7684\u6570\u7ec4\uff1b</li> <li>\u4f1a\u5360\u7528\u8fc7\u591a\u7684\u5bc4\u5b58\u5668\u7a7a\u95f4\u7684\u5927\u578b\u7ed3\u6784\u4f53\u6216\u6570\u7ec4\uff1b</li> <li>\u5185\u6838\u4f7f\u7528\u7684\u5bc4\u5b58\u5668\u591a\u4e8e\u53ef\u7528\u5bc4\u5b58\u5668\u65f6\u7684\u4efb\u4f55\u53d8\u91cf\uff08\u8fd9\u4e5f\u79f0\u4e3a\u5bc4\u5b58\u5668\u6ea2\u51fa\uff09\u3002</li> </ul> <p>\u68c0\u67e5PTX\u6c47\u7f16\u4ee3\u7801\uff08\u901a\u8fc7\u4f7f\u7528-ptx\u6216-keep\u9009\u9879\u8fdb\u884c\u7f16\u8bd1\u83b7\u5f97\uff09\u53ef\u5f97\u77e5\u5728\u7b2c\u4e00\u4e2a\u7f16\u8bd1\u9636\u6bb5\u662f\u5426\u5df2\u5c06\u53d8\u91cf\u653e\u7f6e\u5728\u672c\u5730\u5185\u5b58\u4e2d\uff0c\u56e0\u4e3a\u5c06\u4f7f\u7528<code>.local</code>\u52a9\u8bb0\u7b26\u58f0\u660e\u8be5\u53d8\u91cf\uff0c\u5e76\u4f7f\u7528<code>ld.local</code>\u548c<code>st.local</code>\u52a9\u8bb0\u7b26\u8bbf\u95ee\u8be5\u53d8\u91cf\u3002 \u5373\u4f7f\u7b2c\u4e00\u7f16\u8bd1\u9636\u6bb5\u6ca1\u6709\u4f7f\u7528\u672c\u5730\u5185\u5b58\uff0c\u5982\u679c\u968f\u540e\u7684\u7f16\u8bd1\u9636\u6bb5\u53d1\u73b0\u5b83\u4eec\u6d88\u8017\u4e86\u76ee\u6807\u4f53\u7cfb\u7ed3\u6784\u8fc7\u591a\u7684\u5bc4\u5b58\u5668\u7a7a\u95f4\uff0c\u540e\u7eed\u7684\u7f16\u8bd1\u9636\u6bb5\u4ecd\u53ef\u80fd\u4f1a\u505a\u51fa\u5176\u4ed6\u51b3\u5b9a\uff1a\u4f7f\u7528<code>cuobjdump</code>\u68c0\u67e5<code>cubin</code>\u5bf9\u8c61\u5c06\u786e\u5b9a\u662f\u5426\u662f\u8fd9\u79cd\u60c5\u51b5\u3002\u53e6\u5916\uff0c\u4f7f\u7528<code>--ptxas-options = -v</code>\u9009\u9879\u8fdb\u884c\u7f16\u8bd1\u65f6\uff0c\u7f16\u8bd1\u5668\u4f1a\u62a5\u544a\u6bcf\u4e2akernel\uff08<code>lmem</code>\uff09\u7684\u672c\u5730\u5185\u5b58\u603b\u4f7f\u7528\u91cf\u3002\u8bf7\u6ce8\u610f\uff0c\u67d0\u4e9b\u6570\u5b66\u51fd\u6570\u7684\u5b9e\u73b0\u8def\u5f84\u53ef\u80fd\u4f1a\u8bbf\u95ee\u672c\u5730\u5185\u5b58\u3002</p> <p>\u672c\u5730\u5185\u5b58\u7a7a\u95f4\u4f4d\u4e8e\u8bbe\u5907\u5185\u5b58\u4e2d\uff0c\u56e0\u6b64\u672c\u5730\u5185\u5b58\u8bbf\u95ee\u5177\u6709\u4e0e\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\u76f8\u540c\u7684\u9ad8\u5ef6\u8fdf\u548c\u4f4e\u5e26\u5bbd\uff0c\u5e76\u4e14\u8981\u9075\u5faa\u4e0e 5.3.2 \u8bbe\u5907\u5185\u5b58\u8bbf\u95ee \u4e2d\u6240\u8ff0\u7684\u5185\u5b58\u5408\u5e76\u76f8\u540c\u7684\u8981\u6c42\u3002\u4f46\u662f\uff0c\u5bf9\u672c\u5730\u5185\u5b58\u8fdb\u884c\u4e86\u7ec4\u7ec7\uff0c\u4ee5\u4fbf\u8fde\u7eed\u7684\u7ebf\u7a0bID\u8bbf\u95ee\u8fde\u7eed\u768432\u4f4d\u5b57\u3002\u56e0\u6b64\uff0c\u53ea\u8981warp\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u90fd\u8bbf\u95ee\u76f8\u540c\u7684\u76f8\u5bf9\u5730\u5740\uff08\u4f8b\u5982\uff0c\u6570\u7ec4\u53d8\u91cf\u4e2d\u7684\u76f8\u540c\u7d22\u5f15\uff0c\u7ed3\u6784\u53d8\u91cf\u4e2d\u7684\u76f8\u540c\u6210\u5458\uff09\uff0c\u8bbf\u95ee\u5c31\u4f1a\u5b8c\u5168\u5408\u5e76\u3002</p> <p>\u5728\u67d0\u4e9b\u5177\u6709\u8ba1\u7b97\u80fd\u529b3.x\u7684\u8bbe\u5907\u4e0a\uff0c\u672c\u5730\u5185\u5b58\u8bbf\u95ee\u603b\u662f\u4ee5\u4e0e\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\u76f8\u540c\u7684\u65b9\u5f0f\u7f13\u5b58\u5728L1\u548cL2\u4e2d\uff08\u8bf7\u53c2\u9605 Compute Capability 3.x\uff09\u3002</p> <p>\u5728\u5177\u67095.x\u548c6.x\u8ba1\u7b97\u80fd\u529b\u7684\u8bbe\u5907\u4e0a\uff0c\u672c\u5730\u5185\u5b58\u8bbf\u95ee\u603b\u662f\u4ee5\u4e0e\u5168\u5c40\u5185\u5b58\u8bbf\u95ee\u76f8\u540c\u7684\u65b9\u5f0f\u7f13\u5b58\u5728L2\u4e2d\uff08\u8bf7\u53c2\u9605 Compute Capability 5.x \u548c Compute Capability 6.x \uff09\u3002</p> <p>\u5171\u4eab\u5185\u5b58</p> <p>\u56e0\u4e3a\u5171\u4eab\u5185\u5b58\u5728\u82af\u7247\u4e0a\uff0c\u6240\u4ee5\u5b83\u6bd4\u672c\u5730\u6216\u5168\u5c40\u5185\u5b58\u5177\u6709\u66f4\u9ad8\u7684\u5e26\u5bbd\u548c\u66f4\u4f4e\u7684\u5ef6\u8fdf\u3002</p> <p>\u4e3a\u4e86\u83b7\u5f97\u9ad8\u5e26\u5bbd\uff0c\u5171\u4eab\u5185\u5b58\u88ab\u5206\u4e3a\u5927\u5c0f\u76f8\u7b49\u7684\u5b58\u50a8\u6a21\u5757\uff0c\u79f0\u4e3a\u5b58\u50a8\u4f53\uff08<code>banks</code>\uff09\uff0c\u53ef\u4ee5\u540c\u65f6\u8bbf\u95ee\u5b83\u4eec\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u7531\u843d\u5728n\u4e2a\u4e0d\u540c\u7684\u5b58\u50a8\u4f53\u4e2d\u7684n\u4e2a\u5730\u5740\u7ec4\u6210\u7684\u4efb\u4f55\u5b58\u50a8\u5668\u8bfb\u6216\u5199\u8bf7\u6c42\uff0c\u4ece\u800c\u4ea7\u751f\u7684\u6574\u4f53\u5e26\u5bbd\u662f\u5355\u4e2a\u6a21\u5757\u7684\u5e26\u5bbd\u7684n\u500d\u3002</p> <p>\u4f46\u662f\uff0c\u5982\u679c\u4e00\u4e2a\u5185\u5b58\u8bf7\u6c42\u7684\u4e24\u4e2a\u5730\u5740\u4f4d\u4e8e\u540c\u4e00\u4e2a\u5b58\u50a8\u4f53\u4e2d\uff0c\u5219\u5b58\u5728\u5b58\u50a8\u4f53\u51b2\u7a81\uff08<code>bank conflicts</code>\uff09\uff0c\u8bbf\u95ee\u5c06\u88ab\u5e8f\u5217\u5316\u3002\u786c\u4ef6\u5c06\u5177\u6709\u5b58\u50a8\u4f53\u51b2\u7a81\u7684\u5185\u5b58\u8bf7\u6c42\u62c6\u5206\u4e3a\u5c3d\u53ef\u80fd\u591a\u7684\u5355\u72ec\u7684\u65e0\u51b2\u7a81\u8bf7\u6c42\uff0c\u4ece\u800c\u5c06\u541e\u5410\u91cf\u964d\u4f4e\u4e86\u7b49\u4e8e\u5355\u72ec\u7684\u5185\u5b58\u8bf7\u6c42\u6570\u91cf\u7684\u500d\u6570\u3002\u5982\u679c\u5355\u72ec\u7684\u5185\u5b58\u8bf7\u6c42\u7684\u6570\u91cf\u4e3an\uff0c\u5219\u79f0\u521d\u59cb\u5185\u5b58\u8bf7\u6c42\u5f15\u8d77n\u8def\u5b58\u50a8\u4f53\u51b2\u7a81\uff08n-way bank conflicts\uff09\u3002</p> <p>\u56e0\u6b64\uff0c\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u6027\u80fd\uff0c\u91cd\u8981\u7684\u662f\u8981\u4e86\u89e3\u5185\u5b58\u5730\u5740\u5982\u4f55\u6620\u5c04\u5230\u5185\u5b58\u5e93\uff0c\u4ee5\u4fbf\u8c03\u5ea6\u5185\u5b58\u8bf7\u6c42\uff0c\u4ece\u800c\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u5e93\u51b2\u7a81\u3002\u8fd9\u5206\u522b\u5728  Compute Capability 3.x, Compute Capability 5.x, Compute Capability 6.x, \u548c Compute Capability 7.x \u4e2d\u63cf\u8ff0\u3002 </p> <p>\u731c\u6d4b\uff1a\u8bbf\u95ee\u540c\u4e00<code>bank</code>\u4e2d\u4e0d\u540c\u7684\u5185\u5b58\u4f4d\u7f6e\u4f1a\u53d1\u751f<code>bank conflict</code>\uff0c\u672c\u8d28\u53ef\u80fd\u662f\u8bbf\u5b58\u6307\u4ee4\u7684\u4e0d\u540c\u3002\u4ece\u6570\u5b57\u7535\u8def\u4e0a\u770b\uff0c\u8bbf\u5b58\u53ef\u80fd\u662f\u903b\u8f91\u95e8\uff08\u4f8b\u5982\u5f02\u6216\u95e8\uff09\u7535\u8def\u5b9e\u73b0\u7684\uff0c\u6bd4\u5982\u8bfb\u53d68-bit\u7684\u524d\u534a\u90e8\u5206\u5219\u5c06\u524d4-bit\u7684\u8f93\u5165\u7aef\u8bbe\u7f6e\u4e3a0\uff0c\u6307\u4ee4\u4e3a<code>00001111</code>\uff1b\u8bfb\u53d6\u540e\u534a\u90e8\u5206\uff0c\u5219\u6307\u4ee4\u4e3a<code>11110000</code>\u3002\u5982\u679cwarp\u4e2d\u4e24\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u5b58\uff0c\u90a3\u4e48\u5c31\u5fc5\u987b\u4e32\u884c\u3002</p> <p>\u5e38\u91cf\u5185\u5b58</p> <p>\u5e38\u91cf\u5185\u5b58\u7a7a\u95f4\u9a7b\u7559\u5728\u8bbe\u5907\u5185\u5b58\u4e2d\uff0c\u5e76\u7f13\u5b58\u5728\u5e38\u91cf\u7f13\u5b58\u4e2d\u3002</p> <p>\u5982\u679c\u5c06\u4e00\u6b21\u8bf7\u6c42\u62c6\u5206\u6210\u4e0e\u521d\u6b21\u8bf7\u6c42\u65f6\u4e0d\u540c\u5185\u5b58\u5730\u5740\u6570\u91cf\u4e00\u6837\u591a\u7684\u5355\u72ec\u8bf7\u6c42\uff0c\u541e\u5410\u91cf\u5c06\u964d\u4f4e\u5355\u72ec\u8bf7\u6c42\u6570\u91cf\u7684\u500d\u6570\u3002</p> <p>\u7eb9\u7406\u4e0e\u8868\u9762\u5185\u5b58</p> <p>\u7eb9\u7406\u548c\u8868\u9762\u5b58\u50a8\u7a7a\u95f4\u9a7b\u7559\u5728\u8bbe\u5907\u5185\u5b58\u4e2d\uff0c\u5e76\u7f13\u5b58\u5728\u7eb9\u7406\u7f13\u5b58\u4e2d\uff0c\u56e0\u6b64\u7eb9\u7406\u83b7\u53d6\u6216\u8868\u9762\u8bfb\u53d6\u4ec5\u5728\u4e00\u6b21\u9ad8\u901f\u7f13\u5b58\u672a\u547d\u4e2d\u65f6\u624d\u8017\u8d39\u4e00\u6b21\u8bbe\u5907\u5185\u5b58\u8bfb\u53d6\uff0c\u5426\u5219\u4ec5\u82b1\u8d39\u4e00\u6b21\u7eb9\u7406\u7f13\u5b58\u8bfb\u53d6\u3002\u7eb9\u7406\u7f13\u5b58\u9488\u5bf92D\u7a7a\u95f4\u5c40\u90e8\u6027\u8fdb\u884c\u4e86\u4f18\u5316\uff0c\u56e0\u6b64\u76f8\u540cwarp\u7684\u7ebf\u7a0b\u8bfb\u53d62D\u4e2d\u7d27\u9760\u5728\u4e00\u8d77\u7684\u7eb9\u7406\u6216\u8868\u9762\u5730\u5740\u5c06\u83b7\u5f97\u6700\u4f73\u6027\u80fd\u3002\u6b64\u5916\uff0c\u5b83\u8fd8\u8bbe\u8ba1\u7528\u4e8e\u5177\u6709\u6052\u5b9a\u5ef6\u8fdf\u7684\u6d41\u5f0f\u83b7\u53d6\u3002\u9ad8\u901f\u7f13\u5b58\u547d\u4e2d\u51cf\u5c11\u4e86DRAM\u5e26\u5bbd\u9700\u6c42\uff0c\u4f46\u6ca1\u6709\u83b7\u53d6\u5ef6\u8fdf\u3002</p> <p>\u901a\u8fc7\u7eb9\u7406\u6216\u8868\u9762\u8bfb\u53d6\u6765\u8bfb\u53d6\u8bbe\u5907\u5185\u5b58\u5177\u6709\u4e00\u4e9b\u597d\u5904\uff0c\u53ef\u4ee5\u4f7f\u5176\u6210\u4e3a\u4ece\u5168\u5c40\u6216\u5e38\u91cf\u5185\u5b58\u4e2d\u8bfb\u53d6\u8bbe\u5907\u5185\u5b58\u7684\u6709\u5229\u66ff\u4ee3\u65b9\u6848\uff1a</p> <ul> <li>\u5982\u679c\u5b58\u50a8\u5668\u8bfb\u53d6\u4e0d\u9075\u5faa\u4e3a\u83b7\u5f97\u826f\u597d\u6027\u80fd\u800c\u5fc5\u987b\u9075\u5faa\u7684\u5168\u5c40\u6216\u6052\u5b9a\u5b58\u50a8\u5668\u8bfb\u53d6\u7684\u8bbf\u95ee\u6a21\u5f0f\uff0c\u5219\u53ef\u4ee5\u63d0\u4f9b\u66f4\u9ad8\u7684\u5e26\u5bbd\uff0c\u524d\u63d0\u662f\u7eb9\u7406\u8bfb\u53d6\u6216\u8868\u9762\u8bfb\u53d6\u4e2d\u5b58\u5728\u5c40\u90e8\u6027\uff1b</li> <li>\u5bfb\u5740\u8ba1\u7b97\u662f\u5728\u5185\u6838\u5916\u90e8\u7531\u4e13\u7528\u5355\u5143\u6267\u884c\u7684\uff1b</li> <li>\u6253\u5305\u7684\u6570\u636e\u53ef\u4ee5\u5728\u5355\u4e2a\u64cd\u4f5c\u4e2d\u5e7f\u64ad\u5230\u5355\u72ec\u7684\u53d8\u91cf\uff1b</li> <li>\u53ef\u4ee5\u9009\u62e9\u5c068\u4f4d\u548c16\u4f4d\u6574\u6570\u8f93\u5165\u6570\u636e\u8f6c\u6362\u4e3a[0.0, 1.0]\u6216[-1.0, 1.0]\u8303\u56f4\u5185\u768432\u4f4d\u6d6e\u70b9\u503c\uff08\u8bf7\u53c2\u89c1 3.2.11.1. Texture Memory \uff09\u3002</li> </ul>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#54","title":"5.4 \u6700\u5927\u5316\u6307\u4ee4\u541e\u5410\u91cf","text":"<p>\u4e3a\u4e86\u6700\u5927\u5316\u6307\u4ee4\u541e\u5410\u91cf\uff0c\u5e94\u7528\u7a0b\u5e8f\u5e94\u8be5\uff1a</p> <ul> <li>\u6700\u5c0f\u5316\u4f4e\u541e\u5410\u91cf\u7684\u7b97\u672f\u6307\u4ee4\u7684\u4f7f\u7528\uff1b\u8fd9\u5305\u62ec\u5728\u4e0d\u5f71\u54cd\u6700\u7ec8\u7ed3\u679c\u7684\u60c5\u51b5\u4e0b\u4ee5\u901f\u5ea6\u4e3a\u7cbe\u5ea6\u7684\u4ea4\u6613\uff0c\u4f8b\u5982\u4f7f\u7528\u5185\u90e8\u51fd\u6570\uff08E.2. Intrinsic Functions\uff09\u800c\u4e0d\u662f\u5e38\u89c4\u51fd\u6570\uff0c\u5355\u7cbe\u5ea6\u800c\u4e0d\u662f\u53cc\u7cbe\u5ea6\u6216\u5c06\u975e\u89c4\u8303\u5316\u7684\u6570\u5b57\u5237\u65b0\u4e3a\u96f6\uff1b</li> <li>\u6700\u5927\u9650\u5ea6\u5730\u51cf\u5c11\u7531\u63a7\u5236\u6d41\u6307\u4ee4\u5f15\u8d77\u7684warp\u5206\u6d41\uff08divergence\uff09\uff0c\u5982 5.4.2. Control Flow Instructions \u4e2d\u6240\u8ff0</li> <li>\u51cf\u5c11\u6307\u4ee4\u7684\u6570\u91cf\uff0c\u4f8b\u5982\u901a\u8fc7\u5c3d\u53ef\u80fd\u5730\u4f18\u5316\u540c\u6b65\u70b9\uff08\u5982 5.4.3. Synchronization Instruction \u4e2d\u6240\u8ff0\uff09\u6216\u4f7f\u7528\u53d7\u9650\u6307\u9488\uff08\u5982<code>[__restrict__](B.2.5. __restrict__)</code>\u4e2d\u6240\u8ff0\uff09\u6765\u51cf\u5c11\u6307\u4ee4\u6570\u91cf\u3002</li> </ul> <p>\u5728\u672c\u8282\u4e2d\uff0c\u541e\u5410\u91cf\u4ee5\u6bcf\u4e2a\u591a\u5904\u7406\u5668\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u7684\u64cd\u4f5c\u6570\u7ed9\u51fa\u3002\u5bf9\u4e8e32\u7684warp\u5927\u5c0f\uff0c\u4e00\u6761\u6307\u4ee4\u5bf9\u5e9432\u4e2a\u64cd\u4f5c\uff0c\u56e0\u6b64\uff0c\u5982\u679cN\u662f\u6bcf\u4e2a\u65f6\u949f\u5468\u671f\u7684\u64cd\u4f5c\u6570\uff0c\u5219\u6307\u4ee4\u541e\u5410\u91cf\u4e3a\u6bcf\u4e2a\u65f6\u949f\u5468\u671fN/32\u6307\u4ee4\u3002</p> <p>\u6240\u6709\u541e\u5410\u91cf\u90fd\u662f\u9488\u5bf9\u4e00\u4e2a\u591a\u5904\u7406\u5668\u7684\u3002\u5fc5\u987b\u5c06\u5b83\u4eec\u4e58\u4ee5\u8bbe\u5907\u4e2d\u591a\u5904\u7406\u5668\u7684\u6570\u91cf\uff0c\u624d\u80fd\u83b7\u5f97\u6574\u4e2a\u8bbe\u5907\u7684\u541e\u5410\u91cf\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#541-arithmetic-instruction","title":"5.4.1 \u7b97\u672f\u6307\u4ee4\uff08Arithmetic Instruction\uff09","text":"<p>\u88683 \u7ed9\u51fa\u4e86\u5404\u79cd\u8ba1\u7b97\u529f\u80fd\u8bbe\u5907\u7684\u786c\u4ef6\u56fa\u6709\u652f\u6301\u7684\u7b97\u672f\u6307\u4ee4\u7684\u541e\u5410\u91cf\u3002</p> \u8ba1\u7b97\u80fd\u529b 3.0, 3.2 3.5, 3.7 5.0, 5.2 5.3 6.0 6.1 6.2 7.x 16-bit floating-point add, multiply, multiply-add N/A N/A N/A 256 128 2 256 128 32-bit floating-point add, multiply, multiply-add 192 192 128 128 64 128 128 64 64-bit floating-point add, multiply, multiply-add 8 642 4 4 32 4 4 323 32-bit floating-point reciprocal, reciprocal square root, base-2 logarithm (__log2f), base 2 exponential (exp2f), sine (__sinf), cosine (__cosf) 32 32 32 32 16 32 32 16 32-bit integer add, extended-precision add, subtract, extended-precision subtract 160 160 128 128 64 128 128 64 32-bit integer multiply, multiply-add, extended-precision multiply-add 32 32 Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. 644 24-bit integer multiply (__[u]mul24) Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. 32-bit integer shift 32 645 64 64 32 64 64 64 compare, minimum, maximum 160 160 64 64 32 64 64 64 32-bit integer bit reverse, bit field extract/insert 32 32 64 64 32 64 64 Multiple Instruct. 32-bit bitwise AND, OR, XOR 160 160 128 128 64 128 128 64 count of leading zeros, most significant non-sign bit 32 32 32 32 16 32 32 16 population count 32 32 32 32 16 32 32 16 warp shuffle 32 32 32 32 32 32 32 326 sum of absolute difference 32 32 64 64 32 64 64 64 SIMD video instructions vabsdiff2 160 160 Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. SIMD video instructions vabsdiff4 160 160 Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. 64 All other SIMD video instructions 32 32 Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Multiple instruct. Type conversions from 8-bit and 16-bit integer to 32-bit types 128 128 32 32 16 32 32 16 Type conversions from and to 64-bit types 8 327 4 4 16 4 4 168 All other type conversions 32 32 32 32 16 32 32 16 <p>\u5176\u4ed6\u6307\u4ee4\u548c\u529f\u80fd\u662f\u5728\u4e0a\u9762\u7684\u672c\u5730\u6307\u4ee4\uff08native instructions\uff09\u4e4b\u4e0a\u5b9e\u73b0\u7684\u3002\u5bf9\u4e8e\u5177\u6709\u4e0d\u540c\u8ba1\u7b97\u80fd\u529b\u7684\u8bbe\u5907\uff0c\u5176\u5b9e\u73b0\u53ef\u80fd\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u5e76\u4e14\u7f16\u8bd1\u540e\u7684\u672c\u5730\u6307\u4ee4\u6570\u91cf\u53ef\u80fd\u4f1a\u968f\u6bcf\u4e2a\u7f16\u8bd1\u5668\u7248\u672c\u800c\u53d8\u5316\u3002\u5bf9\u4e8e\u590d\u6742\u7684\u529f\u80fd\uff0c\u53d6\u51b3\u4e8e\u8f93\u5165\uff0c\u53ef\u4ee5\u6709\u591a\u4e2a\u4ee3\u7801\u8def\u5f84\u3002 <code>cuobjdump</code>\u53ef\u7528\u4e8e\u68c0\u67e5<code>cubin</code>\u5bf9\u8c61\u4e2d\u7684\u7279\u5b9a\u5b9e\u73b0\u3002</p> <p>\u67d0\u4e9b\u51fd\u6570\u7684\u5b9e\u73b0\u5728CUDA\u5934\u6587\u4ef6\uff08<code>math_functions.h</code>\uff0c<code>device_functions.h</code>\uff0c...\uff09\u4e0a\u5f88\u5bb9\u6613\u83b7\u5f97\u3002</p> <p>\u901a\u5e38\uff0c\u4e0e<code>-ftz = false</code>\u7f16\u8bd1\u7684\u4ee3\u7801\u76f8\u6bd4\uff0c\u4f7f\u7528<code>-ftz = true</code>\u7f16\u8bd1\u7684\u4ee3\u7801\uff08\u5c06\u975e\u89c4\u683c\u5316\u7684\u6570\u5b57\u5237\u65b0\u4e3a\u96f6\uff09\u5177\u6709\u66f4\u9ad8\u7684\u6027\u80fd\u3002\u540c\u6837\uff0c\u4f7f\u7528<code>-prec div = false</code>\uff08\u7cbe\u5ea6\u8f83\u4f4e\u7684\u9664\u6cd5\uff09\u7f16\u8bd1\u7684\u4ee3\u7801\u5f80\u5f80\u6bd4\u4f7f\u7528<code>-prec div = true</code>\u7f16\u8bd1\u7684\u4ee3\u7801\u5177\u6709\u66f4\u9ad8\u7684\u6027\u80fd\u4ee3\u7801\uff0c\u800c\u4f7f\u7528<code>-prec-sqrt = false</code>\uff08\u7cbe\u5ea6\u8f83\u4f4e\u7684\u5e73\u65b9\u6839\uff09\u7f16\u8bd1\u7684\u4ee3\u7801\u5f80\u5f80\u6bd4\u4f7f\u7528<code>-prec-sqrt = true</code>\u7f16\u8bd1\u7684\u4ee3\u7801\u5177\u6709\u66f4\u9ad8\u7684\u6027\u80fd\u3002 nvcc\u7528\u6237\u624b\u518c\u66f4\u8be6\u7ec6\u5730\u63cf\u8ff0\u4e86\u8fd9\u4e9b\u7f16\u8bd1\u6807\u5fd7\u3002</p> <p>\u5355\u7cbe\u5ea6\u6d6e\u70b9\u9664\u6cd5\uff08Single-Precision Floating-Point Division\uff09 <code>__fdividef(x, y)</code>\uff08\u89c1 E.2. Intrinsic Functions \uff09\u6bd4\u9664\u6cd5\u64cd\u4f5c\u7b26\u63d0\u4f9b\u4e86\u66f4\u5feb\u7684\u5355\u7cbe\u5ea6\u6d6e\u70b9\u9664\u6cd5\u3002</p> <p>\u5355\u7cbe\u5ea6\u6d6e\u70b9\u5012\u6570\u5e73\u65b9\u6839\uff08Single-Precision Floating-Point Reciprocal Square Root\uff09 \u4e3a\u4e86\u4fdd\u7559IEEE-754\u8bed\u4e49\uff0c\u4ec5\u5f53\u5012\u6570\u548c\u5e73\u65b9\u6839\u90fd\u8fd1\u4f3c\u65f6\uff08\u5373<code>-prec-div = false</code>\u548c<code>-prec-sqrt = false</code>\uff09\uff0c\u7f16\u8bd1\u5668\u624d\u80fd\u5c06<code>1.0/sqrtf()</code>\u4f18\u5316\u4e3a<code>rsqrtf()</code>\u3002\u56e0\u6b64\uff0c\u5efa\u8bae\u5728\u9700\u8981\u7684\u5730\u65b9\u76f4\u63a5\u8c03\u7528<code>rsqrtf()</code>\u3002</p> <p>\u5355\u7cbe\u5ea6\u6d6e\u70b9\u5e73\u65b9\u6839\uff08Single-Precision Floating-Point Square Root\uff09 \u5355\u7cbe\u5ea6\u6d6e\u70b9\u5e73\u65b9\u6839\u7684\u5b9e\u73b0\u5f62\u5f0f\u662f\u5012\u6570\u5e73\u65b9\u6839\uff0c\u7136\u540e\u662f\u5012\u6570\uff0c\u800c\u4e0d\u662f\u5012\u6570\u5e73\u65b9\u6839\uff0c\u7136\u540e\u662f\u4e58\u6cd5\uff0c\u8fd9\u6837\u53ef\u4ee5\u5f97\u51fa0\u548c\u65e0\u7a77\u5927\u7684\u6b63\u786e\u7ed3\u679c\u3002</p> <p>\u6b63\u5f26\u548c\u4f59\u5f26\uff08Sine and Cosine\uff09 sinf(x), cosf(x), tanf(x), sincosf(x)\uff0c\u76f8\u5e94\u7684\u53cc\u7cbe\u5ea6\u6307\u4ee4\u8981\u6602\u8d35\u5f97\u591a\uff0c\u5982\u679c\u81ea\u53d8\u91cfx\u7684\u5927\u5c0f\u8f83\u5927\uff0c\u5219\u751a\u81f3\u66f4\u9ad8\u3002</p> <p>\u66f4\u786e\u5207\u5730\u8bf4\uff0c\u81ea\u53d8\u91cf\u7ea6\u7b80\u4ee3\u7801\uff08\u8bf7\u53c2\u89c1 B.7. Mathematical Functions \uff09\u5305\u62ec\u4e24\u4e2a\u4ee3\u7801\u8def\u5f84\uff0c\u5206\u522b\u79f0\u4e3a\u5feb\u901f\u8def\u5f84\u548c\u6162\u901f\u8def\u5f84\u3002</p> <p>\u5feb\u901f\u8def\u5f84\u7528\u4e8e\u5927\u5c0f\u8db3\u591f\u5c0f\u7684\u81ea\u53d8\u91cf\uff0c\u5e76\u4e14\u57fa\u672c\u4e0a\u7531\u4e00\u4e9b\u4e58\u6cd5\u52a0\u6cd5\u8fd0\u7b97\u7ec4\u6210\u3002\u6162\u901f\u8def\u5f84\u7528\u4e8e\u5927\u5c0f\u8f83\u5927\u7684\u81ea\u53d8\u91cf\uff0c\u7531\u5197\u957f\u7684\u8ba1\u7b97\u7ec4\u6210\uff0c\u4ee5\u5728\u6574\u4e2a\u81ea\u53d8\u91cf\u8303\u56f4\u5185\u83b7\u5f97\u6b63\u786e\u7684\u7ed3\u679c\u3002</p> <p>\u76ee\u524d\uff0c\u7528\u4e8e\u4e09\u89d2\u51fd\u6570\u7684\u81ea\u53d8\u91cf\u5f52\u7ea6\u4ee3\u7801\u4e3a\u5355\u7cbe\u5ea6\u51fd\u6570\u7684\u91cf\u503c\u5c0f\u4e8e<code>105615.0f</code>\u3001\u53cc\u7cbe\u5ea6\u51fd\u6570\u7684\u91cf\u503c\u5c0f\u4e8e<code>2147483648.0</code>\u7684\u53d8\u91cf\u9009\u62e9\u5feb\u901f\u8def\u5f84\u3002</p> <p>\u7531\u4e8e\u6162\u901f\u8def\u5f84\u9700\u8981\u6bd4\u5feb\u901f\u8def\u5f84\u66f4\u591a\u7684\u5bc4\u5b58\u5668\uff0c\u56e0\u6b64\u5c1d\u8bd5\u901a\u8fc7\u5728\u672c\u5730\u5b58\u50a8\u5668\uff08Local Memory\uff09\u4e2d\u5b58\u50a8\u4e00\u4e9b\u4e2d\u95f4\u53d8\u91cf\u6765\u51cf\u5c11\u6162\u901f\u8def\u5f84\u4e2d\u7684\u5bc4\u5b58\u5668\u538b\u529b\uff0c\u8fd9\u53ef\u80fd\u4f1a\u7531\u4e8e\u672c\u5730\u5b58\u50a8\u5668\u9ad8\u5ef6\u8fdf\u548c\u9ad8\u5e26\u5bbd\u800c\u5f71\u54cd\u6027\u80fd\uff08\u8bf7\u53c2\u9605 5.3.2 \u8bbe\u5907\u5185\u5b58\u8bbf\u95ee \uff09\u3002\u76ee\u524d\uff0c\u5355\u7cbe\u5ea6\u529f\u80fd\u4f7f\u752828\u5b57\u8282\u7684\u672c\u5730\u5b58\u50a8\u5668\uff0c\u800c\u53cc\u7cbe\u5ea6\u529f\u80fd\u4f7f\u752844\u5b57\u8282\u3002\u4f46\u662f\uff0c\u786e\u5207\u7684\u6570\u91cf\u53ef\u80fd\u4f1a\u53d1\u751f\u53d8\u5316\u3002</p> <p>\u7531\u4e8e\u5197\u957f\u7684\u8ba1\u7b97\u548c\u5728\u6162\u901f\u8def\u5f84\u4e2d\u4f7f\u7528\u672c\u5730\u5185\u5b58\uff0c\u5f53\u9700\u8981\u6162\u901f\u8def\u5f84\u7f29\u51cf\u800c\u4e0d\u662f\u5feb\u901f\u8def\u5f84\u7f29\u51cf\u65f6\uff0c\u8fd9\u4e9b\u4e09\u89d2\u51fd\u6570\u7684\u541e\u5410\u91cf\u964d\u4f4e\u4e86\u4e00\u4e2a\u6570\u91cf\u7ea7\u3002</p> <p>\u6574\u6570\u7b97\u672f\uff08Integer Arithmetic\uff09 \u6574\u6570\u9664\u6cd5\u548c\u6a21\u8fd0\u7b97\u7684\u6210\u672c\u5f88\u9ad8\uff0c\u56e0\u4e3a\u5b83\u4eec\u6700\u591a\u53ef\u7f16\u8bd120\u6761\u6307\u4ee4\u3002\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5c06\u5b83\u4eec\u66ff\u6362\u4e3a\u6309\u4f4d\u8fd0\u7b97\uff1a\u5982\u679c<code>n</code>\u4e3a2\u7684\u5e42\uff0c\u5219\uff08<code>i/n</code>\uff09\u7b49\u4e8e\uff08<code>i&gt;&gt;log2(n)</code>\uff09\uff0c\u800c\uff08<code>i%n</code>\uff09\u7b49\u4e8e\uff08<code>i&amp;(n-1)</code>\uff09\uff1b\u5982\u679c<code>n</code>\u662f\u7acb\u5373\u6570\uff0c\u5219\u7f16\u8bd1\u5668\u5c06\u6267\u884c\u8fd9\u4e9b\u8f6c\u6362\u3002</p> <p><code>__brev</code>\u548c<code>__popc</code>\u6620\u5c04\u5230\u5355\u4e2a\u6307\u4ee4\uff0c\u800c<code>__brevll</code>\u548c<code>__popcll</code>\u6620\u5c04\u5230\u4e00\u4e9b\u6307\u4ee4\u3002</p> <p><code>__[u]mul24</code>\u662f\u9057\u7559\u7684\u5185\u90e8\u51fd\u6570\uff0c\u4e0d\u518d\u6709\u4efb\u4f55\u7406\u7531\u8981\u4f7f\u7528\u3002</p> <p>\u534a\u7cbe\u5ea6\u7b97\u672f\uff08Half Precision Arithmetic\uff09 \u4e3a\u4e86\u83b7\u5f97\u826f\u597d\u7684\u534a\u7cbe\u5ea6\u6d6e\u70b9\u52a0\uff0c\u4e58\u6216\u4e58\u52a0\u541e\u5410\u91cf\uff0c\u5efa\u8bae\u4f7f\u7528<code>half2</code>\u6570\u636e\u7c7b\u578b\u3002\u7136\u540e\u53ef\u4ee5\u4f7f\u7528\u5411\u91cf\u5185\u5728\u51fd\u6570\uff08\u4f8b\u5982<code>__hadd2</code>\uff0c<code>__ hsub2</code>\uff0c<code>__ hmul2</code>\uff0c<code>__ hfma2</code>\uff09\u5728\u4e00\u6761\u6307\u4ee4\u4e2d\u6267\u884c\u4e24\u9879\u64cd\u4f5c\u3002\u4f7f\u7528<code>half2</code>\u4ee3\u66ff\u4e24\u6b21\u4f7f\u7528<code>half</code>\u7684\u8c03\u7528\u4e5f\u53ef\u80fd\u6709\u52a9\u4e8e\u5176\u4ed6\u5185\u5728\u51fd\u6570\u7684\u6027\u80fd\uff0c\u4f8b\u5982warp shuffles\u3002</p> <p>\u63d0\u4f9b\u4e86\u5185\u90e8\u7684<code>__halves2half2</code>\u53ef\u4ee5\u5c06\u4e24\u4e2a\u534a\u7cbe\u5ea6\u503c\u8f6c\u6362\u4e3a<code>half2</code>\u6570\u636e\u7c7b\u578b\u3002</p> <p>\u7c7b\u578b\u8f6c\u6362\uff08Type Conversion\uff09 \u6709\u65f6\uff0c\u7f16\u8bd1\u5668\u5fc5\u987b\u63d2\u5165\u8f6c\u6362\u6307\u4ee4\uff0c\u4ece\u800c\u5f15\u5165\u989d\u5916\u7684\u6267\u884c\u65f6\u949f\u5468\u671f\u3002\u8fd9\u79cd\u60c5\u51b5\u4e3a\uff1a</p> <ul> <li>\u5bf9<code>char</code>\u6216<code>short</code>\u7c7b\u578b\u7684\u53d8\u91cf\u8fdb\u884c\u64cd\u4f5c\u7684\u51fd\u6570\uff0c\u5176\u64cd\u4f5c\u6570\u901a\u5e38\u9700\u8981\u8f6c\u6362\u4e3aint\uff1b</li> <li>\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u5e38\u91cf\uff08\u5373\u90a3\u4e9b\u6ca1\u6709\u4efb\u4f55\u7c7b\u578b\u540e\u7f00\u7684\u5e38\u91cf\uff09\u7528\u4f5c\u5355\u7cbe\u5ea6\u6d6e\u70b9\u8ba1\u7b97\u7684\u8f93\u5165\uff08\u7531C/C++\u6807\u51c6\u5f3a\u5236\u6267\u884c\uff09\u3002</li> </ul> <p>\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528\u5355\u7cbe\u5ea6\u6d6e\u70b9\u5e38\u91cf\uff08\u7528<code>3.141592653589793f</code>, <code>1.0f</code>, <code>0.5f</code>\u7b49\u540e\u7f00f\u5b9a\u4e49\uff09\u6765\u907f\u514d\u540e\u4e00\u79cd\u60c5\u51b5\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#542-control-flow-instructions","title":"5.4.2 \u63a7\u5236\u6d41\u6307\u4ee4\uff08Control Flow Instructions\uff09","text":"<p>\u4efb\u4f55\u6d41\u63a7\u5236\u6307\u4ee4\uff08<code>if</code>, <code>switch</code>, <code>do</code>, <code>for</code>, <code>while</code>\uff09\u90fd\u4f1a\u7531\u4e8e\u4f7f\u76f8\u540cwarp\u7684\u7ebf\u7a0b\u5206\u5f00\uff08\u5373\u9075\u5faa\u4e0d\u540c\u7684\u6267\u884c\u8def\u5f84\uff09\u6765\u663e\u7740\u5f71\u54cd\u6709\u6548\u6307\u4ee4\u541e\u5410\u91cf\u3002\u5982\u679c\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\uff0c\u5219\u5fc5\u987b\u5e8f\u5217\u5316\u4e0d\u540c\u7684\u6267\u884c\u8def\u5f84\uff0c\u4ece\u800c\u589e\u52a0\u4e86\u4e3a\u6b64warp\u6267\u884c\u7684\u6307\u4ee4\u603b\u6570\u3002</p> <p>\u4e3a\u4e86\u5728\u63a7\u5236\u6d41\u53d6\u51b3\u4e8e\u7ebf\u7a0bID\u7684\u60c5\u51b5\u4e0b\u83b7\u5f97\u6700\u4f73\u6027\u80fd\uff0c\u5e94\u7f16\u5199\u63a7\u5236\u6761\u4ef6\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u53d1\u6563\u7ebf\u7a0b\u675f\uff08divergent warps\uff09\u7684\u6570\u91cf\u3002\u8fd9\u662f\u53ef\u80fd\u7684\uff0c\u56e0\u4e3a\u5982 4.1. SIMT Architecture \u4e2d\u6240\u8ff0\uff0c\u6574\u4e2ablock\u4e0a\u7684warp\u5206\u5e03\u662f\u786e\u5b9a\u7684\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u662f\uff0c\u63a7\u5236\u6761\u4ef6\u4ec5\u53d6\u51b3\u4e8e\uff08<code>threadIdx / warpSize</code>\uff09\uff0c\u5176\u4e2dwarpSize\u662fwarp\u5927\u5c0f\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7531\u4e8e\u63a7\u5236\u6761\u4ef6\u4e0ewarps\u5b8c\u5168\u5bf9\u51c6\uff0c\u56e0\u6b64\u6ca1\u6709warp\u53d1\u6563\u3002</p> <p>\u6709\u65f6\uff0c\u7f16\u8bd1\u5668\u53ef\u80fd\u4f1a\u5c55\u5f00\u5faa\u73af\uff0c\u6216\u8005\u53ef\u80fd\u4f1a\u6539\u7528\u5206\u652f\u8c13\u8bcd\uff08branch predication\uff09\u6765\u4f18\u5316\u7b80\u77ed\u7684 <code>if</code>\u6216<code>switch</code>\u5757\uff0c\u5982\u4e0b\u6240\u8ff0\u3002\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4efb\u4f55warps\u90fd\u4e0d\u4f1a\u53d1\u6563\u3002\u7a0b\u5e8f\u5458\u8fd8\u53ef\u4ee5\u4f7f\u7528<code>#pragma unroll</code>\u6307\u4ee4\u63a7\u5236\u5faa\u73af\u7684\u5c55\u5f00\uff08\u8bf7\u53c2\u9605 B.24. #pragma unroll \uff09\u3002</p> <p>\u5f53\u4f7f\u7528\u5206\u652f\u8c13\u8bcd\u65f6\uff0c\u5176\u6267\u884c\u53d6\u51b3\u4e8e\u63a7\u5236\u6761\u4ef6\u7684\u6307\u4ee4\u5747\u4e0d\u4f1a\u88ab\u8df3\u8fc7\u3002\u76f8\u53cd\uff0c\u5b83\u4eec\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u4e0e\u57fa\u4e8e\u63a7\u5236\u6761\u4ef6\u8bbe\u7f6e\u4e3atrue\u6216false\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u6761\u4ef6\u4ee3\u7801\u6216\u8c13\u8bcd\u76f8\u5173\u8054\uff0c\u5e76\u4e14\u5c3d\u7ba1\u8c03\u5ea6\u4e86\u8fd9\u4e9b\u6307\u4ee4\u4e2d\u7684\u6bcf\u6761\u6307\u4ee4\u4ee5\u6267\u884c\uff0c\u4f46\u5b9e\u9645\u4e0a\u4ec5\u6267\u884c\u5177\u6709\u771f\u5b9e\u8c13\u8bcd\uff08true predication\uff09\u7684\u6307\u4ee4\u3002\u5e26\u6709\u9519\u8bef\u8c13\u8bcd\uff08false predication\uff09\u7684\u6307\u4ee4\u4e0d\u4f1a\u5199\u5165\u7ed3\u679c\uff0c\u4e5f\u4e0d\u4f1a\u6c42\u5730\u5740\u6216\u8bfb\u53d6\u64cd\u4f5c\u6570\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#543-synchronization-instruction","title":"5.4.3 \u540c\u6b65\u6307\u4ee4\uff08Synchronization Instruction\uff09","text":"<p><code>__syncthreads()</code>\u7684\u541e\u5410\u91cf\u5bf9\u4e8e\u8ba1\u7b97\u80fd\u529b\u4e3a3.x\u7684\u8bbe\u5907\u800c\u8a00\u4e3a\u6bcf\u4e2a\u65f6\u949f\u5468\u671f128\u6b21\u64cd\u4f5c\uff0c\u5bf9\u4e8e\u8ba1\u7b97\u80fd\u529b\u4e3a6.0\u7684\u8bbe\u5907\u800c\u8a00\u4e3a\u6bcf\u4e2a\u65f6\u949f\u5468\u671f32\u6b21\u64cd\u4f5c\uff0c\u5bf9\u4e8e\u8ba1\u7b97\u80fd\u529b7.x\u7684\u8bbe\u5907\u800c\u8a00\u4e3a\u6bcf\u4e2a\u65f6\u949f\u5468\u671f16\u6b21\u64cd\u4f5c\uff0c\u5bf9\u4e8e\u8ba1\u7b97\u80fd\u529b\u4e3a5.x\uff0c6.1\u548c6.2\u7684\u8bbe\u5907\u800c\u8a00\u4e3a\u6bcf\u4e2a\u65f6\u949f\u5468\u671f64\u6b21\u64cd\u4f5c\u3002</p> <p>\u8bf7\u6ce8\u610f\uff0c<code>__syncthreads()</code>\u53ef\u80fd\u4f1a\u901a\u8fc7\u5f3a\u5236\u591a\u5904\u7406\u5668\u8fdb\u5165\u7a7a\u95f2\u72b6\u6001\u6765\u5f71\u54cd\u6027\u80fd\uff0c\u5982 5.3.2 \u8bbe\u5907\u5185\u5b58\u8bbf\u95ee \u4e2d\u6240\u8ff0\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#b23-launch-bounds","title":"B.23 \u542f\u52a8\u9650\u5b9a\uff08Launch Bounds\uff09","text":"<p>\u5982 5.2.3 \u591a\u5904\u7406\u5668\u7ea7\u522b \u4e2d\u8be6\u7ec6\u8ba8\u8bba\u7684\uff0c\u5185\u6838\u4f7f\u7528\u7684\u5bc4\u5b58\u5668\u8d8a\u5c11\uff0c\u591a\u5904\u7406\u5668\u4e0a\u53ef\u80fd\u9a7b\u7559\u7684\u7ebf\u7a0b\u548c\u7ebf\u7a0b\u5757\u5c31\u8d8a\u591a\uff0c\u8fd9\u53ef\u4ee5\u63d0\u9ad8\u6027\u80fd\u3002</p> <p>\u56e0\u6b64\uff0c\u7f16\u8bd1\u5668\u4f7f\u7528\u542f\u53d1\u5f0f\uff08hheuristics\uff09\u6765\u6700\u5927\u7a0b\u5ea6\u5730\u51cf\u5c11\u5bc4\u5b58\u5668\u4f7f\u7528\u91cf\uff0c\u540c\u65f6\u4fdd\u6301\u5bc4\u5b58\u5668\u6ea2\u51fa\uff08\u8bf7\u53c2\u89c1 5.3.2 \u8bbe\u5907\u5185\u5b58\u8bbf\u95ee \uff09\u548c\u6307\u4ee4\u8ba1\u6570\u6700\u5c0f\u3002\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528<code>__global__</code>\u51fd\u6570\u5b9a\u4e49\u4e2d\u7684<code>__launch_bounds__()</code>\u9650\u5b9a\u7b26\u6307\u5b9a\u7684\u542f\u52a8\u8303\u56f4\u7684\u5f62\u5f0f\u5411\u7f16\u8bd1\u5668\u63d0\u4f9b\u5176\u4ed6\u4fe1\u606f\uff0c\u4ece\u800c\u6709\u9009\u62e9\u5730\u5e2e\u52a9\u8fd9\u4e9b\u542f\u53d1\u5f0f\u65b9\u6cd5\uff1a <pre><code>__global__ void\n__launch_bounds__(maxThreadsPerBlock, minBlocksPerMultiprocessor)\nMyKernel(...)\n{\n    ...\n}\n</code></pre></p> <ul> <li><code>maxThreadsPerBlock</code>\u6307\u5b9a\u542f\u52a8<code>MyKernel()</code>\u7684\u6bcf\u4e2ablock\u7684\u6700\u5927\u7ebf\u7a0b\u6570\uff1b\u5b83\u7f16\u8bd1\u751f\u6210<code>.maxntid</code>PTX\u6307\u4ee4\uff08directive\uff09\uff1b</li> <li><code>minBlocksPerMultiprocessor</code>\u662f\u53ef\u9009\u53c2\u6570\uff0c\u6307\u5b9a\u6bcf\u4e2a\u591a\u5904\u7406\u5668\u6240\u9700\u7684\u9a7b\u7559\u5757\u7684\u6700\u5c0f\u6570\u76ee\uff1b\u5b83\u7f16\u8bd1\u751f\u6210<code>minnctapersm</code>PTX\u6307\u4ee4\uff08directive\uff09\u3002</li> </ul> <p>\u5982\u679c\u542f\u52a8\u9650\u5236\u88ab\u6307\u5b9a\uff0c\u7f16\u8bd1\u5668\u4f1a\u9996\u5148\u9650\u5236kernel\u4f7f\u7528\u7684\u5bc4\u5b58\u5668\u6570\u91cf\u4e3a<code>L</code>\u53bb\u4fdd\u8bc1<code>minBlocksPerMultiprocessor</code>\u4e2ablocks\uff08\u6216\u4e00\u4e2ablock\uff0c\u5982\u679c<code>minBlockPerMultiprocessor</code>\u6ca1\u6709\u88ab\u6307\u5b9a\u7684\u8bdd\uff09\u80fd\u591f\u9a7b\u7559\u3002\u7f16\u8bd1\u5668\u901a\u8fc7\u4ee5\u4e0b\u65b9\u6cd5\u4f18\u5316\u5bc4\u5b58\u5668\u7684\u4f7f\u7528:</p> <ul> <li>\u5982\u679c\u521d\u59cb\u5bc4\u5b58\u5668\u4f7f\u7528\u91cf\u8d85\u8fc7L\uff0c\u90a3\u4e48\u7f16\u8bd1\u5668\u51cf\u5c11\u5b83\u76f4\u81f3\u5c0f\u4e8e\u7b49\u4e8eL\uff0c\u901a\u5e38\u4ee5\u672c\u5730\u5185\u5b58\u589e\u52a0\u548c/\u6216\u66f4\u9ad8\u7684\u6307\u4ee4\u6570\u4e3a\u4ee3\u4ef7\uff1b</li> <li>\u5982\u679c\u521d\u59cb\u5bc4\u5b58\u5668\u4f7f\u7528\u91cf\u5c0f\u4e8eL\uff0c <ul> <li>\u5982\u679c<code>maxThreadPerBlock</code>\u88ab\u6307\u5b9a\u4f46\u662f<code>minBlocksPerMultiprocessor</code>\u6ca1\u6709\uff0c\u90a3\u4e48\u7f16\u8bd1\u5668\u4f7f\u7528<code>maxThreadPerBlock</code>\u53bb\u51b3\u5b9a\u5728<code>n</code>\u548c<code>n+1</code>\u4e2a\u5e38\u9a7b\u5757\u4e4b\u95f4\u8f6c\u6362\uff08\u4f8b\u5982\u5728 5.2.3 \u591a\u5904\u7406\u5668\u7ea7\u522b \u7684\u4f8b\u5b50\u4e2d\uff0c\u5f53\u4f7f\u7528\u4e00\u4e2a\u8f83\u5c11\u7684\u5bc4\u5b58\u5668\u80fd\u4e3a\u4e00\u4e2a\u989d\u5916\u7684\u5e38\u9a7b\u5757\u817e\u51fa\u7a7a\u95f4\uff09\u7684\u5bc4\u5b58\u5668\u4f7f\u7528\u7684\u95e8\u9650\uff0c\u7136\u540e\u5bf9\u6ca1\u6709\u6307\u5b9a\u542f\u52a8\u9650\u5236\uff08launch bounds\uff09\u7684\u4e5f\u4f7f\u7528\u76f8\u540c\u7684\u542f\u52a8\u5f0f\uff08heuristics\uff09\u3002</li> <li>\u5982\u679c<code>minBlocksPerMultiprocessor</code>\u548c<code>maxThreadPerBlock</code>\u90fd\u88ab\u6307\u5b9a\uff0c\u7f16\u8bd1\u5668\u53ef\u80fd\u4f1a\u5c3d\u53ef\u80fd\u589e\u52a0\u5bc4\u5b58\u5668\u4f7f\u7528\u91cf\u4f7f\u63a5\u8fd1L\u4ee5\u51cf\u5c11\u6307\u4ee4\u6570\uff0c\u8fd9\u6837\u53ef\u4ee5\u66f4\u597d\u5730\u9690\u85cf\u6307\u4ee4\u5ef6\u8fdf\u3002</li> </ul> </li> </ul> <p>\u5982\u679ckernel\u4e00\u4e2ablock\u4e2d\u4f7f\u7528\u8d85\u8fc7\u542f\u52a8\u9650\u5236<code>maxThreadPerBlock</code>\u7684\u7ebf\u7a0b\u6570\u6267\u884c\uff0c\u90a3\u4e48kernel\u53ef\u80fd\u542f\u52a8\u5931\u8d25\u3002</p> <p>\u7ed9\u5b9a\u5185\u6838\u7684\u6700\u4f73\u542f\u52a8\u8303\u56f4\u901a\u5e38\u968f\u4e3b\u8981\u67b6\u6784\u4fee\u8ba2\u7248\uff08architecture revisions\uff09\u4f1a\u6709\u6240\u4e0d\u540c\u3002\u4e0b\u9762\u7684\u793a\u4f8b\u4ee3\u7801\u663e\u793a\u4e86\u4f7f\u7528 3.1.4 \u5e94\u7528\u7a0b\u5e8f\u517c\u5bb9\u6027 \u4e2d\u5f15\u5165\u7684<code>__CUDA_ARCH__</code>\u5b8f\u901a\u5e38\u5982\u4f55\u5728\u8bbe\u5907\u4ee3\u7801\u4e2d\u5904\u7406\u6b64\u95ee\u9898\u3002</p> <pre><code>#define THREADS_PER_BLOCK          256\n#if __CUDA_ARCH__ &gt;= 200\n    #define MY_KERNEL_MAX_THREADS  (2 * THREADS_PER_BLOCK)\n    #define MY_KERNEL_MIN_BLOCKS   3\n#else\n    #define MY_KERNEL_MAX_THREADS  THREADS_PER_BLOCK\n    #define MY_KERNEL_MIN_BLOCKS   2\n#endif\n\n// \u8bbe\u5907\u4ee3\u7801\n__global__ void\n__launch_bounds__(MY_KERNEL_MAX_THREADS, MY_KERNEL_MIN_BLOCKS)\nMyKernel(...)\n{\n    ...\n}\n</code></pre> <p>\u901a\u5e38\uff0c\u6838\u51fd\u6570<code>MyKernel</code>\u4f7f\u7528\u6bcf\u4e2a\u7ebf\u7a0b\u5757\u7684\u6700\u5927\u6570\u91cf\u7684\u7ebf\u7a0b\uff08\u7531<code>__launch_bounds()</code>\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u6307\u5b9a\uff09\u542f\u52a8\uff0c\u5b83\u8bd5\u56fe\u5c06<code>MY_KERNEL_MAX_THREADS</code>\u7528\u4f5c\u6267\u884c\u914d\u7f6e\u4e2d\u6bcf\u4e2a\u5757\u7684\u7ebf\u7a0b\u6570\uff1a</p> <pre><code>// \u4e3b\u673a\u4ee3\u7801\nMyKernel&lt;&lt;&lt;blocksPerGrid, MY_KERNEL_MAX_THREADS&gt;&gt;&gt;(...); // Does not work!\n</code></pre> <p>\u4f46\u662f\uff0c\u8fd9\u5c06\u4e0d\u8d77\u4f5c\u7528\uff0c\u56e0\u4e3a\u5982 3.1.4 \u5e94\u7528\u7a0b\u5e8f\u517c\u5bb9\u6027 \u4e2d\u6240\u8ff0\uff0c<code>__CUDA_ARCH__</code>\u5728\u4e3b\u673a\u4ee3\u7801\u4e2d\u672a\u5b9a\u4e49\uff0c\u56e0\u6b64\uff0c\u5373\u4f7f__CUDA_ARCH__\u5927\u4e8e\u6216\u7b49\u4e8e200\uff0cMyKernel\u4e5f\u4f1a\u4ee5\u6bcf\u4e2a\u5757256\u4e2a\u7ebf\u7a0b\u542f\u52a8\u3002\u76f8\u53cd\uff0c\u5e94\u8be5\u4ee5\u5982\u4e0b\u65b9\u5f0f\u786e\u5b9a\u6bcf\u4e2a\u5757\u7684\u7ebf\u7a0b\u6570\uff1a</p> <ul> <li> <p>\u65b9\u6cd5\u4e00\uff0c\u5728\u7f16\u8bd1\u5668\u4f7f\u7528\u4e0d\u4f9d\u8d56\u4e8e<code>__CUDA__ARCH__</code>\u7684\u5b8f\uff0c\u6bd4\u5982 <pre><code>// Host code\nMyKernel&lt;&lt;&lt;blocksPerGrid, THREADS_PER_BLOCK&gt;&gt;&gt;(...);\n</code></pre></p> </li> <li> <p>\u65b9\u6cd5\u4e8c\uff0c\u5728\u8fd0\u884c\u65f6\u57fa\u4e8e\u8ba1\u7b97\u80fd\u529b <pre><code>// Host code\ncudaGetDeviceProperties(&amp;deviceProp, device);\nint threadsPerBlock =\n          (deviceProp.major &gt;= 2 ?\n                    2 * THREADS_PER_BLOCK : THREADS_PER_BLOCK);\nMyKernel&lt;&lt;&lt;blocksPerGrid, threadsPerBlock&gt;&gt;&gt;(...);\n</code></pre></p> </li> </ul> <p>\u5bc4\u5b58\u5668\u4f7f\u7528\u91cf\u53ef\u4ee5\u901a\u8fc7\u7f16\u8bd1\u9009\u9879<code>--ptxas option=-v</code>\u6765\u62a5\u544a\u3002 \u9a7b\u7559\u5757\u7684\u6570\u91cf\u53ef\u4ee5\u4eceCUDA\u5206\u6790\u5668\uff08profiler\uff09\u62a5\u544a\u7684\u5360\u7528\u7387\u4e2d\u5f97\u51fa\uff08\u6709\u5173\u5360\u7528\u7387\u7684\u5b9a\u4e49\uff0c\u8bf7\u53c2\u9605 5.3.2 \u8bbe\u5907\u5185\u5b58\u8bbf\u95ee \uff09\u3002</p> <p>\u4e00\u4e2a\u6587\u4ef6\u4e2d\u6240\u6709<code>__global__</code>\u51fd\u6570\u7684\u5bc4\u5b58\u5668\u4f7f\u7528\u91cf\u53ef\u4ee5\u901a\u8fc7<code>maxrregcount</code>\u7f16\u8bd1\u9009\u9879\u6765\u63a7\u5236\u3002\u5bf9\u4e8e\u6709\u542f\u52a8\u9650\u5236\uff08launch bounds\uff09\u7684\u51fd\u6570\uff0c<code>maxrregcount</code>\u7684\u503c\u88ab\u5ffd\u7565\u3002</p>"},{"location":"book_notes/CUDA/CUDA-C-Pragramming-Guide/Extracts/#warps","title":"\u7ebf\u7a0b\u675f\uff08Warps\uff09","text":"<p>\u5728\u786c\u4ef6\u65b9\u9762\uff0c\u7ebf\u7a0b\u5757\u7531\u201cwarp\u201d\u7ec4\u6210\u3002warp\u662f\u4e00\u4e2a\u7ebf\u7a0b\u5757\u4e2d32\u4e2a\u7ebf\u7a0b\u7684\u96c6\u5408\uff0c\u8fd9\u6837warp\u4e2d\u7684\u6240\u6709\u7ebf\u7a0b\u90fd\u6267\u884c\u76f8\u540c\u7684\u6307\u4ee4\u3002\u8fd9\u4e9b\u7ebf\u7a0b\u662f\u7531SM\u4e32\u884c\u9009\u62e9\u7684\u3002</p> <p>\u4e00\u65e6\u4e00\u4e2a\u7ebf\u7a0b\u5757\u53d1\u8d77\u5728\u4e00\u4e2aSM\u4e0a\uff0c\u6240\u6709\u7684\u7ebf\u7a0b\u675f\u5c06\u4e00\u76f4\u9a7b\u7559\u76f4\u5230\u6267\u884c\u5b8c\u6bd5\u3002\u56e0\u6b64\uff0c\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\u5757\u4e0d\u4f1a\u88ab\u542f\u52a8\uff0c\u76f4\u5230SM\u4e0a\u6709\u8db3\u591f\u7684\u7a7a\u95f2\u5bc4\u5b58\u5668\u548c\u5171\u4eab\u5185\u5b58\u3002</p> <p>\u5047\u8bbe\u4e00\u4e2a\u670932\u4e2a\u7ebf\u7a0b\u7684\u7ebf\u7a0b\u675f\u6267\u884c\u4e00\u6761\u6307\u4ee4\uff0c\u5982\u679c\u4e00\u4e2a\u6216\u591a\u4e2a\u7ebf\u7a0b\u7684\u64cd\u4f5c\u6570\u6ca1\u6709\u5c31\u7eea\uff08\u6bd4\u5982\u8fd8\u6ca1\u6709\u4ece\u5168\u5c40\u5185\u5b58\u4e0a\u53d6\u56de\uff09\uff0c\u8fd9\u65f6\u5019\u4f1a\u53d1\u751f\u201c\u4e0a\u4e0b\u6587\u5207\u6362\u201d\uff0c\u4ece\u4e00\u4e2awarp\u5207\u6362\u5230\u53e6\u5916\u4e00\u4e2a\u6240\u6709\u6570\u636e\u90fd\u5728\u5bc4\u5b58\u5668\u6587\u4ef6\u4e2d\uff08\u64cd\u4f5c\u6570\u5c31\u7eea\uff0c\u6240\u4ee5\u53ef\u4ee5\u7acb\u5373\u6267\u884c\uff09\u7684warp\u3002\u5f53\u4e00\u6761\u6307\u4ee4\u6ca1\u6709\u663e\u8457\u7684\u6570\u636e\u4f9d\u8d56\u65f6\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u7684\u64cd\u4f5c\u6570\u90fd\u51c6\u5907\u597d\u4e86\uff0c\u76f8\u5e94\u7684warp\u5c31\u53ef\u4ee5\u6267\u884c\u4e86\u3002\u5982\u679c\u6709\u591a\u4e2awarp\u6709\u8d44\u683c\u6267\u884c\uff0c\u5219\u7236SM\u4f7f\u7528warp\u8c03\u5ea6\u7b56\u7565\u6765\u51b3\u5b9a\u54ea\u4e2awarp\u83b7\u5f97\u4e0b\u4e00\u4e2a\u83b7\u53d6\u7684\u6307\u4ee4\u3002</p> <p>\u7ebf\u7a0b\u675f\u8c03\u5ea6\u7b56\u7565\uff1a</p> <ol> <li> <p>\u8f6e\u5faa\uff08Round Robin\uff09\uff1a\u6307\u4ee4\u7ba1\u7406\u5668\u4ee5\u8f6e\u5faa\u65b9\u5f0f\u53d6\u5f97\u6307\u4ee4\uff0cSMs\u4fdd\u6301\u5fd9\u788c\u5e76\u4e14\u6ca1\u6709\u65f6\u949f\u5468\u671f\u6d6a\u8d39\u5728\u8bbf\u5b58\u5ef6\u8fdf\u4e0a\u3002</p> </li> <li> <p>\u6700\u8fd1\u6700\u5c11\u83b7\u53d6\uff08LRF\uff0cLeast Recently Fetch\uff09\uff1a\u6700\u957f\u65f6\u95f4\u6ca1\u6709\u83b7\u53d6\u6307\u4ee4\u7684\u7ebf\u7a0b\u675f\u5c06\u62e5\u6709\u66f4\u9ad8\u7684\u4f18\u5148\u7ea7\u3002</p> </li> <li> <p>\u516c\u5e73\uff08Fair\uff09\uff1a\u4f18\u5148\u5c06\u6307\u4ee4\u53d1\u7ed9\u5f53\u524d\u6307\u4ee4\u6570\u8f83\u5c11\u7684\u7ebf\u7a0b\u675f\uff0c\u4fdd\u8bc1\u6bcf\u4e2a\u7ebf\u7a0b\u675f\u6267\u884c\u7684\u6307\u4ee4\u6570\u516c\u5e73\u3002</p> </li> <li> <p>\u57fa\u4e8e\u7ebf\u7a0b\u5757\u7684\u4e34\u754c\u533a\u611f\u77e5\u7ebf\u7a0b\u675f\u8c03\u5ea6\uff08CAWS\uff0cCriticality Aware Warp Scheduling\uff09\uff1a\u65e8\u5728\u63d0\u9ad8\u7ebf\u7a0b\u5757\u7684\u6267\u884c\u65f6\u95f4\u3002\u7ed9\u4e88\u9700\u8981\u66f4\u591a\u6267\u884c\u65f6\u95f4\u7684\u7ebf\u7a0b\u675f\u4ee5\u66f4\u591a\u7684\u65f6\u95f4\u8d44\u6e90\u3002\u901a\u8fc7\u57fa\u4e8e\u6700\u5173\u952e\uff08\u4e34\u754c\uff09\u7ebf\u7a0b\u675f\u66f4\u9ad8\u4f18\u5148\u7ea7\uff0c\u53ef\u4ee5\u63d0\u9ad8\u7ebf\u7a0b\u5757\u66f4\u5feb\u6267\u884c\u5b8c\u6bd5\uff0c\u4ece\u800c\u8d44\u6e90\u53ef\u4ee5\u66f4\u5feb\u83b7\u5f97\u3002</p> </li> </ol> <p>\u4e3a\u4e86\u5229\u7528warp\u67b6\u6784\uff0c\u7f16\u7a0b\u8bed\u8a00\u548c\u5f00\u53d1\u4eba\u5458\u9700\u8981\u4e86\u89e3\u5982\u4f55\u5408\u5e76\u5185\u5b58\u8bbf\u95ee\u4ee5\u53ca\u5982\u4f55\u7ba1\u7406\u63a7\u5236\u6d41\u5206\u6b67\u3002\u5982\u679cwarp\u4e2d\u7684\u6bcf\u4e2a\u7ebf\u7a0b\u91c7\u7528\u4e0d\u540c\u7684\u6267\u884c\u8def\u5f84\uff0c\u6216\u8005\u6bcf\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u7684\u5185\u5b58\u660e\u663e\u4e0d\u540c\uff0c\u90a3\u4e48warp\u67b6\u6784\u7684\u597d\u5904\u5c31\u4f1a\u4e27\u5931\uff0c\u6027\u80fd\u4e5f\u4f1a\u663e\u8457\u4e0b\u964d\u3002</p>"},{"location":"book_notes/CUDA/NVCC/Introduction/","title":"Introduction","text":"<p>\u53c2\u89c1 NVCC Reference</p>"},{"location":"book_notes/CUDA/PTX-ISA/Introduction/","title":"Introduction","text":"<p>\u53c2\u89c1 PTX ISA Reference</p> <p>\u5e76\u884c\u7ebf\u7a0b\u6267\u884c\u6307\u4ee4\u96c6\u67b6\u6784v6.2\uff08Parallel Thread Execution ISA Version 6.2\uff09</p>"},{"location":"book_notes/CUDA/PTX-ISA/Introduction/#1-introduction","title":"1. \u4ecb\u7ecd\uff08Introduction\uff09","text":""},{"location":"book_notes/CUDA/PTX-ISA/Introduction/#11","title":"1.1.","text":""},{"location":"book_notes/CUDA/doc/CUDA-Summary/","title":"\u5e76\u884c\u4f18\u5316","text":""},{"location":"book_notes/CUDA/doc/CUDA-Summary/#_2","title":"\u5bc4\u5b58\u5668","text":"<p>maxRegistersPerThread = registersPerMultiprocessor / threadsResidentPerMultiprocessor</p>"},{"location":"book_notes/CUDA/doc/CUDA-Summary/#_3","title":"\u5de5\u5177","text":""},{"location":"book_notes/CUDA/doc/CUDA-Summary/#cuda-memcheck","title":"cuda-memcheck","text":""},{"location":"book_notes/CUDA/doc/CUDA-Summary/#nvidia-smi","title":"nvidia-smi","text":""},{"location":"book_notes/CUDA/doc/CUDA-Summary/#_4","title":"\u7f16\u8bd1\u9009\u9879","text":"<ul> <li>--ptxas=-v</li> </ul>"},{"location":"book_notes/CUDA/doc/CUDA-Summary/#nsight","title":"Nsight","text":""},{"location":"book_notes/CUDA/doc/CUDA-Summary/#visual-profiler-nvida-corperation","title":"Visual Profiler\uff08\u53ef\u4ee5\u5728[\u5f00\u59cb]-&gt;[NVIDA Corperation]\u6587\u4ef6\u5939\u627e\u5230\uff09","text":""},{"location":"book_notes/CUDA/doc/CUDA-Summary/#cuda_occupancy_calculatorxls","title":"\u5360\u7528\u7387\u8ba1\u7b97\u5668\uff1aCUDA_Occupancy_Calculator.xls","text":""},{"location":"book_notes/CUDA/doc/CUDA/","title":"\u5f02\u6b65","text":"<p>\u7531\u4e8eCPU\u4e0eGPU\u7684\u5f02\u6b65\u6267\u884c\u6027\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5f02\u6b65\u51fd\u6570\u3002GPU\u6267\u884c\u8ba1\u7b97\u5bc6\u96c6\u578b\u4efb\u52a1\u65f6\uff0cCPU\u5c06\u8fd4\u56de\uff0c\u4f8b\u5982\u53bb\u5904\u7406\u7f51\u7edcIO\u7b49\u3002</p>"},{"location":"book_notes/CUDA/doc/CUDA/#warp","title":"warp","text":"<p>warp\u662fSM\u7ea7\u522b\u7684\uff0c\u5355\u4e2a\u7ebf\u7a0b\u662fSP\u7ea7\u522b\u7684\uff0cSP\u6bcf\u6b21\u8fd0\u884c\u4e00\u4e2a\u7ebf\u7a0b\u3002 \u6bcf\u4e2aSM\u7684core\u6570\u91cf\u51b3\u5b9a\u5176\u4e00\u4e2a\u59cb\u7ec8\u5468\u671f\u5185\u53ef\u4ee5\u8fd0\u884c\u7684warp\u6307\u4ee4\u3002 \u5355\u4e2awarp\u6307\u4ee4\u53ef\u4ee5\u5728\u4efb\u4f55\u7ed9\u5b9a\u7684\u65f6\u949f\u5468\u671f\u5185\u5904\u7406\uff0c\u4f46\u9700\u898132\u4e2acore\u624d\u80fd\u5b8c\u6210\uff08\u5e76\u4e14\u53ef\u80fd\u9700\u8981\u591a\u4e2a\u65f6\u949f\u5468\u671f\u624d\u80fd\u5b8c\u6210\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6307\u4ee4\uff09\u3002 SM\u5c06block\u201c\u89e3\u5305\u201d\u4e3awarp\uff0c\u5e76\u5728SM\u5185\u90e8\u8d44\u6e90\uff08\u4f8b\u5982core\u548cSFU\uff09\u53ef\u7528\u65f6\u8c03\u5ea6warp\u6307\u4ee4\u3002</p>"},{"location":"book_notes/CUDA/doc/CUDA/#latency","title":"\u65f6\u95f4\u5ef6\u8fdf\uff08Latency\uff09","text":""},{"location":"book_notes/CUDA/doc/CUDA/#_2","title":"\u6307\u4ee4\u5ef6\u8fdf","text":"\u6570\u636e\u7c7b\u578b \u5b57\u957f\uff08bits\uff09 \u64cd\u4f5c \u5ef6\u8fdf\uff08cycles\uff09 \u5907\u6ce8 \u6574\u6570 + 4 \u6574\u6570 32 * 16 \u6574\u6570 /,mod \u7279\u522b\u6602\u8d35 \u5c3d\u53ef\u80fd\u907f\u514d\uff0c\u6216\u4f7f\u7528\u4f4d\u64cd\u4f5c\u66ff\u4ee3 \u4f4d\u64cd\u4f5c 4 \u6bd4\u8f83 4 max,min 4 \u7c7b\u578b\u8f6c\u6362 4 \u6d6e\u70b9 +,*+ 4 \u6d6e\u70b9 / 36 \u5012\u6570 16 \u5e73\u65b9\u6839\u5012\u6570 16 \u6d6e\u70b9 \u5e73\u65b9\u6839 32 \u5b9e\u73b0\uff1a\u5e73\u65b9\u6839\u5012\u6570+\u5012\u6570\uff0c\u5bf90\u548c\u65e0\u7a77\u5927\u80fd\u6b63\u786e\u5f97\u5230\u7ed3\u679c\uff1b\u56e0\u6b64\u5b83\u5904\u7406\u4e00\u4e2awarp\u82b1\u8d3932\u4e2a\u65f6\u949f\u5468\u671f\u3002 __log(x) 16 __sin(x) 32 __cos(x) 32 __exp(x) 32 __fdividef(x,y) 20 \u9664\u6cd5 - - \u5176\u4ed6\u51fd\u6570 \u66f4\u591a\u65f6\u949f\u5468\u671f \u56e0\u4e3a\u5b9e\u73b0\u4e3a\u591a\u4e2a\u6307\u4ee4\u7684\u7ec4\u5408 - - \u5185\u5b58\u6307\u4ee4 4 \u5305\u62ec\u4ece\u5171\u4eab\u6216\u5168\u5c40\u5185\u5b58\u4e2d\u8bfb\u5199\u7684\u4efb\u4f55\u6307\u4ee4\uff0cSM\u4f7f\u75284\u4e2a\u65f6\u949f\u5468\u671f\u6765\u53d1\u5c04warp\u7684\u4e00\u4e2a\u5185\u5b58\u6307\u4ee4 - - __syncthreads() 4 \u540c\u6b65 <p>\u6709\u65f6\u5019\uff0c\u7f16\u8bd1\u5668\u4e0d\u5f97\u4e0d\u989d\u5916\u63d2\u5165\u8f6c\u6362\u6307\u4ee4\uff0c\u4ece\u800c\u5f15\u5165\u989d\u5916\u7684\u6267\u884c\u5468\u671f\uff1a</p> <p>\u5bf9\u64cd\u4f5c\u6570\u4e3achar\u6216short\u7684\u51fd\u6570\u64cd\u4f5c\uff0c\u5176\u64cd\u4f5c\u6570\u901a\u5e38\u8f6c\u6362\u4e3aint\uff1b \u5728\u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570\u8ba1\u7b97\u4e2d\uff0c\u5c06\u53cc\u7cbe\u5ea6\u6d6e\u70b9\u6570\u5e38\u91cf\uff08\u4e0d\u4f7f\u7528\u4efb\u4f55\u7c7b\u578b\u540e\u7f00\u5b9a\u4e49\uff09\u4f5c\u4e3a\u8f93\u5165\u503c\uff1b \u5728\u6570\u5b66\u51fd\u6570\u7684\u53cc\u7cbe\u5ea6\u7248\u672c\uff0c\u5c06\u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570\u53d8\u91cf\u4f5c\u4e3a\u8f93\u5165\u53c2\u6570\u3002</p> <p>\u540e\u4e24\u79cd\u60c5\u51b5\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u907f\u514d\uff1a  </p> <p>\u5bf9\u5355\u7cbe\u5ea6\u6d6e\u70b9\u6570\u5e38\u91cf\uff0c\u4f7f\u7528f\u540e\u7f00\u5b9a\u4e49\uff0c\u6bd4\u59823.141592653f \u5bf9\u6570\u5b66\u51fd\u6570\u7684\u5355\u7cbe\u5ea6\u7248\u672c\uff0c\u4e5f\u4f7f\u7528f\u540e\u7f00\u5b9a\u4e49\uff0c\u6bd4\u5982sinf().</p>"},{"location":"book_notes/CUDA/doc/CUDA/#_3","title":"\u8bbf\u5b58\u5ef6\u8fdf","text":"\u5185\u5b58\u7c7b\u578b \u5ef6\u8fdf L1/Shared Memory 10-20 Global Memory 400-600"},{"location":"book_notes/CUDA/doc/CUDA/#_4","title":"\u67b6\u6784","text":"<p>\u6bcf\u4e2aSM\u90fd\u6709L1 cache\uff0c\u6240\u6709\u7684SM\u5171\u4eabL2 cache\uff1b L1 cache\uff1a\u7528\u4e8e\u7f13\u5b58local memory\uff0c\u5305\u62ec\u4e34\u65f6\u5bc4\u5b58\u5668\u6ea2\u51fa\u3002 L2 cache\uff1a\u7528\u4e8e\u7f13\u5b58global memory\u3002 \u7f13\u5b58\u884c\u4e3a\uff08\u4f8b\u5982\uff0c\u8bfb\u64cd\u4f5c\u540c\u65f6\u4f7f\u7528L1\u548cL2 cache\uff0c\u8fd8\u662f\u4ec5\u4ec5\u4f7f\u7528L2 cache\uff09\u53ef\u4ee5\u4f7f\u7528load\u6216\u8005store\u6307\u4ee4\u4fee\u9970\u7b26\u6765\u90e8\u5206\u914d\u7f6e\uff0c3.5\u4ee5\u4e0a\u8ba1\u7b97\u80fd\u529b\u8bbe\u5907\u5141\u8bb8\u901a\u8fc7\u7f16\u8bd1\u9009\u9879\u914d\u7f6e\u3002</p> <p>\u5bf9\u4e8e\u8ba1\u7b97\u80fd\u529b3.x\u7684\u8bbe\u5907</p> <p>on-chip memory\uff08unified data cache\uff09\u53ef\u4ee5\u5728shared memory\u548cL1 cache\u4e4b\u95f4\u5206\u914d\uff08\u4f7f\u7528cudaFuncSetCacheConfig()/cuFuncCacheConfig()\uff09\uff1a</p> <p>\uff081\uff0948 KB\u4f5c\u4e3ashared memory\uff0c16 KB\u4f5c\u4e3aL1 cache\uff1b \uff082\uff0932 KB\u4f5c\u4e3ashared memory\uff0c32 KB\u4f5c\u4e3aL1 cache\u3002 \u5bf9\u4e8e\u8ba1\u7b97\u80fd\u529b5.x\u7684\u8bbe\u5907 on-chip memory\uff08unified data cache\uff09\u53ef\u4ee5\u5728shared memory\u548cL1 cache\u4e4b\u95f4\u5206\u914d\uff08\u4f7f\u7528cudaFuncSetCacheConfig()/cuFuncCacheConfig()\uff09\uff1a \uff081\uff0948 KB\u4f5c\u4e3ashared memory\uff0c16 KB\u4f5c\u4e3aL1 cache\uff1b \uff082\uff0932 KB\u4f5c\u4e3ashared memory\uff0c32 KB\u4f5c\u4e3aL1 cache\u3002</p>"},{"location":"book_notes/CUDA/doc/CUDA/#_5","title":"\u8bbe\u5907\u5185\u5b58\u8bbf\u95ee","text":"<p>\u5185\u5b58\u5206\u5e03\u5bf9\u6307\u4ee4\u541e\u5410\u91cf\u7684\u5f71\u54cd\uff1a\u6839\u636e\u4e00\u4e2awarp\u5185\u7684\u7ebf\u7a0b\u548c\u5185\u5b58\u5730\u5740\u7684\u5206\u5e03\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u5185\u5b58\u8bbf\u95ee\u6307\u4ee4\u88ab\u53d1\u8d77\uff08re-issue\uff09\u591a\u6b21\u7684\u60c5\u51b5\u3002\u4f8b\u5982\uff0c\u5168\u5c40\u5185\u5b58\u5730\u5740\u8d8a\u5206\u6563\uff0c\u6307\u4ee4\u541e\u5410\u91cf\u5c31\u8d8a\u5c0f\u3002 \u6307\u4ee4\u541e\u5410\u91cf\uff1a\u6267\u884c\u4e00\u6761\u6307\u4ee4\u6240\u9700\u7684\u65f6\u949f\u6570\u3002</p>"},{"location":"book_notes/CUDA/doc/CUDA/#global-memory-device-memory","title":"\u5168\u5c40\u5185\u5b58\uff08global memory / device memory\uff09","text":"<p>\u5185\u5b58\u4e8b\u52a1\uff08memory transactions\uff09\uff1a\u5185\u5b58\u4e8b\u52a1\u6307\u4e00\u6b21\u5185\u5b58\u8bbf\u95ee\u3002\u53ef\u4ee5\u4ee532\u5b57\u8282\u300164\u5b57\u8282\u3001128\u5b57\u8282\u8bbf\u95ee\u3002 \u5408\u5e76\u8bbf\u95ee\uff08coalesces the memory accesses\uff09\uff1a\u4e00\u4e2awarp\u5185\u7684\u7ebf\u7a0b\u7684\u5185\u5b58\u8bbf\u95ee\u4f1a\u88ab\u5408\u5e76\u3002\u901a\u5e38\uff0c\u5185\u5b58\u4e8b\u7269\u8d8a\u591a\uff0c\u7ebf\u7a0b\u675f\u7684\u6307\u4ee4\u5229\u7528\u7387\u8d8a\u4f4e\uff0c\u6307\u4ee4\u541e\u5410\u91cf\u8d8a\u5c0f\u3002\u4f8b\u5982\uff0c32\u5b57\u8282\u7684\u5185\u5b58\uff0c\u5982\u679c\u6bcf\u4e2a\u7ebf\u7a0b\u5206\u914d\u62104\u5b57\u8282\u8bbf\u95ee\uff0c\u90a3\u4e48\u6307\u4ee4\u541e\u5410\u91cf\u4f1a\u964d\u4f4e\u4e3a1/8\u500d\u3002</p> <p>1\u4e2awarp\u5305\u542b32\u7ebf\u7a0b\uff0c\u5168\u5c40\u5185\u5b58\u7684\u7f13\u5b58\u884c\uff08cache line\uff09\u662f128\u5b57\u8282\u3002 \u5982\u679c\u5185\u5b58\u4e8b\u52a1\u4e3a128\u5b57\u8282\uff0c\u90a3\u4e48L1\u548cL2\u7f13\u5b58\u90fd\u4f1a\u88ab\u7528\u5230\uff1b \u5982\u679c\u5185\u5b58\u4e8b\u52a1\u4e3a32\u5b57\u8282\uff0c\u90a3\u4e48\u53ea\u6709L2\u7f13\u5b58\u4f1a\u88ab\u7528\u5230\uff1b L2\u7f13\u5b58\u53ea\u80fd\u964d\u4f4e\u8bbf\u5b58\u6b21\u6570\uff08over-fetch\uff09\uff0c\u4f8b\u5982\uff0c\u5bf9\u5730\u5740\u5206\u6563\u7684\u5185\u5b58\u7684\u8bbf\u95ee\u3002 \u5982\u679c\u6bcf\u4e2a\u7ebf\u7a0b\u5bf9\u5168\u5c40\u5185\u5b58\u7684\u8bbf\u95ee\u8d85\u8fc74\u4e2a\u5b57\u8282\uff0c\u90a3\u4e481\u4e2awarp\u7684\u5185\u5b58\u8bbf\u95ee\u8bf7\u6c42\u4f1a\u88ab\u5206\u5272\u6210128\u5b57\u8282\u7684\u5185\u5b58\u8bbf\u95ee\uff1a 32 * 8 / 128 = 2\u6b21\u5185\u5b58\u8bf7\u6c42\uff0c\u6bcf\u6b21\u8bf7\u6c42\u4e3a1/2\u4e2awarp\uff0c\u5982\u679c\u6bcf\u4e2a\u7ebf\u7a0b\u8bf7\u6c428\u5b57\u8282\uff1b 32 * 16 / 128 = 4\u6b21\u5185\u5b58\u8bf7\u6c42\uff0c\u6bcf\u6b21\u8bf7\u6c42\u4e3a1/4\u4e2awarp\uff0c\u5982\u679c\u6bcf\u4e2a\u7ebf\u7a0b\u8bf7\u6c4216\u5b57\u8282\u3002</p> <p>\u5bf9\u4e8e\u6574\u4e2akernel\u751f\u547d\u5468\u671f\u5185\u7684\u53ea\u8bfb\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528__ldg()\u51fd\u6570\uff08\u53ef\u80fd\u662fload global\u7684\u7f29\u5199\uff09\u7f13\u5b58\u5728read-only data cache\u4e2d\u3002\u7f16\u8bd1\u5668\u4e5f\u4f1a\u4f7f\u7528__ldg()\u8fdb\u884c\u8fd9\u65b9\u9762\u7684\u5c1d\u8bd5\uff0c\u5f53\u4f7f\u7528const\u548c__restrict__\u9650\u5b9a\u7b26\u6807\u8bb0\u8fd9\u90e8\u5206\u6570\u636e\u6307\u9488\u65f6\uff0c\u4f1a\u589e\u52a0\u7f16\u8bd1\u5668\u63a2\u6d4bread-only\u6761\u4ef6\uff08\u8fdb\u800c\u8fdb\u884c\u4e0a\u8ff0\u7f13\u5b58\u4f18\u5316\uff09\u7684\u6982\u7387\u3002</p> <p>\u5185\u5b58\u5bf9\u9f50\u4f1a\u589e\u52a0cache\u6982\u7387\uff0c\u51cf\u5c11\u8bbf\u5b58\uff08memory transaction\uff09\u6b21\u6570</p>"},{"location":"book_notes/CUDA/doc/CUDA/#shared-memory","title":"\u5171\u4eab\u5185\u5b58\uff08shared memory\uff09","text":"<p>bank conflict\uff1a\u5b58\u50a8\u4f53/\u5b58\u50a8\u6c60\u51b2\u7a81</p>"},{"location":"book_notes/CUDA/doc/CUDA/#compute-capabilities","title":"\u4e0d\u540c\u8ba1\u7b97\u80fd\u529b\uff08Compute Capabilities\uff09\u6bd4\u8f83","text":"3.x 5.x 6.x 7.x L1 cache L1/shared memory L1/texture Shared Memory (Max) 48 KB 64 KB Texture Memory - L2 cache Constant cache CUDA cores / MP 192 128 64 (6.0), 128 (6.1, 6.2) Special Function Units 32 32 warp Schedulers 4 4"},{"location":"book_notes/CUDA/doc/CUDA/#d","title":"D. \u6267\u884c\u73af\u5883\u4e0e\u5185\u5b58\u6a21\u578b","text":""},{"location":"book_notes/CUDA/doc/CUDA/#d2","title":"D.2. \u6267\u884c\u73af\u5883","text":""},{"location":"book_notes/CUDA/doc/CUDA/#d21-parent-and-child-grids","title":"D.2.1. \u7236\u5b50\u7ebf\u7a0b\u683c\uff08Parent and child grids\uff09","text":"<p>Parent grid\u4e2d\u7684\u7ebf\u7a0b\u53ef\u4ee5\u521b\u5efagrid\uff0c\u79f0\u4e3a\u7ebf\u7a0b\u683c\u5d4c\u5957\uff08grids nesting\uff09 \u5d4c\u5957grids\u4f1a\u9690\u5f0f\u540c\u6b65\u3002</p>"},{"location":"book_notes/CUDA/doc/CUDA/#d22-cuda","title":"D.2.2. CUDA\u539f\u8bed\u4f5c\u7528\u57df","text":""},{"location":"book_notes/CUDA/doc/CUDA/#_6","title":"Cuda","text":""},{"location":"book_notes/CUDA/doc/CUDA%E6%80%BB%E7%BB%93/","title":"Cuda\u603b\u7ed3","text":"<ol> <li> <p>SIMT \u5355\u6307\u4ee4\u591a\u7ebf\u7a0b\uff1a\u5206\u652f\u5206\u5316\uff08\u6216\u8bf4\u5206\u6d41\uff0cbranch-divergence\uff09\u95ee\u9898\u3002</p> </li> <li> <p>\u591a\u6838\u5fc3 \u6838\u5fc3\u4e2a\u6570\uff1a128\uff08\u8ba1\u7b97\u80fd\u529b5.x\uff09\u300164 (compute capablity 6.0) or 128 (6.1 and 6.2)  SM\u4e2a\u6570\uff1a5\u4e2a\uff08Geforce 960m\uff1a\u8ba1\u7b97\u80fd\u529b5.0\uff09\u300156\u4e2a\uff08Tesla P100\uff1a\u8ba1\u7b97\u80fd\u529b6.0\uff09\uff0c\u90fd\u662f\u6bcf\u4e2aSM\u670964\u4e2acores. SM\u4e2a\u6570\u4e0e\u540c\u65f6\u9a7b\u7559block\u4e2a\u6570\u6709\u5173\u3002 warps warp\u8c03\u5ea6\u5668\uff1a4\u4e2a\uff08\u8ba1\u7b97\u80fd\u529b5.x\u30016.1\u30016.2\uff09\uff0c2\u4e2a\uff08\u8ba1\u7b97\u80fd\u529b6.0\uff09 \u4ee5Block\u4e3a\u5355\u4f4d\u8fd0\u884c\u3002</p> </li> </ol> <p>\u5360\u7528\u7387\uff1a\u6d3b\u52a8\u7ebf\u7a0b\u5360\u7528\u7387\uff08SM\u5360\u7528\u7387\uff09\u3002\u8fd9\u4e2a\u4e0eBlock\u7684size\u548c\u5185\u5b58\u8d44\u6e90\u6709\u5173\u3002 \u5360\u7528\u7387\u4e0e\u8bbf\u5b58\u5ef6\u8fdf\u606f\u606f\u76f8\u5173\u3002 \u9996\u5148\u8981\u77e5\u9053\u4e00\u4e2aSM\u80fd\u9a7b\u7559\u591a\u5c11\u7ebf\u7a0b\uff08\u6216\u8bf4warps\uff09\uff0c\u4e00\u822c\u662f2048\u7ebf\u7a0b\uff0c\u4e5f\u5c31\u662f64 warps. \u7136\u540e\u5206\u914d\u5bc4\u5b58\u5668\uff0864 K\uff09\u3002</p> <ol> <li> <p>\u5185\u5b58\u7ed3\u6784 \u5171\u4eab\u5185\u5b58\u4e0e\u9ad8\u901f\u7f13\u5b58\u5dee\u4e0d\u591a\u3002 \u5168\u5c40\u5185\u5b58\u9700\u8981\u51e0\u767e\u4e2a\u65f6\u949f\u5468\u671f\u3002 \u5bc4\u5b58\u5668\u4e2a\u6570\u9650\u5236\uff1a\u4e0e\u9a7b\u7559\u7ebf\u7a0b\u675f\u6709\u5173\uff0c</p> </li> <li> <p>\u8bbf\u5b58\u5ef6\u8fdf \u5360\u7528\u7387 \u5168\u5c40\u5185\u5b58\u7684\u9ad8\u901f\u7f13\u5b58\uff1a24 KB\uff0c</p> </li> <li> <p>\u9a7b\u7559 grids\uff1a32\uff08\u8ba1\u7b97\u80fd\u529b5.0\uff09\u3001128\uff08\u8ba1\u7b97\u80fd\u529b6.0)\u3002 \u731c\u6d4b\uff1a\u9a7b\u7559\u7684grids\u6570\u5e94\u8be5\u662f\u6307\u9ed8\u8ba4\u6d41\u4e2d\u80fd\u591f\u653e\u5230SM\u4e2d\u7684kernels\u6570\uff0c\u5e94\u8be5\u4e0d\u5b58\u5728\u4e0a\u4e0b\u6587\u5207\u6362\u3002 blocks\uff1a32 \u9a7b\u7559\u7684blocks\u4e4b\u95f4\u7684\u5b58\u5728\u4e0a\u4e0b\u6587\u5207\u6362\uff08warps\u5207\u6362\u4f34\u968f\u7740\u4e0a\u4e0b\u6587\u5207\u6362\uff09\uff0c\u4e0a\u4e0b\u6587\u76f4\u63a5\u4fdd\u5b58\u5728\u5bc4\u5b58\u5668\u4e2d\u3002 warps\uff1a64\uff08threads\uff1a2048\uff09</p> </li> <li> <p>\u6d6e\u70b9\u8ba1\u7b97 \u7cbe\u5ea6\uff1aFMA\uff08Floating Multiply-Add\uff09 \u80fd\u529b\uff1a\u541e\u5410\u91cf</p> </li> <li> <p>\u52a0\u901f \u8bbf\u5b58\uff1a\u5168\u5c40\u5185\u5b58\u8bbf\u5b58\u6b21\u6570\u3001cache\u3001\u5185\u5b58\u5408\u5e76\uff08\u4f8b\u5982\u5bf9\u9f50\uff08cudaMallocPitch\u3001cuMemAllocPitch()\uff09\uff0c\u4e00\u4e2awarp\u8bbf\u95ee\u8fde\u7eed\u5730\u5740\uff09\u3002 \u5360\u7528\u7387 \u51fd\u6570\u9009\u62e9\uff08\u6307\u5b9a\u7cbe\u5ea6\u7684\u51fd\u6570\u3001\u51cf\u5c11\u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\uff08\u4f8b\u5982\u5e26f\u540e\u7f00\u7684\u6d6e\u70b9\u53c2\u6570\uff09\uff09 \u9a7b\u7559grids\u6570\u3001\u9a7b\u7559block\u6570\u3001\u9a7b\u7559warps\u6570 \u5c0f\u5185\u6838</p> </li> </ol>"},{"location":"book_notes/CUDA/doc/Cuda-Error/","title":"cudaErrorLaunchFailure","text":"<ul> <li>\u5982\u679c\u8fd9\u662f\u663e\u793a\u5361\u7684\u8bdd\uff0c\u663e\u793a\u9a71\u52a8\u7a0b\u5e8f\u6709\u4e00\u4e2a\u770b\u95e8\u72d7\u5b9a\u65f6\u5668\uff0c\u5b83\u4f1a\u6740\u6b7b\u9700\u8981\u51e0\u79d2\u949f\u4ee5\u4e0a\u624d\u80fd\u5b8c\u6210\u7684\u5185\u6838\uff08kernel\uff09\u3002</li> <li>\u53ef\u4ee5\u4f7f\u7528<code>cuda-memcheck</code>\u67e5\u770b\u9519\u8bef</li> <li>\u89e3\u51b3\u65b9\u6848\uff1a The resource which is being exhausted is time. On all current CUDA platforms, the display driver includes a watchdog timer which will kill any kernel which takes more than a few seconds to execute. Running code on a card which is running a display is subject to this limit.</li> </ul> <p>On the WDDM Windows platforms you are using, there are three possible solutions/work-arounds:</p> <p>Get a Telsa card and use the TCC driver, which eliminates the problem completely Try modifying registry settings to increase the timer limit (google for the TdrDelay registry key for more information, but I am not a Windows user and can't be more specific than that) Modify your kernel code to be \"re-entrant\" and process the data parallel work load in several kernel launches rather than one. Kernel launch overhead isn't all that large and processing the workload over several kernel runs is often pretty easy to achieve, depending on the algorithm you are using.</p> <p>\u8017\u5c3d\u7684\u8d44\u6e90\u662f\u65f6\u95f4\u3002\u5728\u6240\u6709\u7684\u73b0\u6709CUDA\u5e73\u53f0\u4e0a\uff0c\u663e\u793a\u9a71\u52a8\u5668\u6709\u4e2a\u770b\u95e8\u53e3\u5b9a\u65f6\u5668\uff0c\u5b83\u4f1a\u6740\u6b7b\u6240\u6709\u9700\u8981\u51e0\u79d2\u949f\u4ee5\u4e0a\u7684\u5185\u6838\u3002\u5728\u6b63\u5728\u8fd0\u884c\u663e\u793a\u5361\u4e0a\u8fd0\u884c\u7684\u4ee3\u7801\u53d7\u6b64\u9650\u5236\u3002</p> <p>\u5728\u4f60\u4f7f\u7528WDDM\uff08Windows Display Driver Model\uff09\u6a21\u5f0f\u65f6\uff0c\u6709\u51e0\u4e2a\u89e3\u51b3\u529e\u6cd5\u5982\u4e0b\uff1a \uff081\uff09\u5c1d\u8bd5\u4fee\u6539\u6ce8\u518c\u8868\u8bbe\u7f6e\uff0c\u589e\u52a0\u65f6\u95f4\u9650\u5236\uff08google\u641c\u7d22\u201cTdrDelay registry key\u201d\u83b7\u53d6\u66f4\u591a\u4fe1\u606f\uff09\uff1b \uff082\uff09\u5c06\u60a8\u7684\u5185\u6838\u4ee3\u7801\u201c\u91cd\u5165\u201d\uff0c\u5e76\u5728\u591a\u4e2a\u5185\u6838\u542f\u52a8(\u800c\u4e0d\u662f\u4e00\u4e2a)\u4e2d\u5904\u7406\u6570\u636e\u5e76\u884c\u5de5\u4f5c\u8d1f\u8f7d\u3002\u5185\u6838\u542f\u52a8\u5f00\u9500\u5e76\u4e0d\u5927\uff0c\u800c\u4e14\u6839\u636e\u4f7f\u7528\u7684\u7b97\u6cd5\uff0c\u5728\u591a\u4e2a\u5185\u6838\u8fd0\u884c\u671f\u95f4\u5904\u7406\u5de5\u4f5c\u8d1f\u8f7d\u901a\u5e38\u975e\u5e38\u5bb9\u6613\u5b9e\u73b0\u3002 \u6ce8\u91ca\uff1aTCC\uff08Tesla Compute Cluster\uff09.</p> <p>WDDM\u5207\u6362\u5230TCC\uff1a</p> <p>\u5efa\u8bae\u4f7f\u7528NVidia NSight Monitor\u3002\u4ee5\u7ba1\u7406\u5458\u8eab\u4efd\u6253\u5f00\u540e\uff0c\u60a8\u53ef\u4ee5\u5728\u5c5e\u6027\u90e8\u5206\u4e2d\u627e\u5230\u4e24\u4e2a\u6709\u8da3\u7684\u8bbe\u7f6e\uff1aa) WDDM\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8bbe\u7f6e\u4e3atrue\uff1b  b) WDDM\u8d85\u65f6\uff08\u4ee5\u6beb\u79d2\u4e3a\u5355\u4f4d\uff09\u3002</p> <p>\u5c06WDDM\u8bbe\u7f6e\u4e3afalse\u5c06\u7981\u7528\u8be5Windows Watchdog\uff0c\u5e76\u4f7f\u60a8\u80fd\u591f\u968f\u610f\u4f7f\u7528\u81ea\u5df1\u7684GPU\u3002\u4f46\u8bf7\u6ce8\u610f\uff1a\u60a8\u7684\u5c4f\u5e55\u53ef\u80fd\u4f1a\u51bb\u7ed3\u3002\u4e0d\u7528\u62c5\u5fc3\uff0c\u4e00\u65e6\u5b8c\u6210\u8ba1\u7b97\uff0c\u5b83\u5c06\u89e3\u51bb\u3002</p> <p>\u5982\u679c\u5e0c\u671b\u907f\u514d\u5c4f\u5e55\u51bb\u7ed3\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c06\u8be5\u503c\u8bbe\u7f6e\u4e3a\u66f4\u9ad8\u7684\u503c\u6765\u589e\u52a0WDDM\u8d85\u65f6\u3002\u5f53\u7136\uff0c\u8fd9\u9700\u8981\u5728\u65f6\u95f4\u8303\u56f4\u5185\u8fdb\u884c\u4ee3\u7801\u4f18\u5316\u3002</p> <p>\u60a8\u53ef\u4ee5\u505a\u7684\u53e6\u4e00\u4ef6\u4e8b\u662f\u53f3\u952e\u5355\u51fb\u684c\u9762\uff0c\u7136\u540e\u6253\u5f00NVidia\u63a7\u5236\u9762\u677f\u3002\u5728\u90a3\u91cc\uff0c\u57283d\u8bbe\u7f6e\u90e8\u5206\uff0c\u60a8\u5c06\u5177\u6709\u201c\u914d\u7f6eSLI\uff0cSurround\uff0cPhysX\u201d\u8bbe\u7f6e\u3002\u5982\u679c\u6253\u5f00\u5b83\uff0c\u60a8\u5c06\u770b\u5230PhysX\u5904\u7406\u5668\u88ab\u8bbe\u7f6e\u4e3a\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff09\u81ea\u52a8\u9009\u62e9\u3002\u5f53\u7136\uff0c\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u9009\u62e9GPU\u6765\u6e32\u67d3\u60a8\u7684\u663e\u793a\u3002\u5c06\u5176\u8bbe\u7f6e\u4e3aCPU\u3002\u73b0\u5728\uff0c\u60a8\u7684\u663e\u793a\u5c06\u7531CPU\u5904\u7406\u3002</p> <p>\u6700\u540e\u4e00\u4ef6\u4e8b\uff0cGeForce\u5361\u4e0d\u652f\u6301TCC\uff0c\u4ec5\u652f\u6301WDDM\u3002\u6211\u76f8\u4fe1Quadro\u4e24\u8005\u90fd\u652f\u6301\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u9700\u8981\u7684\u8bdd\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u79cd\u5c06\u5176\u8bbe\u7f6e\u4e3aTCC\u7684\u65b9\u6cd5\uff0c\u4f46\u662f\u5b83\u5c06\u6beb\u65e0\u7528\u5904\u3002.\u60a8\u62e5\u6709\u7684Quadro\u7248\u672c\u65e0\u6cd5\u5728\u8be5\u6a21\u5f0f\u4e0b\u8fdb\u884c\u8bbe\u7f6e\u3002\u60a8\u53ef\u4ee5\u4ece\u4ee5\u4e0b\u94fe\u63a5\u4e2d\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u3002</p> <p>\u53e6\u5916\uff0c\u4f7f\u7528TechPowerUp GPU-Z\u8fdb\u884c\u5b9e\u65f6GPU\u8d44\u6e90\u76d1\u63a7\u3002</p> <p>\u6ce8\u610f\uff1a\u5982\u679c\u662f\u7b14\u8bb0\u672c\u7535\u8111\uff0c\u5219\u65e0\u6cd5\u5c06dGPU\uff08Quadro P4000\uff09\u7f6e\u4e8eTCC\u6a21\u5f0f\u3002\u5927\u591a\u6570\u5e26\u6709dGPU\u7684\u73b0\u4ee3\u7b14\u8bb0\u672c\u7535\u8111\u90fd\u5177\u6709\u201c\u64ce\u5929\u67f1\u201d\u8bbe\u8ba1\u7684\u67d0\u4e9b\u53d8\u4f53\u3002\u8fd9\u79cd\u4f18\u5316\u8bbe\u8ba1\u610f\u5473\u7740\u4e24\u4e2aGPU\uff08\u82f1\u7279\u5c14iGPU\u548cNVIDIA dGPU\uff09\u5e76\u4e0d\u662f\u771f\u6b63\u5b8c\u5168\u72ec\u7acb\u7684\u3002\u5b83\u4eec\u65e8\u5728\u534f\u540c\u5de5\u4f5c\uff0c\u56e0\u6b64dGPU\u4e0d\u80fd\u5355\u72ec\u5207\u6362\u5230TCC\u6a21\u5f0f\u3002</p>"},{"location":"book_notes/CUDA/doc/Tips%20for%20speed%20up%20CUDA/","title":"Tips For Speed Up Cuda","text":"<p>Tips for speed up your algorithm in the CUDA programming Share There are a couple of things you can do to speed up your algorithm in the CUDA programming :</p> <p>1.)Try to attain .75(75%) to 1 (100%) occupancy of every kernel execution.</p> <p>This can be ensured by optimizing the number of resisters used by the Kernal and number of threads per block. We need to figure out the optimum register count per thread for the target device.</p> <p>2.) Avoid host to device and device to host memory transfers.Try to minimize Memory fetch operations so that the local cache need not be refreshed frequently.host to device data transfer bandwidth is 4 GB/s and divice to device data transfer bandwidth is 76.5 GB/s.So, do more computation on GPU rather than transfer data to and from device to host.</p> <p>3.) Store runtime variables in registers for fastest execution of instructions.</p> <p>4.) Do not use local arrays in your code like int a[3]={1,2,3} \u2013 better use variables such as a0=1;a1=.. etc if possible. Variables and array of size 4 and less are stored in register (by deault).</p> <p>5.) Write simple and small kernels. Kernel launch cost is negligible( 5 us).</p> <p>If you have one large Kernel, try to split it up into multiple small ones \u2013 it might be faster due to less registers used. For small kerenels we get much resources(registers, shared memory,constant memory, etc.) because it is limited to each kernel.</p> <p>6.) Texture reads are cached where as global memory reads are not. Use textures to store your data where possible.</p> <p>7.) Prevent threads from diverging, Conditional jumps should branch equal for all threads.Try to give conditional branching depands on multiple of wrap size.</p> <p>8.) Avoid loops which are run only by a minority of threads while the others are idle. All the threads in a block wait for every thread in that block to finish.</p> <p>9.) Use fast math routines where possible.</p> <p>\u2013 e.g. __mul24(), __mul32(), __sin(), etc.</p> <p>10.) A complex calculation often is faster than a large lookup table so recalculation is better than caching. Remember Memory transfers can be slow.</p> <p>11.) Writing your own cache manager that uses shared memory for caching might not be an advantage.</p> <p>12.) For fastest global memory access, use coalescence of global memory.</p> <p>13.) Try to avoid multiple threads accessing the same memory element,so that no bank conflict is possible on shared and constant memory.</p> <p>14.) Try to avoid bank conflicts for reading memories.To achive high memory bandwidth, shared and constant memories are devided into equally sized memory modules, called banks.</p> <p>And each thread of half wrap access elements of different banks to avoid bank conflict.</p> <p>15.) Small lookup tables can be stored in shared mem.If this small lookup table is used by all threads of the same block then small data should be cached so that it can be accessed faster.</p> <p>16.) Experiment with the number of parallel threads to find the optimum. Exprementation always gives better performance improvement in CUDA.e.g. number of threads per blocks(192, 256 etc.)</p> <p>17.) Using parallelism efficiently Partitioning our Computations so that our GPU multiprocessors should be equally busy.</p> <p>18.) Keeping our resource usage low .Resource usages should be low enough to support multiple active thread blocks per multiprocessor.</p> <p>19.) Thumb rule for Grid/Block size :</p>"},{"location":"book_notes/CUDA/doc/Tips%20for%20speed%20up%20CUDA/#of-blocks-of-multiprocessors","title":"of blocks &gt; # of multiprocessors","text":"<p>-So all multiprocessors have at least one block to execute.</p>"},{"location":"book_notes/CUDA/doc/Tips%20for%20speed%20up%20CUDA/#of-block-2-of-multiprocessors","title":"of block &gt; 2 * # of multiprocessors","text":"<p>-Multiple blocks can run concurrently in a multiprocessor.</p> <p>20.) Compile with \u2013ptxas-options=-v flag</p> <p>This will give various information at the time of compilation e.g.</p> <ul> <li> <p>Page size</p> </li> <li> <p>Total allocated memory</p> </li> <li> <p>Total available memory</p> </li> <li> <p>Nrof small block pages</p> </li> <li> <p>Nrof large block pages</p> </li> <li> <p>Longest free list size</p> </li> <li> <p>Average free list size</p> </li> </ul> <p>21.) nvprof: The nvprof profiling tool enables you to collect and view profiling data from the command-line.</p>"},{"location":"book_notes/GNU_make/","title":"GNU make","text":"<p>\u8fd9\u662fGNU make\u624b\u518c\u7684\u7ffb\u8bd1\u3002</p>"},{"location":"book_notes/GNU_make/2-An-Introduction-to-Makefiles/","title":"Makefiles\u7b80\u4ecb","text":"<p>\u539f\u6587\u94fe\u63a5\uff1a\u7b2c2\u7ae0 Makefiles\u7b80\u4ecb</p> <p>\u901a\u5e38\uff0cmakefile\u6587\u4ef6\u544a\u8bc9make\u600e\u4e48\u7f16\u8bd1\u548c\u94fe\u63a5\u4e00\u4e2a\u7a0b\u5e8f\u3002</p> <p>\u5728\u672c\u7ae0\u4e2d\uff0c\u6211\u4eec\u5c06\u8ba8\u8bba\u4e00\u4e2a\u7b80\u5355\u7684makefile\uff0c\u5b83\u63cf\u8ff0\u4e86\u600e\u4e48\u7f16\u8bd1\u548c\u94fe\u63a5\u4e00\u4e2a\u5305\u542b8\u4e2aC\u6587\u4ef6\u548c3\u4e2a\u5934\u6587\u4ef6\u7684\u6587\u672c\u7f16\u8f91\u5668\u7684\u7a0b\u5e8f\u3002</p> <p>make\u91cd\u65b0\u7f16\u8bd1\u7a0b\u5e8f\uff08program\uff09\u65f6\uff0c\u6bcf\u4e00\u4e2a\u6539\u52a8\u7684C\u6e90\u6587\u4ef6\u90fd\u5fc5\u987b\u88ab\u91cd\u65b0\u7f16\u8bd1\u3002 \u5982\u679c\u67d0\u4e2a\u6587\u4ef6\u88ab\u6539\u52a8\uff0c\u6bcf\u4e2a\u5305\u542b\u8be5\u5934\u6587\u4ef6\u7684C\u6e90\u6587\u4ef6\u90fd\u5fc5\u987b\u88ab\u91cd\u65b0\u7f16\u8bd1\u3002 \u7f16\u8bd1\u4ee5C\u6e90\u6587\u4ef6\u4e3a\u5355\u4f4d\uff0c\u6bcf\u4e2aC\u6e90\u6587\u4ef6\u90fd\u4f1a\u76f8\u5e94\u5730\u4ea7\u751f\u4e00\u4e2a\u76ee\u6807\u6587\u4ef6\uff08object file\uff09\u3002 \u5982\u679c\u4efb\u4f55\u4e00\u4e2aC\u6e90\u6587\u4ef6\u88ab\u91cd\u65b0\u7f16\u8bd1\u4e86\uff0c\u6240\u6709\u7684\u76ee\u6807\u6587\u4ef6\uff0c\u4e0d\u8bba\u662f\u65b0\u7f16\u8bd1\u7684\u8fd8\u662f\u4e0a\u4e00\u6b21\u7f16\u8bd1\u540e\u4fdd\u5b58\u597d\u7684\uff0c\u90fd\u4f1a\u5fc5\u987b\u88ab\u91cd\u65b0\u94fe\u63a5\uff0c\u4ee5\u4ea7\u751f\u65b0\u7684\u53ef\u6267\u884c\u7a0b\u5e8f(executable\uff09\u3002</p>"},{"location":"book_notes/GNU_make/2-An-Introduction-to-Makefiles/#makefile","title":"Makefile\u89c4\u5219","text":"<p>\u4e00\u4e2a\u7b80\u5355\u7684makefile\u5305\u542b\u4ee5\u4e0b\u5f62\u5f0f\u7684\u201c\u89c4\u5219\uff08rules\uff09\u201d\uff1a</p> <pre><code>target : prerequisites\n    recipe\n    ...\n    ...\n</code></pre> <p>target\u901a\u5e38\u662f\u4e00\u4e2a\u7a0b\u5e8f\u751f\u6210\u7684\u6587\u4ef6\u540d\uff0c\u6bd4\u5982\u53ef\u6267\u884c\u6216\u76ee\u6807\u6587\u4ef6\uff08executable or object files\uff09\u3002</p> <p>target\u4e5f\u53ef\u4ee5\u662f\u8981\u6267\u884c\u7684\u52a8\u4f5c\uff08action\uff09\u7684\u540d\u79f0\uff0c\u6bd4\u5982clean \uff08\u89c1\u4f2a\u76ee\u6807\uff09\u3002</p> <p>prerequisites\u662f\u7528\u6765\u4f5c\u4e3a\u8f93\u5165\u4ee5\u751f\u6210target\u7684\u6587\u4ef6\u3002\u4e00\u4e2atarget\u901a\u5e38\u5305\u542b\u6570\u4e2a\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u5305\u542b\u4efb\u4f55prerequisites\u3002</p> <p>recipe\u662f\u4e00\u4e2amake\u5c06\u8981\u6267\u884c\u7684\u52a8\u4f5c\uff08action\uff09\u3002\u4e00\u4e2arecipe\u53ef\u80fd\u5305\u597d\u4e0d\u6b62\u4e00\u4e2a\u547d\u4ee4\uff08command\uff09\uff0c\u4e0d\u8bba\u662f\u5199\u5728\u540c\u4e00\u884c\u8fd8\u662f\u5404\u81ea\u4e00\u884c\u3002 \u8bf7\u6ce8\u610f\uff1a \u4f60\u9700\u8981\u5728\u6bcf\u4e00\u4e2arecipe\u884c\u7684\u5f00\u5934\u653e\u7f6e\u4e00\u4e2atab\u7b26\uff01\u5982\u679c\u4f60\u66f4\u559c\u6b22\u5176\u4ed6\u7b26\u53f7\u800c\u4e0d\u662ftab\uff0c\u4f60\u53ef\u4ee5\u8bbe\u7f6e.RECIPEPREFIX\u53d8\u91cf\u4e3a\u4e00\u4e2a\u66ff\u4ee3\u5b57\u7b26 \uff08\u89c1\u5176\u4ed6\u7279\u6b8a\u5b57\u7b26\uff09\u3002</p> <p>\u8bd1\u8005\u6ce8\uff1a \u6bcf\u4e2arecipe\u884c\u4f1a\u65b0\u5efa\u4e00\u4e2abash\u6765\u6267\u884c\u547d\u4ee4\uff0c\u8fd9\u610f\u5473\u7740\u4e0a\u4e00\u884crecipe\u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u5728\u5176\u4ed6recipe\u884c\u662f\u65e0\u6548\u7684\u3002\u6d4b\u8bd5\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>all:\n    echo PID:$$$$\n    echo PID:$$$$\n</code></pre> <p>\u8bed\u6cd5\u89e3\u91ca\uff1aMakefile\u4e2d<code>$$</code>\u8868\u793a\u8f6c\u4e49<code>$</code>\u7b26\u53f7\uff0c\u6240\u4ee5<code>$$$$</code>\u524d\u4e24\u4e2a<code>$</code>\u8868\u793a\u4e00\u4e2a<code>$</code>\u7b26\uff0c\u540e\u4e24\u4e2a<code>$</code>\u8868\u793a\u53e6\u5916\u4e00\u4e2a<code>$</code>\u7b26\uff0c\u6700\u7ec8\u8f6c\u9012\u7ed9shell\u7684\u547d\u4ee4\u662f\uff1a</p> <pre><code>echo PID:$$\n</code></pre> <p>\u800cbash\u8bed\u6cd5\u4e2d<code>$$</code>\u8868\u793a\u5f53\u524d\u8fdb\u7a0b\u7684PID\u3002</p> <p>\u6d4b\u8bd5\u7ed3\u679c\uff1a</p> <pre><code>echo PID:$$\nPID:85280\necho PID:$$\nPID:85281\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u4e24\u884crecipe\u6253\u5370\u7684PID\u662f\u4e0d\u540c\u7684\u3002</p>"},{"location":"book_notes/GNU_make/3-Writing-Makefiles/","title":"\u5199Makefiles","text":"<p>\u539f\u6587\u94fe\u63a5\uff1a\u7b2c3\u7ae0 \u5199Makefiles</p>"},{"location":"book_notes/GNU_make/3-Writing-Makefiles/#makefiles_1","title":"Makefiles\u5305\u542b\u4ec0\u4e48","text":"<p>Makefile\u5305\u542b5\u79cd\u6210\u5206\uff1a\u663e\u5f0f\u89c4\u5219\uff08explicit rules\uff09\u3001\u9690\u5f0f\u89c4\u5219\uff08implicit rules\uff09\u3001\u53d8\u91cf\u5b9a\u4e49\uff08variable definitions\uff09\u3001\u6307\u4ee4\uff08directives\uff09\u3001\u6ce8\u91ca\uff08comments\uff09\u3002</p> <pre><code>\u6ce8\u610f\uff1a\u5728\u5f15\u7528\u53d8\u91cf\u6216\u8c03\u7528\u51fd\u6570\u65f6\uff0c\u8981\u6ce8\u610f\u7a7a\u683c\u3002\n</code></pre> <pre><code>#abc\u540e\u9762\u6709\u4e24\u4e2a\u7a7a\u683c\n#\u6240\u4ee5\u53d8\u91cfvar\u7684\u5185\u5bb9\u662f\"abc  \"\nvar=abc  \n#var2\u4e4b\u540e\u3001'#'\u7b26\u53f7\u4e4b\u524d\uff0c\u67093\u4e2a\u7a7a\u683c\n#var2\u7684\u5185\u5bb9\u662f\"abc   \"\nvar2=abc   #\u4e4b\u540e\u662f\u6ce8\u91ca\n</code></pre>"},{"location":"book_notes/GNU_make/3-Writing-Makefiles/#makfile","title":"\u7ed9\u4f60\u7684Makfile\u8d77\u4ec0\u4e48\u540d\u5b57","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cmake\u901a\u8fc7\u4ee5\u4e0b\u987a\u5e8f\u67e5\u627emakefile\u6587\u4ef6\uff0c\u53ea\u6267\u884c\u627e\u5230\u7684\u7b2c\u4e00\u4e2amakefile\uff1a</p> <pre><code>GNUmakefile\uff0c makefile, Makefile\n</code></pre> <p>Tip: \u8981\u60f3\u6784\u5efa\u6574\u4e2aproject\uff0c\u6216\u60f3\u8981\u6267\u884c\u6240\u6709\u7684makefiles\uff0c\u53ef\u4ee5\u5728makefiles\u4e2d\u8981\u6c42\u6267\u884c<code>make</code>\u547d\u4ee4\u3002</p> <pre><code>#This is GNUmakefile\nall:\n    make -f makefile\n    make -f Makefile\n    cd subdir; make;\n</code></pre>"},{"location":"book_notes/GNU_make/miscellaneous/misc/","title":"Misc","text":""},{"location":"book_notes/GNU_make/miscellaneous/misc/#whitespace","title":"Whitespace","text":"<p>Makefile\u5bf9\u7a7a\u683c\u7684\u5904\u7406\u4f3c\u4e4e\u662f\uff1a\u4ece\u7b2c\u4e00\u4e2a\u975e\u7a7a\u683c\u5b57\u7b26\u5f00\u59cb\uff0c\u5230\u660e\u786e\u7684\u622a\u6b62\u7b26\uff08\u6bd4\u5982\u6362\u884c\u3001'#'\u6ce8\u91ca\u6807\u8bb0\u3001\u9017\u53f7\u3001\u62ec\u53f7\u7b49\uff09\u4e3a\u6b62\u3002\u6d4b\u8bd5\u5982\u4e0b\uff1a</p> <pre><code>a =   b   #\u6ce8\u610f\u672b\u5c3e\u67093\u4e2a\u7a7a\u683c\n$(warning a=$(a)c)\n\nfind = $(findstring a  , a  b ) # \u6ce8\u610f\uff0c2\u4e2a'a'\u4e4b\u540e\u90fd\u67092\u4e2a\u7a7a\u683c\uff0c\n$(warning find=$(find)$$)\n\nfind1 = $(findstring a  , a b ) #\u6ce8\u610f\uff1a\u7b2c\u4e00\u4e2a'a'\u4e4b\u540e\u67092\u4e2a\u7a7a\u683c\uff0c\u7b2c\u4e8c\u4e2a'a'\u4e4b\u540e\u53ea\u67091\u4e2a\u7a7a\u683c\u3002\n$(warning find1=$(find1)$$)\n</code></pre> <p>\u7ed3\u679c\uff1a</p> <pre><code>Makefile:2: a=b   c\nMakefile:5: find=a   $\nMakefile:8: find1= $\n</code></pre>"},{"location":"book_notes/GNU_make/miscellaneous/misc/#_1","title":"\u6a21\u5f0f\u5339\u914d","text":"<p>\u6a21\u5f0f\u5339\u914d\u65f6\u4f1a\u5148\u5ffd\u7565\u76ee\u5f55\uff0c\u6587\u4ef6\u540d\u5339\u914d\u5b8c\u6210\u4e4b\u540e\u518d\u52a0\u4e0a\u76ee\u5f55\u3002\u89c110.5.4 How Patterns Match\u3002</p> <p>\u4f8b\u5982\uff1a</p> <pre><code>%.o : e%t.c\n    @echo matched:$*\n</code></pre> <p>\u6587\u4ef6\u5982\u4e0b\uff1a</p> <pre><code>|-- Makefile\n`-- src\n    |-- eat.c\n</code></pre> <p>\u6267\u884cmake\u547d\u4ee4\uff1a</p> <pre><code>make src/a.o\n</code></pre> <p>\u7ed3\u679c\uff1a</p> <pre><code>matched:src/a\n</code></pre>"},{"location":"book_notes/GNU_make/miscellaneous/misc/#shell","title":"\u53d8\u91cfSHELL","text":"<p>\u9ed8\u8ba4\u7684shell\u662fbash\uff0c\u53ef\u4ee5\u901a\u8fc7\u9884\u5b9a\u4e49\u53d8\u91cfSHELL\u6765\u81ea\u5b9a\u4e49\u6210\u5176\u4ed6shell\u7a0b\u5e8f\u3002</p>"},{"location":"book_notes/GNU_make/miscellaneous/misc/#export","title":"\u5173\u952e\u8bcdexport","text":"<p>bash\u4e2d<code>export &lt;varname&gt;</code>\u8868\u793a\u5c06\u5df2\u6709\u53d8\u91cf<code>&lt;varname&gt;</code>\u8bbe\u7f6e\u4e3a\u73af\u5883\u53d8\u91cf\uff0c\u5982\u679c<code>&lt;varname&gt;</code>\u4e4b\u524d\u6ca1\u6709\u5b9a\u4e49\uff0c\u5219\u8be5\u53e5\u4e0d\u751f\u6548\u3002</p> <p>bash\u4e2d<code>export &lt;varname&gt;=</code>\u7b49\u4ef7\u4e8e<code>&lt;varname&gt;=</code>\u548c<code>export &lt;varname&gt;</code>\u4e24\u53e5\u7684\u7ed3\u679c\uff0c\u4e5f\u5c31\u662f\u5148\u5b9a\u4e49\u53d8\u91cf<code>&lt;varname&gt;</code>\uff0c\u7136\u540e\u518d\u5c06\u5176\u8bbe\u7f6e\u4e3a\u73af\u5883\u53d8\u91cf</p> <p>Makefile\u4e2d<code>export &lt;varname&gt;</code>\u4e0ebash\u4e0d\u540c\uff0c\u5982\u679c<code>&lt;varname&gt;</code>\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u5728\u6b64\u65f6\u88ab\u5b9a\u4e49\u3002\u8be5\u53e5\u7b49\u4ef7\u4e8e<code>export &lt;varname&gt;=</code>\u3002</p>"},{"location":"book_notes/GNU_make/miscellaneous/misc/#_2","title":"\u7b49\u53f7","text":"<p>\u56db\u79cd\u7b49\u53f7\uff1a<code>=</code>, <code>:=</code>, <code>?=</code>, <code>+=</code>\u3002\u53c2\u8003\u8fd9\u91cc\u3002</p> <p>\u5b98\u65b9\u6587\u6863\uff1a6.2 The Two Flavours of Variables</p>"},{"location":"book_notes/GNU_make/miscellaneous/misc/#lazy-set","title":"Lazy Set","text":"<pre><code>VARIABLE = value\n</code></pre> <p>Normal setting of a variable, but any other variables mentioned with the value field are recursively expanded with their value at the point at which the variable is used, not the one it had when it was declared</p>"},{"location":"book_notes/GNU_make/miscellaneous/misc/#immediate-set","title":"Immediate Set","text":"<pre><code>VARIABLE := value\n</code></pre> <p>Setting of a variable with simple expansion of the values inside - values within it are expanded at declaration time.</p>"},{"location":"book_notes/GNU_make/miscellaneous/misc/#lazy-set-if-absent","title":"Lazy Set If Absent","text":"<pre><code>VARIABLE ?= value\n</code></pre> <p>Setting of a variable only if it doesn't have a value. value is always evaluated when VARIABLE is accessed. It is equivalent to</p> <pre><code>ifeq ($(origin VARIABLE), undefined)\n    VARIABLE = value\nendif\n</code></pre> <p>See the documentation for more details.</p>"},{"location":"book_notes/GNU_make/miscellaneous/misc/#append","title":"Append","text":"<pre><code>VARIABLE += value\n</code></pre> <p>Appending the supplied value to the existing value (or setting to that value if the variable didn't exist)</p>"},{"location":"book_notes/gcc/Preface/","title":"gcc\u624b\u518c","text":"<p>\u8fd9\u662fgcc\u624b\u518c\u7684\u7ffb\u8bd1\u6587\u6863\u3002</p>"}]}